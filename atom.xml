<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[SwiftGG]]></title>
  <subtitle><![CDATA[èµ°å¿ƒçš„ Swift ç¿»è¯‘ç»„]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://swiftggteam.github.io/"/>
  <updated>2015-11-03T03:11:32.129Z</updated>
  <id>http://swiftggteam.github.io/</id>
  
  <author>
    <name><![CDATA[SwiftGG]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[WatchConnectivity ä»‹ç»ï¼šå‘Šåˆ«åŠ è½½ç­‰å¾…]]></title>
    <link href="http://swiftggteam.github.io/2015/11/03/watchconnectivity-introduction-say-goodbye-to-the-spinner/"/>
    <id>http://swiftggteam.github.io/2015/11/03/watchconnectivity-introduction-say-goodbye-to-the-spinner/</id>
    <published>2015-11-03T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.129Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="http://natashatherobot.com/watchconnectivity-introduction-say-goodbye-to-the-spinner/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-21<br>è¯‘è€…ï¼š<a href="http://daizi.me" target="_blank" rel="external">å°è¢‹å­</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a></p>
</blockquote>
<p>åœ¨ WatchOS 2 ä¸Šæœ€æœ‰ä»·å€¼çš„æ–°ç‰¹æ€§å°±æ˜¯<code>WatchConnectivity</code>ï¼Œè™½ç„¶ç”¨æˆ·å¯èƒ½çœ‹ä¸åˆ°ï¼Œä½†æ˜¯è¿™ä¸ªç‰¹æ€§èƒ½è®©ä½ çš„ WatchOS åº”ç”¨æ›´åŠ å¥½ç”¨ã€‚</p>
<a id="more"></a>
<p><code>WatchConnectivity</code>æ˜¯ WatchOS 2 æ¡†æ¶ä¸­ç”¨äº Watch åº”ç”¨å’Œ iOS è®¾å¤‡ä¼ è¾“æ•°æ®çš„ã€‚<code>WatchConnectivity</code> å…³é”®çš„éƒ¨åˆ†æ˜¯ï¼Œå®ƒä½¿ä½ çš„åº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·<strong>æŸ¥çœ‹ä¹‹å‰</strong>å°±æ‹¿åˆ°å¿…è¦çš„æ•°æ®ã€‚è¿™æ„å‘³ç€ç”¨æˆ·æƒ³è¦çœ‹ä½ çš„åº”ç”¨æ—¶ï¼Œä»–ä»¬å¸Œæœ›é©¬ä¸Šçœ‹åˆ°æƒ³è¦çš„æ•°æ®ï¼Œè€Œä¸æ˜¯æ„šè ¢çš„åŠ è½½ç­‰å¾…ã€‚</p>
<p>æ¯•ç«Ÿï¼Œ Apple Watch æ˜¯ä¸€ä¸ªç§»åŠ¨ä¸­ä½¿ç”¨çš„è®¾å¤‡ã€‚ç”¨æˆ·ä»¬å¯èƒ½æƒ³è¦çœ‹ä¸€ä¸¤çœ¼åœ¨ iOS åº”ç”¨ä¸Šè¶…çº§å¯çˆ±çš„åˆ·æ–°åŠ¨ç”»ï¼Œä½†æ˜¾ç„¶ä»–ä»¬ä¸ä¼šå¿å—åœ¨æ‰‹è¡¨ä¸Šçœ‹åˆ°è¿™æ ·çš„åŠ¨ç”»ã€‚è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç”¨æˆ·æ¯æ¬¡åœ¨ä»–ä»¬å¸¸è§„çš„æ‰‹è¡¨ä¸ŠæŸ¥çœ‹æ—¶é—´ï¼Œå¼•å…¥çœ¼å¸˜çš„æ˜¯ä¸€ä¸ªåŠ è½½ç­‰å¾…ç•Œé¢ï¼Œé‚£å°†ä¼šéå¸¸æ„šè ¢ï¼ŒåŒç†ï¼Œä½ çš„åº”ç”¨å¦‚æœè¿™ä¹ˆåšä¹Ÿä¸€æ ·æ„šè ¢ã€‚</p>
<p>ç°åœ¨ä½ ä¸å¿…å†æ‹…å¿ƒäº†ï¼Œ<code>WatchConnectivity</code>å®Œå…¨å¯ä»¥è§£å†³è¿™ä¸ªéš¾é¢˜ï¼Œå®ƒå¯ä»¥æ¯«æ— å‹åŠ›åœ°ä¼ è¾“ä½ åº”ç”¨ä¸Šçš„æ•°æ®åˆ° Watch åº”ç”¨ä¸Šã€‚æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯æ— ç¼é€æ˜çš„ï¼Œä»¥è‡³äºä½ çš„ç”¨æˆ·éƒ½å¯Ÿè§‰ä¸åˆ°å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>
<p>è®©æˆ‘ä»¬å¼€å§‹æ·±å…¥å§ï¼<code>WatchConnectivity</code>æœ‰ä¸¤ä¸ªéƒ¨åˆ†-åå°ä¼ è¾“ï¼ˆ<code>background transfers</code>ï¼‰å’Œäº¤äº’å¼æ¶ˆæ¯ï¼ˆ<code>interactive messaging</code>ï¼‰ã€‚æˆ‘å°†ä¼šåœ¨æœªæ¥çš„æ•™ç¨‹é‡Œæ¢ç©¶å®ƒçš„æ¯ä¸€ä¸ªéƒ¨åˆ†çš„æ›´å¤šç»†èŠ‚ï¼Œä½†æ˜¯è¿™é‡Œåªæ˜¯ä¸€ä¸ªæ¦‚è¿°ï¼Œæ€è€ƒä¼ è¾“æ—¶åº”è¯¥ä½¿ç”¨å“ªä¸€ç§ä¼ è¾“æ¨¡å‹ï¼š</p>
<h2 id="åå°ä¼ è¾“">åå°ä¼ è¾“</h2><p>åœ¨ä½ çš„ iOS æˆ–è€… Watch åº”ç”¨ä¸éœ€è¦é©¬ä¸Šè·å¾—ä¿¡æ¯æ—¶ä½¿ç”¨åå°ä¼ è¾“ã€‚å½“ç„¶ï¼Œåœ¨ä½ çš„ç”¨æˆ·æŠ¬èµ·ä»–ä»¬çš„æ‰‹è…•æ—¶æŸ¥çœ‹åº”ç”¨é‡Œé¢çš„æœ€æ–°æ•°æ®æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºæ•°æ®ï¼Œä½†æ˜¯æ­¤å‰ä»–ä»¬ä¸éœ€è¦ä»»ä½•æ•°æ®ã€‚</p>
<p>å› ä¸ºåå°ä¼ è¾“ç”¨äºä¼ è¾“ä¸æ˜¯ç«‹åˆ»ä½¿ç”¨æ•°æ®ï¼Œ Apple è®¤ä¸ºä½¿ç”¨åå°ä¼ è¾“çš„æœ€ä½³æ—¶æœºæ˜¯å½“ä½ éœ€è¦æ ¹æ®ç”µæ± å®¹é‡ã€ç½‘ç»œè¿æ¥ã€ä½¿ç”¨æ¨¡å¼ä¼ è¾“æ•°æ®æ—¶ã€‚</p>
<p>åœ¨ä½ çš„ iOS å’Œ Watch åº”ç”¨ä¹‹é—´çš„åå°ä¼ è¾“æ•°æ®æœ‰ä¸‰ç§æ–¹å¼ï¼š</p>
<h3 id="åº”ç”¨ä¸Šä¸‹æ–‡">åº”ç”¨ä¸Šä¸‹æ–‡</h3><p>å½“ä½ çš„ Watch åº”ç”¨åªéœ€è¦å±•ç¤ºæœ€æ–°çš„ä¿¡æ¯æ—¶ï¼Œä½¿ç”¨åº”ç”¨ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼Œå½“ä½ çš„<code>Glance</code>æ˜¾ç¤ºæ¯”åˆ†æ—¶ï¼Œç”¨æˆ·ä¸ä¼šåœ¨æ„ä¸¤åˆ†é’Ÿä»¥å‰çš„ 4-2 æ¯”åˆ†ï¼Œä»–ä»¬åªåœ¨ä¹ç°åœ¨çš„æ¯”åˆ†æ˜¯ 4-4 ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯äº¤é€šè¿è¾“åº”ç”¨ï¼Œä½ ä¸éœ€è¦å…³å¿ƒäº”åˆ†é’Ÿä»¥å‰æœ€åçš„ä¸€è¾†å…¬äº¤è½¦åœ¨å…¬äº¤ç«™çš„å·¦è¾¹ï¼Œä»–ä»¬åªå…³å¿ƒä¸‹ä¸€è¾†å…¬äº¤è½¦ä»€ä¹ˆæ—¶å€™åˆ°ã€‚</p>
<p>æ‰€ä»¥åº”ç”¨ä¸Šä¸‹æ–‡çš„å·¥ä½œæ–¹å¼æ˜¯æŠŠæ•°æ®å—æ’æˆé˜Ÿåˆ—ï¼Œå¹¶ä¸”å¦‚æœåœ¨ä¼ è¾“ä¹‹å‰æœ‰ä¸€ä¸ªæ–°çš„å¯ç”¨æ•°æ®å—ï¼ŒåŸå§‹çš„æ•°æ®å°†ä¼šè¢«æ–°æ•°æ®å–ä»£ï¼Œç„¶åå†ä¼ è¾“è¿™ä¸ªæ•°æ®ï¼Œé™¤éå®ƒåˆè¢«å…¶å®ƒæ›´æ–°çš„æ•°æ®å—ä»£æ›¿ã€‚</p>
<p><a href="http://natashatherobot.com/watchconnectivity-application-context/" target="_blank" rel="external">Tutorial: Sharing The Latest Data via Application Context</a> </p>
<h3 id="ç”¨æˆ·ä¿¡æ¯">ç”¨æˆ·ä¿¡æ¯</h3><p>ç”¨æˆ·ä¿¡æ¯æ˜¯ç”¨äºå½“ä½ éœ€è¦ç¡®è®¤ä½ çš„æ‰€æœ‰æ•°æ®æ˜¯è¢«ä¼ è¾“è¿‡çš„ï¼ˆä¸åƒåº”ç”¨ä¸Šä¸‹æ–‡ï¼‰ã€‚ç”¨æˆ·ä¿¡æ¯çš„æ•°æ®æ˜¯åœ¨ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼ˆ<code>FIFO (first-in-first-out)</code>ï¼‰ é˜Ÿåˆ—ä¸­é¡ºåºä¼ è¾“ï¼Œæ‰€ä»¥æ²¡æœ‰ä¸œè¥¿è¢«è¦†ç›–ã€‚</p>
<p>ä¸€ä¸ªä¾‹å­æ˜¯ä½ å¯èƒ½æƒ³è¦åœ¨ä¸€ä¸ªæ–‡æœ¬æ¶ˆæ¯çš„åº”ç”¨ä¸­ä½¿ç”¨å®ƒ-å¯¹äºä¸€ä¸ªå®Œæ•´çš„ä¼šè¯å’Œä¸Šä¸‹æ–‡ç¯å¢ƒæ¥è¯´ï¼Œæœ€åä¸€æ¡ä¿¡æ¯å’Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åŒç­‰é‡è¦çš„ã€‚å¦‚æœç”¨æˆ·æ›´æ–°äº†ä»–ä»¬ç®€ä»‹ä¿¡æ¯ä¸­çš„ä¸€å°éƒ¨åˆ†ï¼ŒWatch ç®€ä»‹ä¸­ä¹Ÿåº”è¯¥åŒæ­¥è¿™äº›æ›´æ–°ã€‚</p>
<h3 id="æ–‡ä»¶ä¼ è¾“">æ–‡ä»¶ä¼ è¾“</h3><p>é¡¾åæ€ä¹‰ï¼Œåœ¨ä½ çš„ iOS å’Œ Watch åº”ç”¨ä¹‹é—´ä½¿ç”¨æ–‡ä»¶ä¼ è¾“å»ä¼ è¾“æ–‡ä»¶ï¼Œä¾‹å¦‚å›¾ç‰‡æˆ–è€…<code>plists</code>ã€‚æ–‡ä»¶ä¼ è¾“ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§æ˜¯ä½ å¯ä»¥åŒ…å«ä¸€ä¸ª<code>meta-data</code>å­—å…¸ï¼Œå…¶ä¸­åŒ…å«ä½ çš„æ–‡ä»¶åå’Œæ•°æ®ï¼Œæ¯”å¦‚è¯´è¿™æ ·ä½ å°±å¯ä»¥æ’åºä½ çš„å›¾ç‰‡ã€‚</p>
<h2 id="äº¤äº’å¼æ¶ˆæ¯">äº¤äº’å¼æ¶ˆæ¯</h2><p>ä½¿ç”¨äº¤äº’å¼æ¶ˆæ¯èƒ½å¤Ÿå®æ—¶åœ°åœ¨ä½ çš„ iOS å’Œ Watch åº”ç”¨ä¹‹é—´ä¼ è¾“æ•°æ®ï¼ä¸€ä¸ªç»ä½³çš„ç¤ºä¾‹å°±æ˜¯æ„¤æ€’çš„å°é¸Ÿåº”ç”¨çš„ Watch ç‰ˆæœ¬å’Œ iPhone ç‰ˆæœ¬-ç”¨æˆ·ç‚¹å‡» Watchï¼Œä½†æ˜¯å°é¸Ÿåœ¨æ‰‹æœºä¸Šé£ã€‚æŒ‰é’®ç‚¹å‡»é€šè¿‡äº¤äº’å¼æ¶ˆæ¯è¢«ä¼ è¾“åˆ°æ‰‹æœºä¸Šäº†ã€‚</p>
<p><img src="/img/articles/watchconnectivity-introduction-say-goodbye-to-the-spinner/flappybirdwatch.gif1446514271.8482146" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œäº¤äº’å¼æ¶ˆæ¯éœ€è¦ iPhone å¼€å¯<code>&quot;reachable&quot;</code>çŠ¶æ€ã€‚Apple æ–‡æ¡£è§£é‡Šé“ï¼š</p>
<blockquote>
<p>Watch åº”ç”¨çš„å¯è¾¾æ€§éœ€è¦é…å¯¹çš„ iOS è®¾å¤‡åœ¨é‡å¯ä¹‹åè‡³å°‘è§£é”ä¸€æ¬¡ã€‚</p>
</blockquote>
<h2 id="æ€»ç»“">æ€»ç»“</h2><p>æˆ‘çˆ±æ­»<a href="http://www.kristinathai.com/watchos-2-how-to-communicate-between-devices-using-watch-connectivity/" target="_blank" rel="external">Kristina Thaiâ€™s WatchConnectivity post</a> é‡Œé¢åŒºåˆ«ä¼ è¾“çš„å›¾è§£äº†ï¼š</p>
<p><img src="/img/articles/watchconnectivity-introduction-say-goodbye-to-the-spinner/Screen-Shot-2015-09-21-at-8.17.29-AM.png1446514277.5708654" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>åŒæ—¶ï¼Œæœ¬æ–‡å‚è€ƒäº† Curtis Herbert çš„æ–‡ç«  <a href="http://blog.curtisherbert.com/data-synchronization-with-watchos/" target="_blank" rel="external">Getting Data to Your WatchOS 2 App</a> ä¸­æœ€åçš„ Watch OS 2 observations éƒ¨åˆ†ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="http://natashatherobot.com/watchconnectivity-introduction-say-goodbye-to-the-spinner/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-21<br>è¯‘è€…ï¼š<a href="http://daizi.me">å°è¢‹å­</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a></p>
</blockquote>
<p>åœ¨ WatchOS 2 ä¸Šæœ€æœ‰ä»·å€¼çš„æ–°ç‰¹æ€§å°±æ˜¯<code>WatchConnectivity</code>ï¼Œè™½ç„¶ç”¨æˆ·å¯èƒ½çœ‹ä¸åˆ°ï¼Œä½†æ˜¯è¿™ä¸ªç‰¹æ€§èƒ½è®©ä½ çš„ WatchOS åº”ç”¨æ›´åŠ å¥½ç”¨ã€‚</p>]]>
    
    </summary>
    
      <category term="Natasha The Robot" scheme="http://swiftggteam.github.io/tags/Natasha-The-Robot/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/"/>
    
      <category term="WatchOS 2" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/WatchOS-2/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[WatchConnectivityï¼šå­¦ä¹  WCSession]]></title>
    <link href="http://swiftggteam.github.io/2015/11/02/watchconnectivity-say-hello-to-wcsession/"/>
    <id>http://swiftggteam.github.io/2015/11/02/watchconnectivity-say-hello-to-wcsession/</id>
    <published>2015-11-01T16:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.129Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="http://natashatherobot.com/watchconnectivity-say-hello-to-wcsession/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-21<br>è¯‘è€…ï¼š<a href="http://daizi.me" target="_blank" rel="external">å°è¢‹å­</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="external">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨è¯»è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œè¯·æ£€æŸ¥ä¸€ä¸‹ä½ æ˜¯å¦å·²ç»å­¦ä¹ äº†ä¹‹å‰ä¸¤ç¯‡å…³äº<code>WatchOS 2</code>çš„æ–‡ç« ï¼š</p>
<ul>
<li><a href="http://natashatherobot.com/watchos-2-hello-world/" target="_blank" rel="external">WatchOS 2: Hello, World</a></li>
<li><a href="http://natashatherobot.com/watchconnectivity-introduction-say-goodbye-to-the-spinner/" target="_blank" rel="external">WatchConnectivity Introduction: Say Goodbye To The Spinner</a></li>
</ul>
<p><code>WCSession</code>å°±æ˜¯<code>WatchConnectivity</code>çš„é­”åŠ›æºæ³‰ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬èµ¶ç´§æ·±æŒ–å®ƒå§ï¼</p>
<a id="more"></a>
<p><code>WCSession.defaultSession()</code>ä¼šè¿”å›<code>WCSession</code>çš„å•ä¾‹ï¼Œç”¨äºåœ¨ iOS å’Œ Watch åº”ç”¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨<code>WCSession</code>æ—¶ä»æœ‰ä¸€äº›å€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚</p>
<p>é¦–å…ˆï¼Œä½ å¿…é¡»ç»™<code>session</code>è®¾ç½®ä¸€ä¸ª<code>delegate</code>å¹¶å¯åŠ¨å®ƒã€‚</p>
<blockquote>
<p>â€œé»˜è®¤çš„<code>session</code>ç”¨äºä¸¤ä¸ªå¯¹åº”åº”ç”¨çš„é€šä¿¡ï¼ˆä¾‹å¦‚ iOS åº”ç”¨å’Œå®ƒçš„åŸç”Ÿ WatchKit æ‰©å±•ï¼‰ã€‚è¿™ä¸ª<code>session</code>æä¾›å‘é€ã€æ¥æ”¶å’Œè¿½è¸ªçŠ¶æ€çš„æ–¹æ³•ã€‚</p>
<p>å¯åŠ¨ä¸€ä¸ªåº”ç”¨æ—¶ï¼Œåº”è¯¥åœ¨é»˜è®¤çš„<code>session</code>ä¸Šè®¾ç½®ä¸€ä¸ª<code>delegate</code>å¹¶å¯åŠ¨å®ƒã€‚è¿™å°†å…è®¸ç³»ç»Ÿå¡«å……çŠ¶æ€å±æ€§å’Œæä¾›ä»»ä½•ä¼˜ç§€çš„èƒŒæ™¯ä¼ è¾“ã€‚â€â€”â€” Apple æ–‡æ¡£è¯´æ˜ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ä½ çš„ä»£ç åº”è¯¥å†™æˆè¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> session = <span class="type">WCSession</span>.defaultSession()</span><br><span class="line">session.delegate = <span class="keyword">self</span></span><br><span class="line">session.activateSession()</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘æ¨èå°†ä½ çš„<code>WCSession</code>ä½œä¸ºä¸€ä¸ªå•ä¾‹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨åº”ç”¨ä¸­éšæ„ä½¿ç”¨å®ƒï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> WatchConnectivity</span><br><span class="line"></span><br><span class="line"><span class="comment">// Note that the WCSessionDelegate must be an NSObject </span></span><br><span class="line"><span class="comment">// So no, you cannot use the nice Swift struct here!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WatchSessionManager</span>: <span class="title">NSObject</span>, <span class="title">WCSessionDelegate</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Instantiate the Singleton</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> sharedManager = <span class="type">WatchSessionManager</span>()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Keep a reference for the session, </span></span><br><span class="line">    <span class="comment">// which will be used later for sending / receiving data</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> session = <span class="type">WCSession</span>.defaultSession()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Activate Session</span></span><br><span class="line">    <span class="comment">// This needs to be called to activate the session before first use!</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">startSession</span><span class="params">()</span></span> &#123;</span><br><span class="line">        session.delegate = <span class="keyword">self</span></span><br><span class="line">        session.activateSession()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å¯ä»¥åœ¨<code>AppDelegate</code>çš„<code>application:didFinishLaunchingWithOptions</code>æ–¹æ³•ä¸­å¯åŠ¨ä½ çš„<code>session</code>ï¼Œå¹¶ä¸”å¯ä»¥åœ¨åº”ç”¨çš„ä»»æ„ä½ç½®ä½¿ç”¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">@UIApplicationMain</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">UIResponder</span>, <span class="title">UIApplicationDelegate</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// truncated...</span></span><br><span class="line"></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">application</span><span class="params">(application: UIApplication,</span><br><span class="line">        didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Set up and activate your session early here!</span></span><br><span class="line">        <span class="type">WatchSessionManager</span>.sharedManager.startSession()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// truncated...</span></span><br><span class="line">        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¯åŠ¨<code>session</code>æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚ä½ éœ€è¦é€šè¿‡<code>WCSession</code>çš„å¤šé‡æ£€æŸ¥ï¼Œè¿™æ ·ä½ çš„åº”ç”¨å°±ä¸éœ€è¦åšé¢å¤–çš„æ ¼å¼åŒ–ä¼ è¾“æ•°æ®å·¥ä½œã€‚</p>
<h1 id="æ£€æŸ¥è®¾å¤‡æ˜¯å¦æ”¯æŒ">æ£€æŸ¥è®¾å¤‡æ˜¯å¦æ”¯æŒ</h1><blockquote>
<p>æ£€æŸ¥ iOS è®¾å¤‡æ˜¯å¦æ”¯æŒ sessionï¼ŒWatchOS ä¹Ÿæ˜¯æ”¯æŒ session çš„ã€‚</p>
</blockquote>
<p>å¦‚æœä½ æœ‰ä¸€ä¸ªé€šç”¨åº”ç”¨ï¼Œé‚£å°±éœ€è¦æ³¨æ„ï¼Œä¾‹å¦‚iPad ä¸æ”¯æŒ<code>WCSession</code>ï¼ˆå› ä¸º iPad ä¸èƒ½å’Œ Watch é…å¯¹ï¼‰ã€‚å› æ­¤ç¡®ä¿åœ¨ iOS é¡¹ç›®ä¸­åš<code>isSupported()</code>æ£€æŸ¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="type">WCSession</span>.isSupported() &#123;</span><br><span class="line">    <span class="keyword">let</span> session = <span class="type">WCSession</span>.defaultSession()</span><br><span class="line">    session.delegate = <span class="keyword">self</span></span><br><span class="line">    session.activateSession()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ„å‘³ç€ä½ çš„<code>WatchSessionManager</code>å•ä¾‹éœ€è¦é€‚åº”ä¸æ”¯æŒ<code>WCSession</code>çš„åœºæ™¯ï¼ˆä½¿ç”¨å¯é€‰å€¼ï¼‰ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Modification to the WatchSessionManager in the iOS app only</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WatchSessionManager</span>: <span class="title">NSObject</span>, <span class="title">WCSessionDelegate</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// truncated ... see above section</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// the session is now an optional, since it might not be supported</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> session: <span class="type">WCSession</span>? = <span class="type">WCSession</span>.isSupported() ? <span class="type">WCSession</span>.defaultSession() : <span class="literal">nil</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// starting a session has to now deal with it being an optional</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">startSession</span><span class="params">()</span></span> &#123;</span><br><span class="line">        session?.delegate = <span class="keyword">self</span></span><br><span class="line">        session?.activateSession()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h1 id="Watch_ç›¸å…³çš„_iOS_App_çŠ¶æ€">Watch ç›¸å…³çš„ iOS App çŠ¶æ€</h1><p>å¦‚æœä½ ä» iOS åº”ç”¨å‘é€æ•°æ®åˆ° Watchï¼Œä½ éœ€è¦åšä¸€äº›é¢å¤–çš„æ£€æŸ¥ï¼Œè¿™æ ·å½“ Watch å¤„äºæ— æ³•æ¥å—æ•°æ®çš„çŠ¶æ€æ—¶ï¼Œä½ å°±ä¸ä¼šæµªè´¹ CPU èµ„æºå»å¤„ç†ç”¨äºä¼ è¾“çš„æ•°æ®ã€‚</p>
<p><strong>æ˜¯å¦é…å¯¹</strong></p>
<p>æ˜¾ç„¶ï¼Œä¸ºäº†ä» iOS è®¾å¤‡ä¼ è¾“æ•°æ®åˆ° Watchï¼Œç”¨æˆ·å¿…é¡»æœ‰ä¸€ä¸ª Watch å¹¶ä¸”å’Œ iOS è®¾å¤‡é…å¯¹ã€‚</p>
<p><strong>æ˜¯å¦å®‰è£… Watch åº”ç”¨</strong></p>
<p>ä¸€ä¸ªç”¨æˆ·å¯èƒ½æœ‰ä¸€å¯¹è®¾å¤‡ï¼Œå½“ç„¶å¯ä»¥é€‰æ‹©åˆ é™¤æ‰‹è¡¨ä¸­çš„åº”ç”¨ï¼Œæ‰€ä»¥ä¸ºäº†æ•°æ®ä¼ è¾“ï¼Œä½ éœ€è¦æ£€æŸ¥ä½ çš„åº”ç”¨ç¡®å®æœ‰å®‰è£…åœ¨æ‰€é…å¯¹çš„ Apple Watch ä¸Šé¢ã€‚</p>
<p>å¦‚æœç”¨æˆ·æœ‰ä¸€å¯¹è®¾å¤‡ä½†æ˜¯æ²¡æœ‰å¯¹åº”çš„åº”ç”¨ï¼Œé‚£ä½ å°±å¯ä»¥åœ¨åˆé€‚çš„æ—¶æœºå‘ç”¨æˆ·æ¨èä½ çš„åº”ç”¨ï¼Œä»–å¾ˆå¯èƒ½ä¼šå®‰è£…ä½ çš„åº”ç”¨ã€‚</p>
<p>ä¸ºäº†è®©è¿™äº›æ£€æŸ¥æ›´åŠ ç®€å•ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨åº”ç”¨ä¸­éšæ„ä½¿ç”¨ï¼Œæˆ‘å–œæ¬¢åœ¨ iOS åº”ç”¨ä¸­åˆ›å»ºä¸€ä¸ª<code>validSession</code>å˜é‡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Modification to the WatchSessionManager in the iOS app only</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WatchSessionManager</span>: <span class="title">NSObject</span>, <span class="title">WCSessionDelegate</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// truncated... see above</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> session: <span class="type">WCSession</span>? = <span class="type">WCSession</span>.isSupported() ? <span class="type">WCSession</span>.defaultSession() : <span class="literal">nil</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Add a validSession variable to check that the Watch is paired</span></span><br><span class="line">    <span class="comment">// and the Watch App installed to prevent extra computation </span></span><br><span class="line">    <span class="comment">// if these conditions are not met.</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">// This is a computed property, since the user can pair their device and / or</span></span><br><span class="line">    <span class="comment">// install your app while using your iOS app, so this can become valid  </span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> validSession: <span class="type">WCSession</span>? &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="comment">// paired - the user has to have their device paired to the watch</span></span><br><span class="line">        <span class="comment">// watchAppInstalled - the user must have your watch app installed</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Note: if the device is paired, but your watch app is not installed</span></span><br><span class="line">        <span class="comment">// consider prompting the user to install it for a better experience</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> session = session <span class="keyword">where</span> session.paired &amp;&amp; session.watchAppInstalled &#123;</span><br><span class="line">            <span class="keyword">return</span> session</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// truncated... see above</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å¹¶å‘æ˜¯å¦å¯ç”¨</strong></p>
<p>æœ€åï¼Œå¦‚æœä½ åœ¨åº”ç”¨ä¸­æœ‰ä½¿ç”¨å¹¶å‘ï¼Œä½ å¿…é¡»æ£€æŸ¥å¹¶å‘æ˜¯å¦å¯ç”¨ã€‚æˆ‘ä¸ä¼šåœ¨<code>WatchConnectivity</code>æ•™ç¨‹ä¸­ä»‹ç»è¿‡å¤šå¹¶å‘çš„ç»†èŠ‚ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è¦çŸ¥é“æ›´å¤šï¼Œå¯ä»¥è§‚çœ‹è¶…çº§æœ‰ç”¨å’Œå…¨é¢çš„ <a href="https://developer.apple.com/videos/wwdc/2015/?id=209" target="_blank" rel="external">WWDC 2015 Creating Complications with ClockKit session</a>ã€‚</p>
<p><strong>sessionWatchStateDidChange</strong></p>
<p>æ³¨æ„ï¼Œå¦‚æœä½ çš„ iOS åº”ç”¨éœ€è¦<code>WCSession</code>çŠ¶æ€å˜åŒ–çš„ä¿¡æ¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª delegate æ–¹æ³•ï¼Œä¸“é—¨ç”¨äºé€šçŸ¥<code>WCSession</code>çš„çŠ¶æ€å˜åŒ–ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Called when any of the Watch state properties change */</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">sessionWatchStateDidChange</span><span class="params">(session: WCSession)</span></span> &#123;</span><br><span class="line">        <span class="comment">// handle state change here</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„åº”ç”¨éœ€è¦å®‰è£… Watch åº”ç”¨ï¼Œå¯ä»¥å®ç°è¿™ä¸ª<code>delegate</code>æ–¹æ³•ï¼Œç„¶åå»æ£€æµ‹ä½ çš„ Watch åº”ç”¨æ˜¯å¦çœŸæ­£å®‰è£…äº†ï¼Œå¹¶ä¸”è®©ç”¨æˆ·åœ¨ iOS åº”ç”¨ä¸­è¿›è¡Œè®¾ç½®ã€‚</p>
<h1 id="æ£€æŸ¥è®¾å¤‡å¯è¾¾çŠ¶æ€">æ£€æŸ¥è®¾å¤‡å¯è¾¾çŠ¶æ€</h1><p>ä¸ºäº†æ­£ç¡®åœ¨ iOS å’Œ Watch ä¸­ä½¿ç”¨<code>Interactive Messaging</code>ä¼ è¾“æ•°æ®ï¼Œä½ éœ€è¦åšä¸€äº›é¢å¤–çš„å·¥ä½œä»¥ç¡®ä¿ä¸¤ä¸ªåº”ç”¨å¤„äºå¯è¾¾çŠ¶æ€ï¼š</p>
<blockquote>
<p>Watch åº”ç”¨çš„å¯è¾¾çŠ¶æ€éœ€è¦æ‰€é…å¯¹çš„ iOS è®¾å¤‡åœ¨é‡å¯åè‡³å°‘è§£é”ä¸€æ¬¡ã€‚è¿™ä¸ªå±æ€§èƒ½å¤Ÿç”¨äºå†³å®š iOS è®¾å¤‡æ˜¯å¦éœ€è¦è¢«è§£é”ã€‚å¦‚æœ<code>reachable</code>è®¾ä¸º<code>NO</code>ï¼Œå¯èƒ½æ˜¯ç”±äºè®¾å¤‡é‡å¯è¿‡ï¼Œéœ€è¦è§£é”ã€‚å¦‚æœå¤„äºè¿™ç§çŠ¶æ€ï¼ŒWatch å°†ä¼šå±•ç¤ºä¸€ä¸ªæç¤ºæ¡†å»ºè®®ç”¨æˆ·å»è§£é”ä»–ä»¬é…å¯¹çš„ iOS è®¾å¤‡ã€‚</p>
</blockquote>
<p>åœ¨ä½¿ç”¨<code>Interactive Messaging</code>æ—¶ï¼Œæˆ‘å–œæ¬¢ç»™æˆ‘çš„å•ä¾‹å¢åŠ ä¸€ä¸ªé¢å¤–çš„<code>valideReachableSession</code>å˜é‡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: Interactive Messaging</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">WatchSessionManager</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Live messaging! App has to be reachable</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> validReachableSession: <span class="type">WCSession</span>? &#123;</span><br><span class="line">        <span class="comment">// check for validSession on iOS only (see above)</span></span><br><span class="line">        <span class="comment">// in your Watch App, you can just do an if session.reachable check</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> session = validSession <span class="keyword">where</span> session.reachable &#123;</span><br><span class="line">            <span class="keyword">return</span> session</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ<code>session</code>æ˜¯ä¸å¯è¾¾çš„ï¼Œä½ å¯ä»¥å¦‚ Apple æ‰€å»ºè®®çš„é‚£æ ·ï¼Œæç¤ºç”¨æˆ·å»è§£é”ä»–ä»¬çš„ iOS è®¾å¤‡ã€‚ä¸ºäº†è·çŸ¥ç”¨æˆ·è§£é”è®¾å¤‡ï¼Œå®ç°<code>sessionReachabilityDidChange</code>çš„<code>delegate</code>æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">sessionReachabilityDidChange</span><span class="params">(session: WCSession)</span></span> &#123;</span><br><span class="line">    <span class="comment">// handle session reachability change</span></span><br><span class="line">    <span class="keyword">if</span> session.reachable &#123;</span><br><span class="line">        <span class="comment">// great! continue on with Interactive Messaging</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ğŸ˜¥ prompt the user to unlock their iOS device</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šï¼ç°åœ¨ä½ åº”è¯¥å·²ç»çŸ¥é“äº†<code>WCSession</code>çš„ä¸€äº›è¦é¢†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼šå­¦ä¹ æ›´åŠ å¥½ç©çš„éƒ¨åˆ† â€”â€” çœŸæ­£ä½¿ç”¨å®ƒåœ¨ iOS å’Œ Watch ä¹‹é—´æ¥æ”¶å’Œå‘é€æ”¶æ®ï¼</p>
<p>ä½ å¯ä»¥åœ¨ GitHub æŸ¥çœ‹å®Œæ•´çš„<a href="https://gist.github.com/NatashaTheRobot/6bcbe79afd7e9572edf6" target="_blank" rel="external">WatchSessionManagerå•ä¾‹</a>ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="http://natashatherobot.com/watchconnectivity-say-hello-to-wcsession/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-21<br>è¯‘è€…ï¼š<a href="http://daizi.me">å°è¢‹å­</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨è¯»è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œè¯·æ£€æŸ¥ä¸€ä¸‹ä½ æ˜¯å¦å·²ç»å­¦ä¹ äº†ä¹‹å‰ä¸¤ç¯‡å…³äº<code>WatchOS 2</code>çš„æ–‡ç« ï¼š</p>
<ul>
<li><a href="http://natashatherobot.com/watchos-2-hello-world/">WatchOS 2: Hello, World</a></li>
<li><a href="http://natashatherobot.com/watchconnectivity-introduction-say-goodbye-to-the-spinner/">WatchConnectivity Introduction: Say Goodbye To The Spinner</a></li>
</ul>
<p><code>WCSession</code>å°±æ˜¯<code>WatchConnectivity</code>çš„é­”åŠ›æºæ³‰ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬èµ¶ç´§æ·±æŒ–å®ƒå§ï¼</p>]]>
    
    </summary>
    
      <category term="Natasha The Robot" scheme="http://swiftggteam.github.io/tags/Natasha-The-Robot/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/"/>
    
      <category term="WatchOS 2" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/WatchOS-2/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[èŠä¸€èŠå•å­ï¼ˆMonadï¼‰]]></title>
    <link href="http://swiftggteam.github.io/2015/10/30/lets-talk-about-monads/"/>
    <id>http://swiftggteam.github.io/2015/10/30/lets-talk-about-monads/</id>
    <published>2015-10-30T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.129Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/10/17/lets-talk-about-monads/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-17<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/97c49dfd1f9f/latest_articles" target="_blank" rel="external">ray16897188</a>ï¼›æ ¡å¯¹ï¼š<a href="http://daizi.me" target="_blank" rel="external">å°è¢‹å­</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p><a href="http://alisoftware.github.io/swift/2015/10/11/thinking-in-swift-4/" target="_blank" rel="external">ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>map</code>ã€<code>flatMap</code>è¿™ä¸¤ç§åŸºäº<code>Optional</code>å’Œ<code>Array</code>ç±»å‹çš„æ–¹æ³•åšäº†å¾ˆå¤šå¥½ç©å„¿çš„äº‹æƒ…ã€‚ä½†ä½ å¯èƒ½å¹¶æ²¡æœ‰æ„è¯†åˆ°ï¼Œä½ å·²ç»åœ¨ä¸è‡ªçŸ¥çš„æƒ…å†µä¸‹ä½¿ç”¨äº†å•å­<em>(å•å­ï¼Œå³ Monadï¼šä¸€ä¸ªå‡½æ•°å¼ç¼–ç¨‹çš„æœ¯è¯­ - è¯‘è€…æ³¨)</em>ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å•å­ï¼Ÿ</p>
<a id="more"></a>
<h3 id="ä»€ä¹ˆæ˜¯å‡½å­ï¼ˆFunctorsï¼‰å’Œå•å­">ä»€ä¹ˆæ˜¯å‡½å­ï¼ˆFunctorsï¼‰å’Œå•å­</h3><p>æˆ‘ä»¬åœ¨<a href="http://alisoftware.github.io/swift/2015/10/11/thinking-in-swift-4/" target="_blank" rel="external">ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« </a>ä¸­å¾—çŸ¥äº†<code>map</code>å’Œ<code>flatMap</code>å¯¹äº<code>Array</code>å’Œ<code>Optional</code>æ¥è¯´æœ‰ç€ç›¸ä¼¼çš„ä½œç”¨ï¼Œç”šè‡³è¿å‡½æ•°ç­¾åéƒ½ååˆ†ç›¸ä¼¼ã€‚</p>
<p>å®é™…ä¸Šè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼šå¾ˆå¤šç±»å‹éƒ½æœ‰ç±»ä¼¼<code>map</code>å’Œ<code>flatMap</code>çš„æ–¹æ³•ï¼Œè€Œè¿™äº›æ–¹æ³•éƒ½æœ‰é‚£ç§ç±»å‹çš„ç­¾åã€‚è¿™æ˜¯ä¸€ç§ååˆ†å¸¸è§çš„æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼çš„åå­—å«åš<em>å•å­</em>ã€‚</p>
<p>ä½ å¯èƒ½ä¹‹å‰åœ¨ç½‘ä¸Šçœ‹è¿‡å•å­è¿™ä¸ªæœ¯è¯­(ä¹Ÿå¯èƒ½å«åšå‡½å­)ï¼Œè¿˜çœ‹è¿‡å°è¯•è§£é‡Šè¯¥æœ¯è¯­çš„å„ç§æ¯”å–»ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†æ¯”å–»éƒ½è®©å®ƒæ›´åŠ å¤æ‚éš¾æ‡‚ã€‚</p>
<p><strong>äº‹å®ä¸Šï¼Œå•å­å’Œå‡½å­æ˜¯éå¸¸ç®€å•çš„æ¦‚å¿µã€‚</strong>å®ƒå¯ä»¥æœ€ç»ˆå½’ç»“ä¸ºï¼š</p>
<p><strong>ä¸€ä¸ªå‡½å­</strong>æ˜¯ä¸€ç§è¡¨ç¤ºä¸º<code>Type&lt;T&gt;</code>çš„ç±»å‹ï¼Œå®ƒï¼š</p>
<ul>
<li>å°è£…äº†å¦ä¸€ç§ç±»å‹ï¼ˆç±»ä¼¼äºå°è£…äº†æŸä¸ª<code>T</code>ç±»å‹çš„<code>Array&lt;T&gt;</code>æˆ–<code>Optional&lt;T&gt;</code>ï¼‰</li>
<li>æœ‰ä¸€ä¸ªå…·æœ‰<code>(T-&gt;U) -&gt; Type&lt;U&gt;</code>ç­¾åçš„<code>map</code>æ–¹æ³•</li>
</ul>
<p><strong>ä¸€ä¸ªå•å­</strong>æ˜¯ä¸€ç§ç±»å‹ï¼Œå®ƒï¼š</p>
<ul>
<li>æ˜¯ä¸€ä¸ªå‡½å­ï¼ˆæ‰€ä»¥å®ƒå°è£…äº†ä¸€ä¸ª<code>T</code>ç±»å‹ï¼Œæ‹¥æœ‰ä¸€ä¸ª<code>map</code>æ–¹æ³•ï¼‰</li>
<li>è¿˜æœ‰ä¸€ä¸ªå…·æœ‰<code>(T-&gt;Type&lt;U&gt;) -&gt; Type&lt;U&gt;</code>ç­¾åçš„<code>flatMap</code>æ–¹æ³•</li>
</ul>
<p>è¿™å°±æ˜¯å¯¹<em>å•å­</em>å’Œ<em>å‡½å­</em>æ‰€éœ€è¦äº†è§£çš„ä¸€åˆ‡ï¼<strong>ä¸€ä¸ª<em>å•å­</em>å°±æ˜¯ä¸€ç§å¸¦æœ‰<code>flatMap</code>æ–¹æ³•çš„ç±»å‹ï¼Œä¸€ä¸ª<em>å‡½å­</em>å°±æ˜¯ä¸€ç§å¸¦æœ‰ä¸€ä¸ª<code>map</code>æ–¹æ³•çš„ç±»å‹ã€‚</strong>å¾ˆç®€å•ï¼Œä¸æ˜¯ä¹ˆï¼Ÿ</p>
<h3 id="å„ç§ç±»å‹çš„å•å­">å„ç§ç±»å‹çš„å•å­</h3><p>ä½ å·²ç»å­¦è¿‡ä¸¤ç§æ—¢æ˜¯<em>å‡½å­</em>åˆæ˜¯<em>å•å­</em>çš„ç±»å‹ï¼Œå®ƒä»¬æ˜¯ï¼š<code>Array&lt;T&gt;</code>å’Œ<code>Optional&lt;T&gt;</code>ã€‚å½“ç„¶ï¼Œè¿™æ ·çš„ç±»å‹è¿˜æœ‰å¾ˆå¤šã€‚</p>
<p>å®é™…ä¸Šè¿™äº›ç±»å‹çš„æ–¹æ³•ä¼šæœ‰å…¶ä»–çš„åå­—ï¼Œä¸é™äº<code>map</code>å’Œ<code>flatMap</code>ã€‚ä¾‹å¦‚ä¸€ä¸ª<a href="http://promisekit.org/" target="_blank" rel="external">Promise</a>ä¹Ÿæ˜¯ä¸€ä¸ªå•å­ï¼Œè€Œå®ƒçš„ç›¸å¯¹åº”çš„<code>map</code>å’Œ<code>flatMap</code>æ–¹æ³•å«åš<code>then</code>ã€‚</p>
<p>ä»”ç»†çœ‹ä¸€ä¸‹<code>Promise&lt;T&gt;</code>çš„<code>then</code>æ–¹æ³•ç­¾åï¼Œæ€è€ƒä¸€ä¸‹ï¼šå®ƒæ‹¿åˆ°æœªæ¥è¿”å›çš„å€¼<code>T</code>ï¼Œè¿›è¡Œå¤„ç†ï¼Œç„¶åè¦ä¹ˆè¿”å›ä¸€ä¸ªæ–°ç±»å‹<code>U</code>ï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå°è£…äº†è¿™ä¸ªæ–°ç±»å‹çš„ã€æ–°çš„<code>Promise&lt;U&gt;</code>â€¦ æ²¡é”™ï¼Œæˆ‘ä»¬åˆä¸€æ¬¡å¾—åˆ°äº†ç›¸åŒçš„æ–¹æ³•ç­¾åï¼Œæ‰€ä»¥<code>Promise</code>å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª<code>å•å­</code>ï¼</p>
<p>æœ‰å¾ˆå¤šç±»å‹éƒ½ç¬¦åˆå•å­çš„å®šä¹‰ã€‚æ¯”å¦‚<code>Result</code>ï¼Œ<code>Signal</code>ï¼Œâ€¦ ä½ è¿˜å¯ä»¥æƒ³åˆ°æ›´å¤šï¼ˆå¦‚æœéœ€è¦çš„è¯ä½ ç”šè‡³å¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„å•å­ï¼‰ã€‚</p>
<p>çœ‹å‡ºç›¸ä¼¼æ€§äº†å—ï¼Ÿï¼ˆä¸ºæ–¹ä¾¿å¯¹æ¯”åŠ äº†ç©ºæ ¼ï¼‰</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Array, Optional, Promise, Result éƒ½æ˜¯å‡½å­</span></span><br><span class="line">   anArray     .<span class="built_in">map</span>( transform: <span class="type">T</span> -&gt;          <span class="type">U</span>  ) -&gt;    <span class="type">Array</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">anOptional     .<span class="built_in">map</span>( transform: <span class="type">T</span> -&gt;          <span class="type">U</span>  ) -&gt; <span class="type">Optional</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line"> aPromise     .then( transform: <span class="type">T</span> -&gt;          <span class="type">U</span>  ) -&gt;  <span class="type">Promise</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">   aResult     .<span class="built_in">map</span>( transform: <span class="type">T</span> -&gt;          <span class="type">U</span>  ) -&gt;   <span class="type">Result</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Array, Optional, Promise, Result éƒ½æ˜¯å•å­</span></span><br><span class="line">   anArray .flatMap( transform: <span class="type">T</span> -&gt;    <span class="type">Array</span>&lt;<span class="type">U</span>&gt; ) -&gt;    <span class="type">Array</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">anOptional .flatMap( transform: <span class="type">T</span> -&gt; <span class="type">Optional</span>&lt;<span class="type">U</span>&gt; ) -&gt; <span class="type">Optional</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">  aPromise    .then( transform: <span class="type">T</span> -&gt;  <span class="type">Promise</span>&lt;<span class="type">U</span>&gt; ) -&gt;  <span class="type">Promise</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">   aResult .flatMap( transform: <span class="type">T</span> -&gt;   <span class="type">Result</span>&lt;<span class="type">U</span>&gt; ) -&gt;   <span class="type">Result</span>&lt;<span class="type">U</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="æŠŠmap()å’ŒflatMap()çº§è”èµ·æ¥">æŠŠ<code>map()</code>å’Œ<code>flatMap()</code>çº§è”èµ·æ¥</h3><p>é€šå¸¸ä½ è¿˜å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ–¹æ³•çº§è”ï¼Œè¿™ä¼šä½¿å®ƒä»¬æ›´åŠ å¼ºå¤§ã€‚ä¾‹å¦‚ï¼Œæœ€å¼€å§‹ä½ æœ‰ä¸€ä¸ª<code>Array&lt;T&gt;</code>ï¼Œé€šè¿‡ä½¿ç”¨<code>map</code>æ¥å¯¹å®ƒåš<code>è½¬æ¢</code>æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ª<code>Array&lt;U&gt;</code>ï¼Œç„¶åå¯¹è¿™ä¸ª<code>Array&lt;U&gt;</code>å†çº§è”ä¸Šä¸€ä¸ª<code>map</code>ï¼Œå¯¹å®ƒåšå¦ä¸€ä¸ª<code>è½¬æ¢</code>æ“ä½œå°†å…¶è½¬æ¢æˆä¸€ä¸ª<code>Array&lt;Z&gt;</code>ï¼Œç­‰ç­‰ã€‚è¿™ä¼šè®©ä½ çš„ä»£ç çœ‹èµ·æ¥å°±åƒæ˜¯åœ¨ç”Ÿäº§çº¿ä¸Šä¸€æ ·ï¼šæŠŠä¸€ä¸ªåˆå§‹å€¼æ‹¿æ¥ï¼Œè®©ä»–ç»è¿‡ä¸€ç³»åˆ—çš„é»‘ç›’å­å¤„ç†ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªæœ€ç»ˆçš„ç»“æœã€‚è¿™æ—¶ä½ å°±å¯ä»¥è¯´ä½ å®é™…ä¸Šæ˜¯åœ¨åš<em>å‡½æ•°å¼ç¼–ç¨‹</em>äº†ï¼</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºèŒƒå¦‚ä½•å°†<code>map</code>å’Œ<code>flatMap</code>çš„è°ƒç”¨çº§è”èµ·æ¥å»åšå¤šæ¬¡è½¬æ¢çš„ä¾‹å­ã€‚æˆ‘ä»¬ä»ä¸€ä¸ªå­—ç¬¦ä¸²å¼€å§‹ï¼ŒæŠŠå®ƒæŒ‰å•è¯åˆ†å¼€ï¼Œç„¶åä¾æ¬¡åšå¦‚ä¸‹è½¬æ¢ï¼š</p>
<ol>
<li>ç»Ÿè®¡æ¯ä¸ªå•è¯çš„å­—ç¬¦ä¸ªæ•°ï¼Œåšè®¡æ•°</li>
<li>æŠŠæ¯ä¸ªè®¡æ•°è½¬æ¢æˆä¸€ä¸ªç›¸å¯¹åº”çš„å•è¯</li>
<li>ç»™æ¯ä¸ªç»“æœåŠ ä¸ªåç¼€</li>
<li>å¯¹æ¯ä¸ªå­—ç¬¦ä¸²ç»“æœåš%è½¬ä¹‰</li>
<li>æŠŠæ¯ä¸ªå­—ç¬¦ä¸²ç»“æœè½¬æ¢æˆä¸€ä¸ª<code>NSURL</code></li>
</ol>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> formatter = <span class="type">NSNumberFormatter</span>()</span><br><span class="line">formatter.numberStyle = .<span class="type">SpellOutStyle</span></span><br><span class="line"><span class="keyword">let</span> string = <span class="string">"This is Functional Programming"</span></span><br><span class="line"><span class="keyword">let</span> translateURLs = string</span><br><span class="line">    <span class="comment">// Split the characters into words</span></span><br><span class="line">    .characters.<span class="built_in">split</span>(<span class="string">" "</span>)</span><br><span class="line">    <span class="comment">// Count the number of characters on each word</span></span><br><span class="line">    .<span class="built_in">map</span> &#123; $<span class="number">0</span>.<span class="built_in">count</span> &#125;</span><br><span class="line">     <span class="comment">// Spell out this number of chars (`stringFromNumber` can return nil)</span></span><br><span class="line">    .flatMap &#123; (n: <span class="type">Int</span>) -&gt; <span class="type">String</span>? <span class="keyword">in</span> formatter.stringFromNumber(n) &#125;</span><br><span class="line">     <span class="comment">// add " letters" suffix</span></span><br><span class="line">    .<span class="built_in">map</span> &#123; <span class="string">"<span class="subst">\($<span class="number">0</span>)</span> letters"</span> &#125;</span><br><span class="line">    <span class="comment">// encode the string so it can be used in an NSURL framgment after the # (the stringByAddingâ€¦ method can return nil)</span></span><br><span class="line">    .flatMap &#123; $<span class="number">0</span>.stringByAddingPercentEncodingWithAllowedCharacters(.<span class="type">URLFragmentAllowedCharacterSet</span>()) &#125;</span><br><span class="line">    <span class="comment">// Build an NSURL using that string (`NSURL(string: â€¦)` is failable: it can return nil)</span></span><br><span class="line">    .flatMap &#123; <span class="type">NSURL</span>(string: <span class="string">"https://translate.google.com/#auto/fr/<span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(translateURLs)</span><br><span class="line"><span class="comment">// [https://translate.google.com/#auto/fr/four%20letters, https://translate.google.com/#auto/fr/two%20letters, https://translate.google.com/#auto/fr/ten%20letters, https://translate.google.com/#auto/fr/eleven%20letters]</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™æ®µä»£ç å¯èƒ½éœ€è¦ä½ ç ”ç©¶ä¸€ä¼šå„¿ï¼Œå°è¯•å»ç†è§£æ¯ä¸€ä¸ªä¸­é—´é˜¶æ®µçš„<code>map</code>å’Œ<code>flatMap</code>çš„ç­¾åæ˜¯ä»€ä¹ˆï¼Œå¹¶ææ¸…æ¥šæ¯ä¸€æ­¥éƒ½å‘ç”Ÿäº†ä»€ä¹ˆäº‹ã€‚</p>
<p>ä½†æ— è®ºå¦‚ä½•ï¼Œä½ èƒ½çœ‹å‡ºæ¥å¯¹äºæè¿°ä¸€ç³»åˆ—å¤„ç†æµç¨‹æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼å¯ä»¥è¢«çœ‹åšæ˜¯ä¸€æ¡ç”Ÿäº§çº¿ï¼Œä»<code>åŸææ–™</code>å¼€å§‹ï¼Œç„¶åå¯¹å®ƒåšå¤šç§<code>è½¬æ¢</code>ï¼Œæœ€ç»ˆåœ¨ç”Ÿäº§çº¿çš„å°½å¤´æ‹¿åˆ°<code>æˆå“</code>ã€‚</p>
<h3 id="ç»“è®º">ç»“è®º</h3><p>å°½ç®¡çœ‹èµ·æ¥å¾ˆå“äººï¼Œä½†å•å­å¾ˆç®€å•ã€‚</p>
<p>ä½†å®é™…ä¸Šï¼Œä½ æ€ä¹ˆå«å®ƒä»¬éƒ½æ²¡å…³ç³»ã€‚åªè¦ä½ çŸ¥é“å¦‚æœä½ æƒ³æŠŠä¸€ç§å°è£…ç±»å‹è½¬æ¢æˆå¦ä¸€ç§ï¼Œè€ŒæŸäº›ç±»å‹çš„<code>map</code>å’Œ<code>flatMap</code>æ–¹æ³•ç€å®èƒ½å¸®åˆ°ä½ ï¼Œè¿™å°±å¤Ÿäº†ã€‚</p>
<hr>
<p>è¿™ç¯‡æ–‡ç« æ˜¯â€Swiftç¼–ç¨‹æ€æƒ³â€ç³»åˆ—çš„åè®°ã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘è¿˜ä¼šå†™å¾ˆå¤šæ–‡ç« ï¼Œè®ºè¿° Swift åœ¨å…¶ä»–åº”ç”¨åœºæ™¯ä¸‹çš„ç¾å¦™ä¹‹å¤„ï¼Œä¸è¿‡æˆ‘ä¸ä¼šå†æ‹¿è¿™äº›å’Œ ObjC æ¯”è¾ƒäº†ï¼ˆå› ä¸º Swift çœŸçš„å¥½å¤ªå¤šäº†ï¼Œä½ ç°åœ¨åº”è¯¥å®Œå…¨æŠŠ ObjC å¿˜æ‰äº† ğŸ˜„ï¼‰ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/10/17/lets-talk-about-monads/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-17<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/97c49dfd1f9f/latest_articles">ray16897188</a>ï¼›æ ¡å¯¹ï¼š<a href="http://daizi.me">å°è¢‹å­</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p><a href="http://alisoftware.github.io/swift/2015/10/11/thinking-in-swift-4/">ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>map</code>ã€<code>flatMap</code>è¿™ä¸¤ç§åŸºäº<code>Optional</code>å’Œ<code>Array</code>ç±»å‹çš„æ–¹æ³•åšäº†å¾ˆå¤šå¥½ç©å„¿çš„äº‹æƒ…ã€‚ä½†ä½ å¯èƒ½å¹¶æ²¡æœ‰æ„è¯†åˆ°ï¼Œä½ å·²ç»åœ¨ä¸è‡ªçŸ¥çš„æƒ…å†µä¸‹ä½¿ç”¨äº†å•å­<em>(å•å­ï¼Œå³ Monadï¼šä¸€ä¸ªå‡½æ•°å¼ç¼–ç¨‹çš„æœ¯è¯­ - è¯‘è€…æ³¨)</em>ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å•å­ï¼Ÿ</p>]]>
    
    </summary>
    
      <category term="Crunchy Development" scheme="http://swiftggteam.github.io/tags/Crunchy-Development/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç”¨ Swift è¿›è¡Œåˆ—è¡¨è§£æåŠå…¶æ€§èƒ½é—®é¢˜]]></title>
    <link href="http://swiftggteam.github.io/2015/10/29/list-comprehensions-and-performance-with-swift/"/>
    <id>http://swiftggteam.github.io/2015/10/29/list-comprehensions-and-performance-with-swift/</id>
    <published>2015-10-29T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.129Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šVeronica Rayï¼Œ<a href="http://jamesonquave.com/blog/list-comprehensions-and-performance-with-swift/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-08-15<br>è¯‘è€…ï¼š<a href="http://weibo.com/riven0951" target="_blank" rel="external">riven</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/linusling" target="_blank" rel="external">å°é“åŒ Linus</a></p>
<p>æœ¬æ–‡å†™äº 2015.8.15 é€‚ç”¨äº Xcode 6 å’Œ Swift 1.2</p>
</blockquote>
<p>åˆ—è¡¨è§£æå¯ä»¥è®©ä½ ç”¨æ›´ç®€æ´çš„æ–¹å¼æ¥åˆ›å»ºåˆ—è¡¨ã€‚å°½ç®¡åˆ—è¡¨è§£ææ²¡æœ‰åœ¨ Swift çš„è¯­è¨€æŒ‡å—ä¸­æåŠï¼Œä½†ä½ ä¹Ÿå¯ä»¥åœ¨ Swift ä¸­å®ç°ç±»ä¼¼åˆ—è¡¨è§£æçš„ä¸€äº›æ“ä½œã€‚</p>
<a id="more"></a>
<p>å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªå¯¹å…ƒç´ æ±‚å¹³æ–¹çš„åˆ—è¡¨ï¼Œåƒè¿™æ ·:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> squares = [<span class="type">Int</span>]()</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">1</span>..&lt;<span class="number">10</span> &#123;</span><br><span class="line">Â Â Â Â squares.append(x*x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ Python ä¸­ï¼Œä½¿ç”¨åˆ—è¡¨è§£ææ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">squares = [x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br></pre></td></tr></table></figure>
<p>åœ¨ Swift ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> squares = <span class="type">Array</span>(<span class="built_in">map</span>(<span class="number">1</span>..&lt;<span class="number">10</span>) &#123; $<span class="number">0</span> * $<span class="number">0</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>å¯¹åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œæ±‚å’Œä½ å¯ä»¥è¿™æ ·åšï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> square <span class="keyword">in</span> squares &#123;</span><br><span class="line">Â Â Â Â sum = sum + square</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ä½¿ç”¨ reduce å‡½æ•°</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sum = squares.<span class="built_in">reduce</span>(<span class="number">0</span>, &#123; $<span class="number">0</span> + $<span class="number">1</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>å¯¹äºå…¶å®ƒè¯­è¨€ä¸­çš„åˆ—è¡¨è§£æï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»æ„çš„åºåˆ—æˆ–è€…é›†åˆä½œä¸ºè¾“å…¥ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªåŒºé—´å€¼ã€‚</p>
<p><a href="http://stackoverflow.com/questions/24003584/list-comprehension-in-swift" target="_blank" rel="external">ä½ å¯ä»¥ä½¿ç”¨ map/reduce/filter/stride å‡½æ•°åˆ›å»ºä½ æƒ³è¦çš„åˆ—è¡¨ç±»å‹</a></p>
<p>åˆ—è¡¨è§£æçš„ä¸¤ä¸ªä¸»è¦ä¼˜ç‚¹æ˜¯è®©ä»£ç å˜çš„æ›´ç®€æ´å’Œç”Ÿæˆæ›´å¿«çš„äºŒè¿›åˆ¶ç ã€‚</p>
<p>æˆ‘åˆšåˆšæ¨¡æ‹Ÿçš„åˆ—è¡¨è§£æçœ‹èµ·æ¥å¾ˆç®€æ´å§ã€‚ä½†æˆ‘å¾ˆå¥½å¥‡æ˜¯å¦å®ƒä¹Ÿèƒ½äº§ç”Ÿæ›´å¿«çš„äºŒè¿›åˆ¶ç ã€‚</p>
<p><a href="https://medium.com/swift-programming/secret-of-swift-performance-fcc5d2a437a8" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a> ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Hopper æ¥åˆ†æ Swift çš„æ±‡ç¼–ä»£ç ï¼ŒHopper æ˜¯ä¸€ä¸ª OS X å’Œ Linux åç¼–è¯‘ç¨‹åºã€‚ ä½ å¯ä»¥å…è´¹ä½¿ç”¨ Hopper ï¼Œä¸éœ€è¦ä»˜ä»»ä½•è´¹ç”¨ã€‚</p>
<p>æ²¡æœ‰ä½¿ç”¨åˆ—è¡¨è§£æçš„ä»£ç ç‰‡æ®µå’Œæ¨¡æ‹Ÿåˆ—è¡¨è§£æçš„ä»£ç ç‰‡æ®µéƒ½äº§ç”Ÿäº†åŒæ ·çš„æ±‡ç¼–ä»£ç .</p>
<p><img src="/img/articles/list-comprehensions-and-performance-with-swift/asm.png1446426438.2465854" alt="The assembly code from Hopper"></p>
<p>å› ä¸ºä¸¤ä¸ªä»£ç ç‰‡æ®µäº§ç”Ÿçš„æ±‡ç¼–ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥è®¤ä¸ºå®ƒä»¬çš„æ‰§è¡Œæ—¶é—´æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ XCTest æ¥æµ‹è¯•æˆ‘ä»¬ç¨‹åºçš„æ‰§è¡Œæ—¶é—´å¹¶è¯æ˜è¿™ä¸€ç‚¹ã€‚</p>
<p>æµ‹è¯•æ²¡æœ‰ä½¿ç”¨åˆ—è¡¨è§£æçš„ä»£ç ç‰‡æ®µ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">testNoListComprehensionPerformance</span><span class="params">()</span></span> &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">self</span>.measureBlock() &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">var</span> squares = [<span class="type">Int</span>]()</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">1</span>...<span class="number">5</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â squares.append(x)</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å…³çš„è¾“å‡ºæ˜¯ï¼š</p>
<p>Test Case â€˜-[speedTestTests.speedTestTests testNoListComprehensionPerformance]â€™ started.</p>
<p>:0: Test Case â€˜-[speedTestTests.speedTestTests testNoListComprehensionPerformance]â€™ measured [Time, seconds] average: 0.000, relative standard deviation: 236.965%, values: [0.000154, 0.000005, 0.000004, 0.000004, 0.000004, 0.000004, 0.000004, 0.000004, 0.000004, 0.000004], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: â€œâ€, baselineAverage: , maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100</p>
<p>Test Case â€˜-[speedTestTests.speedTestTests testNoListComprehensionPerformance]â€™ passed (0.262 seconds).</p>
<p>æµ‹è¯•æ¨¡æ‹Ÿåˆ—è¡¨è§£æçš„ä»£ç ç‰‡æ®µ</p>
<p>Test Case â€˜-[speedTestTests.speedTestTests testSortaListComprehensionPerformance]â€™ started.</p>
<p>:0: Test Case â€˜-[speedTestTests.speedTestTests testSortaListComprehensionPerformance]â€™ measured [Time, seconds] average: 0.000, relative standard deviation: 160.077%, values: [0.000045, 0.000005, 0.000004, 0.000003, 0.000003, 0.000003, 0.000003, 0.000004, 0.000003, 0.000003], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: â€œâ€, baselineAverage: , maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100</p>
<p>Test Case â€˜-[speedTestTests.speedTestTests testSortaListComprehensionPerformance]â€™ passed (0.255 seconds).</p>
<hr>
<p><strong>ä»–ä»¬å¹³å‡åªç›¸å·® 0.007 ç§’</strong></p>
<hr>
<p>æˆ‘è§è¿‡æœ€é…·çš„åˆ—è¡¨è§£æçš„åº”ç”¨ä¾¿æ˜¯æ‹¼å†™æ£€æŸ¥ã€‚Airspeed Velocity é’ˆå¯¹ <a href="http://norvig.com/spell-correct.html" target="_blank" rel="external">Peter Norvig çš„  Python ç‰ˆæœ¬çš„æ‹¼å†™æ£€æŸ¥</a>ï¼Œ<a href="http://airspeedvelocity.net/2015/05/02/spelling/" target="_blank" rel="external">æ”¹å†™äº†ä¸€ä¸ª Swift ç‰ˆæœ¬</a>ã€‚</p>
<p>åœ¨ Swift ä¸­ä½¿ç”¨ç±»åˆ—è¡¨è§£æçš„æ“ä½œçš„ä¸»è¦ä¼˜ç‚¹å°±æ˜¯ç®€æ´æ€§ã€‚ <a href="http://www.paulgraham.com/power.html" target="_blank" rel="external">Paul Graham å†™äº†ä¸€å¤§ç¯‡å…³äºåœ¨ç¼–ç¨‹è¯­è¨€ä¸­ç®€æ´æ˜¯å¤šä¹ˆé‡è¦çš„æ–‡ç« ã€‚</a> å› ä¸ºæ¯ä¸ªç¨‹åºå‘˜æ¯å¤©åªèƒ½å†™ä¸€å®šè¡Œæ•°çš„ä»£ç ï¼Œå¦‚æœä½ ä»¥åŒæ ·æ•°é‡çš„ä»£ç è¡Œæ•°å®Œæˆæ›´å¤šåŠŸèƒ½ï¼Œé‚£ä½ æ¯å¤©ä¾¿å¯ä»¥å®Œæˆæ›´å¤šçš„å·¥ä½œä»»åŠ¡ã€‚è¿™ç§åŠ›é‡ä¹Ÿä¼šè®©ä½ é‡æ–°æ€è€ƒç¼–å†™ä»€ä¹ˆæ ·çš„ç¨‹åºæ˜¯å¯èƒ½çš„ã€‚åœ¨ä¸€äº›æ›´ç¹ççš„è¯­è¨€ä¸­ï¼Œè¿™ä¸ªæ‹¼å†™æ£€æŸ¥çš„ä¾‹å­å¯èƒ½å°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„é¡¹ç›®ã€‚æˆ‘å–œæ¬¢åƒæ‹¼å†™æ£€æŸ¥è¿™ç§å……æ»¡æŠ€æœ¯å¤æ‚æ€§å’Œç¥ç§˜æ„Ÿçš„äº‹ç‰©ï¼Œå¹¶ä¸”åœ¨ Swift ä¸­å¯ä»¥åªç”¨å‡ è¡Œä»£ç ä¾¿èƒ½è§£å†³ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šVeronica Rayï¼Œ<a href="http://jamesonquave.com/blog/list-comprehensions-and-performance-with-swift/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-08-15<br>è¯‘è€…ï¼š<a href="http://weibo.com/riven0951">riven</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/linusling">å°é“åŒ Linus</a></p>
<p>æœ¬æ–‡å†™äº 2015.8.15 é€‚ç”¨äº Xcode 6 å’Œ Swift 1.2</p>
</blockquote>
<p>åˆ—è¡¨è§£æå¯ä»¥è®©ä½ ç”¨æ›´ç®€æ´çš„æ–¹å¼æ¥åˆ›å»ºåˆ—è¡¨ã€‚å°½ç®¡åˆ—è¡¨è§£ææ²¡æœ‰åœ¨ Swift çš„è¯­è¨€æŒ‡å—ä¸­æåŠï¼Œä½†ä½ ä¹Ÿå¯ä»¥åœ¨ Swift ä¸­å®ç°ç±»ä¼¼åˆ—è¡¨è§£æçš„ä¸€äº›æ“ä½œã€‚</p>]]>
    
    </summary>
    
      <category term="Jameson Quave" scheme="http://swiftggteam.github.io/tags/Jameson-Quave/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äº Swift çš„ 5 ä¸ªè¯¯åŒº]]></title>
    <link href="http://swiftggteam.github.io/2015/10/28/five-myths-about-swift/"/>
    <id>http://swiftggteam.github.io/2015/10/28/five-myths-about-swift/</id>
    <published>2015-10-28T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šThomas Hanningï¼Œ<a href="http://www.thomashanning.com/five-myths-about-swift/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-19<br>è¯‘è€…ï¼š<a href="http://weibo.com/linusling" target="_blank" rel="external">å°é“åŒ Linus</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Swift è™½ç„¶æ˜¯ä¸€é—¨æ¯”è¾ƒæ–°çš„æŠ€æœ¯è¯­è¨€ï¼Œå´å·²ç»æœ‰äº†å¾ˆå¤šå…³äº Swift çš„è¯¯åŒºã€‚</p>
<a id="more"></a>
<h2 id="è¯¯åŒº_1_ï¼šâ€œSwift_æ˜¯å¼±ç±»å‹çš„è¯­è¨€â€">è¯¯åŒº 1 ï¼šâ€œSwift æ˜¯å¼±ç±»å‹çš„è¯­è¨€â€</h2><p>å¾ˆå¤šäººè®¤ä¸º Swift æ˜¯ä¸€ç§å¼±ç±»å‹çš„è¯­è¨€ã€‚ä»–ä»¬è¿™ä¹ˆè¯´çš„åŸå› ä¸»è¦æ˜¯å¯ä»¥éšå¼å£°æ˜ä¸€ä¸ªå€¼ï¼Œè€Œä¸ç®¡ç±»å‹æ˜¯ä»€ä¹ˆï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä»£ç çœ‹ä¸Šå»å¥½åƒ<code>i</code>æ²¡æœ‰ç±»å‹ï¼Œå…¶å®å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚å› ä¸º 5 æ˜¯ä¸€ä¸ªæ•´å‹ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å°±ä¼šè®©<code>i</code>æˆä¸ºæ•´å‹å˜é‡ã€‚ä¹‹åï¼Œæ•´å‹å˜é‡<code>i</code>ä¸ä¼šå†è¢«æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è¯´<code>i</code>æ°¸è¿œæ˜¯æ•´å‹å˜é‡ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜ç¡®çš„æŒ‡å®šå˜é‡çš„ç±»å‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i: <span class="type">Int</span> = <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>è™½ç„¶è¿™ç§æ–¹å¼ä¸æ˜¯å¿…è¦çš„ï¼Œä½†å®ƒå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p>
<h2 id="è¯¯åŒº_2_ï¼šâ€œSwift_å’Œ_Objective-C_åä½œæ€§å·®â€">è¯¯åŒº 2 ï¼šâ€œSwift å’Œ Objective-C åä½œæ€§å·®â€</h2><p>å¾ˆå¤šäººä¸æƒ³å¼€å§‹å°è¯•ä½¿ç”¨ Swiftï¼Œå› ä¸ºä»–ä»¬è®¤ä¸º Swift ä¸èƒ½å…¼å®¹ç°å­˜çš„ Objective-C ä»£ç å’Œç±»åº“ã€‚å…¶å®å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚åœ¨åŒä¸€ä¸ªå·¥ç¨‹ä¸­ï¼ŒåŒæ—¶ä½¿ç”¨ Swift å’Œ Objective-C ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚å¹¶ä¸”ï¼Œåœ¨ Swift ä»£ç ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ Objective-C çš„ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<p>å¯ä»¥åœ¨æ‰€è°“çš„æ¡¥æ¥æ–‡ä»¶ä¸­å£°æ˜ Objective-C çš„å¤´æ–‡ä»¶ï¼Œç„¶åï¼Œæ‰€æœ‰å¤´æ–‡ä»¶çš„å†…å®¹éƒ½ä¼šè¢«ç¿»è¯‘æˆ Swfit çš„è¯­æ³•ï¼Œè¿™æ ·åœ¨è°ƒç”¨ Objective-C çš„ API çš„æ—¶å€™å°±ä¸ä¼šæ„Ÿè§‰åˆ°ä»€ä¹ˆåŒºåˆ«äº†ã€‚ç”šè‡³ Objective-C é”™è¯¯å¤„ç†ä¹Ÿè¢«è½¬æ¢æˆ Swift çš„<code>do-try-catch</code>è¯­æ³•äº†ã€‚</p>
<p>è‹¹æœçš„æ¡†æ¶ä»ç„¶æ˜¯ç”¨ Objective-C å†™çš„ï¼Œå¦‚æœSwift å’Œ Objective-C åä½œæ€§å·®çš„è¯äº‹æƒ…å°±ä¼šå˜å¾—å¾ˆç³Ÿã€‚</p>
<h2 id="è¯¯åŒº_3_ï¼šâ€œå¿…é¡»åœ¨æ–°çš„é¡¹ç›®ä¸­ä½¿ç”¨_Swiftâ€">è¯¯åŒº 3 ï¼šâ€œå¿…é¡»åœ¨æ–°çš„é¡¹ç›®ä¸­ä½¿ç”¨ Swiftâ€</h2><p>æˆ‘è§‰å¾—åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ Swift æ˜¯ä¸ªå¾ˆå¥½çš„æƒ³æ³•ï¼Œè€Œä¸”æ¯ä¸ª iOS å¼€å‘è€…éƒ½åº”è¯¥å­¦ Swiftã€‚</p>
<p>ä½†æ˜¯ï¼Œä½ æ²¡å¿…è¦ä¸€å®šè¦åœ¨æ–°é¡¹ç›®ä¸­å¼€å§‹ä½¿ç”¨ Swiftã€‚ç°åœ¨è‹¹æœå®˜æ–¹è¿˜åœ¨æ”¯æŒ Objective-Cï¼Œè‡³å°‘è¿‘å‡ å¹´ä¸ä¼šæ”¹å˜ã€‚ä½†æ˜¯ï¼Œæˆ‘è®¤ä¸ºè‹¹æœæœªæ¥å¯¹ Objective-C çš„æ”¯æŒä¼šè¶Šæ¥è¶Šå°‘ã€‚</p>
<p>å¯ä»¥å»æˆ‘å‘å¸ƒçš„å¦ä¸€ç¯‡æ–‡ç«  <a href="http://www.thomashanning.com/should-you-use-objective-c-or-swift/" target="_blank" rel="external">Should You Use Objective-C or Swift?</a> é‡Œçœ‹çœ‹å…³äºæœ¬è¯¯åŒºçš„å…¶ä»–è¯¦æƒ…ã€‚</p>
<h2 id="è¯¯åŒº_4_ï¼šâ€œåªå­¦_Swift_å°±å¤Ÿç”¨äº†â€">è¯¯åŒº 4 ï¼šâ€œåªå­¦ Swift å°±å¤Ÿç”¨äº†â€</h2><p>Swift æ˜¯é—¨å¾ˆæ£’çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒï¼Œä½†æ˜¯ä»…ä»…å­¦ Swift æ˜¯ä¸å¤Ÿçš„ã€‚åŸå› å¤§è‡´å¦‚ä¸‹ï¼šSwift å’Œ Objective-C æœ‰å¾ˆå¥½çš„åä½œæ€§ï¼Œè€Œä¸”é¡¹ç›®ä¸­ä¹Ÿç»å¸¸ä¼šæœ‰ Objective-C çš„ä»£ç ï¼ŒåŒæ—¶ï¼Œè®¸å¤šçš„ç¤ºä¾‹ä»£ç å’Œæ•™ç¨‹æ˜¯ç”¨ Objective-C å†™çš„ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†æˆä¸ºä¸€ä¸ªä¼˜ç§€çš„ iOS å¼€å‘è€…ï¼Œæœ€å¥½èƒ½åŒæ—¶å­¦ä¼š Swift å’Œ Objective-Cã€‚</p>
<h2 id="è¯¯åŒº_5_ï¼šâ€œSwift_è¿˜ä¸èƒ½ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒâ€">è¯¯åŒº 5 ï¼šâ€œSwift è¿˜ä¸èƒ½ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒâ€</h2><p>å¾ˆå¤šäººè®¤ä¸º Swift è¿˜ä¸èƒ½ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒã€‚å…¶ä¸­ä¸€ä¸ªåŸå› å°±æ˜¯ï¼Œå¼•è¿› Swift åˆ°å·¥ç¨‹ä¸­æ—¶ä¼šæœ‰ä¸€äº›é—®é¢˜å‡ºç°ï¼Œå°¤å…¶æ˜¯ Xcode ä¼šæœ‰ä¸€äº› bugã€‚å¦‚æœçŸ¥é“ä¸€äº›å˜é€šæ–¹æ³•çš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Swift çš„ã€‚</p>
<p>Swift 1.2 å’Œ Swift 2.0 çš„å¼•è¿›éƒ½æœ‰å¯¹è¯­è¨€çš„è¯­æ³•è¿›è¡Œä¿®æ”¹ã€‚å› æ­¤ï¼ŒæŠŠç°å­˜çš„ Swift ä»£ç è¿ç§»åˆ°æ–°çš„è¯­æ³•ä¸Šæ˜¯å¿…è¦çš„ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿæ²¡ä»€ä¹ˆå¯æŒ‡è´£çš„ï¼Œæ¯•ç«Ÿæ¯ä¸ª iOS ç‰ˆæœ¬éƒ½æœ‰ä»£ç åœ¨å˜æ›´ã€‚è€Œä¸”ï¼Œè¿™ä¹Ÿæ˜¯ Swift åœ¨å°è¯•æ”¹å–„çš„é‡è¦æ ‡å¿—ï¼Œç‰¹åˆ«æ˜¯åœ¨ Swift å‘å¸ƒä¸ä¹…çš„ç°é˜¶æ®µã€‚</p>
<h2 id="æ¥ä¸‹æ¥åšä»€ä¹ˆ">æ¥ä¸‹æ¥åšä»€ä¹ˆ</h2><p>å¦‚æœä½ æƒ³å­¦ä¹ æ›´å¤šæœ‰å…³ Swift çš„çŸ¥è¯†ï¼Œå­¦ä¹ <a href="https://itunes.apple.com/us/book/the-swift-programming-language/id881256329?mt=11" target="_blank" rel="external">è‹¹æœçš„Swiftæ–‡æ¡£</a>æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å¼€å§‹ã€‚å¦‚æœæƒ³äº†è§£å…¶å®ƒçš„èµ„æºï¼Œå¯ä»¥å…³æ³¨ä¸€ä¸‹æˆ‘çš„åšå®¢<a href="http://www.thomashanning.com/how-to-stay-up-to-date-on-ios-development/" target="_blank" rel="external"> â€œHow To Stay Up-To-Date On iOS Developmentâ€</a>ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šThomas Hanningï¼Œ<a href="http://www.thomashanning.com/five-myths-about-swift/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-19<br>è¯‘è€…ï¼š<a href="http://weibo.com/linusling">å°é“åŒ Linus</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Swift è™½ç„¶æ˜¯ä¸€é—¨æ¯”è¾ƒæ–°çš„æŠ€æœ¯è¯­è¨€ï¼Œå´å·²ç»æœ‰äº†å¾ˆå¤šå…³äº Swift çš„è¯¯åŒºã€‚</p>]]>
    
    </summary>
    
      <category term="Thomas Hanning" scheme="http://swiftggteam.github.io/tags/Thomas-Hanning/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[è¯¦è§£ Swift æ¨¡å¼åŒ¹é…]]></title>
    <link href="http://swiftggteam.github.io/2015/10/27/swift-pattern-matching-in-detail/"/>
    <id>http://swiftggteam.github.io/2015/10/27/swift-pattern-matching-in-detail/</id>
    <published>2015-10-27T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šBenedikt Terhechteï¼Œ<a href="http://appventure.me/2015/08/20/swift-pattern-matching-in-detail/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-08-20<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/mmoaay" target="_blank" rel="external">mmoaay</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="external">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨ä¼—å¤š Swift æä¾›ç»™ Objective-C ç¨‹åºå‘˜ä½¿ç”¨çš„æ–°ç‰¹æ€§ä¸­ï¼Œæœ‰ä¸ªç‰¹æ€§æŠŠè‡ªå·±ä¼ªè£…æˆä¸€ä¸ªæ— èŠçš„è€å¤´ï¼Œä½†æ˜¯å´åœ¨å¦‚ä½•ä¼˜é›…çš„è§£å†³â€œé­å°¸é‡‘å­—å¡”â€œçš„é—®é¢˜ä¸Šæœ‰ç€å·¨å¤§çš„æ½œåŠ›ã€‚å¾ˆæ˜¾ç„¶æˆ‘æ‰€è¯´çš„è¿™ä¸ªç‰¹æ€§å°±æ˜¯ <code>switch</code> è¯­å¥ï¼Œ å¯¹äºå¾ˆå¤š Objective-C ç¨‹åºå‘˜æ¥è¯´ï¼Œé™¤äº†ç”¨åœ¨ <a href="http://en.wikipedia.org/wiki/Duff%27s_device" target="_blank" rel="external">Duffâ€™s Device</a> ä¸Šæ¯”è¾ƒæœ‰è¶£ä¹‹å¤–ï¼Œ<code>switch</code> è¯­å¥éå¸¸ç¬¨æ‹™ï¼Œä¸å¤šä¸ª <code>if</code> è¯­å¥ç›¸æ¯”ï¼Œå®ƒå‡ ä¹æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ã€‚</p>
<a id="more"></a>
<p>ä¸è¿‡ Swift ä¸­çš„ <code>switch</code> è¯­å¥èƒ½åšçš„å°±å¤šäº†ã€‚åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹é‡Œï¼Œæˆ‘ä¼šæ›´åŠ è¯¦ç»†çš„è®²è§£è¿™äº›æ–°ç‰¹æ€§çš„å„ç§ç”¨é€”ã€‚æˆ‘ä¼šå¿½ç•¥é‚£äº›ä¸ Objective-C å’Œ C ä¸­ <code>switch</code> è¯­å¥ç›¸æ¯”æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ç¯‡æ–‡ç« åŸºç¡€çš„éƒ¨åˆ†å†™äº 2014 å¹´ 7 æœˆï¼Œä½†æ˜¯å¾ˆå¤šæˆ‘å†™çš„æ¨¡å¼éƒ½ä¼šå¯¼è‡´ç¼–è¯‘å™¨å´©æºƒï¼Œæ‰€ä»¥æˆ‘åªå¥½æ¨è¿Ÿè¿™äº›å†…å®¹çš„ç¼–å†™ï¼Œç›´åˆ°ç¼–è¯‘å™¨èƒ½æä¾›æ›´å¥½çš„æ”¯æŒã€‚</p>
<p>è¿™ç¯‡åšå®¢è¿˜æœ‰å¦‚ä¸‹è¯­è¨€çš„ç‰ˆæœ¬ï¼š</p>
<blockquote>
<p><a href="http://qiita.com/mono0926/items/f2875a9eacef53e88122" target="_blank" rel="external">æ—¥è¯­</a> ï¼ˆæ„Ÿè°¢ <a href="https://twitter.com/_mono" target="_blank" rel="external">M Ono</a>ï¼ï¼‰</p>
</blockquote>
<h1 id="å¼€å§‹å’¯">å¼€å§‹å’¯</h1><p> <code>switch</code> è¯­å¥ä¸»è¦çš„ç‰¹æ€§å½“ç„¶æ˜¯æ¨¡å¼åŒ¹é…å’¯ï¼Œæ¨¡å¼åŒ¹é…å¯ä»¥å¯¹å€¼è¿›è¡Œè§£æ„ï¼Œç„¶åæ ¹æ®ç›¸åº” <code>case</code> çš„æ­£ç¡®åŒ¹é…å€¼æ¥è¿›è¡ŒåŒ¹é…ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†å²ä¸Šæœ€åçš„ä¸€ä¸ªä¾‹å­ï¼šäºŒè¿›åˆ¶-&gt;åè¿›åˆ¶çš„è½¬æ¢</span></span><br><span class="line"><span class="keyword">let</span> bool1 = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> bool2 = <span class="number">0</span></span><br><span class="line"><span class="keyword">switch</span> (bool1, bool2) &#123;</span><br><span class="line">   <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">0</span>): <span class="built_in">print</span>(<span class="string">"0"</span>)</span><br><span class="line">   <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">1</span>): <span class="built_in">print</span>(<span class="string">"1"</span>)</span><br><span class="line">   <span class="keyword">case</span> (<span class="number">1</span>, <span class="number">0</span>): <span class="built_in">print</span>(<span class="string">"2"</span>)</span><br><span class="line">   <span class="keyword">case</span> (<span class="number">1</span>, <span class="number">1</span>): <span class="built_in">print</span>(<span class="string">"3"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¨¡å¼åŒ¹é…å¾ˆæ—©ä»¥å‰å°±åœ¨å…¶ä»–è¯­è¨€ä¸­å­˜åœ¨äº†ï¼Œè¿™äº›è¯­è¨€åŒ…æ‹¬ Haskellã€Erlangã€Scala å’Œ Prologã€‚è¿™æ˜¯ä¸€ä¸ªç¦éŸ³ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬è§‚å¯Ÿé‚£äº›è¯­è¨€å¦‚ä½•åˆ©ç”¨æ¨¡å¼åŒ¹é…æ¥è§£å†³é—®é¢˜ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥é€šè¿‡è§‚å¯Ÿå®ƒä»¬çš„ä¾‹å­æ¥æ‰¾åˆ°æœ€å®ç”¨çš„é‚£ä¸ªã€‚</p>
<h1 id="ä¸€ä¸ªäº¤æ˜“å¼•æ“">ä¸€ä¸ªäº¤æ˜“å¼•æ“</h1><p>å‡è®¾åå°”è¡—æ‰¾åˆ°ä½ ï¼Œä»–ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„è¿è¡Œåœ¨ iOS è®¾å¤‡ä¸Šçš„äº¤æ˜“å¹³å°ã€‚å› ä¸ºæ˜¯äº¤æ˜“å¹³å°ï¼Œæ‰€ä»¥ä½ éœ€è¦ç»™äº¤æ˜“å®šä¹‰ä¸€ä¸ª <code>enum</code>ã€‚</p>
<h2 id="ç¬¬ä¸€æ­¥">ç¬¬ä¸€æ­¥</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Trades</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Buy</span>(stock: <span class="type">String</span>, amount: <span class="type">Int</span>, stockPrice: <span class="type">Float</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Sell</span>(stock: <span class="type">String</span>, amount: <span class="type">Int</span>, stockPrice: <span class="type">Float</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶è¿˜ä¼šæä¾›å¦‚ä¸‹çš„ API ç»™ä½ æ¥è¿›è¡Œäº¤æ˜“å¤„ç†ã€‚<strong>æ³¨æ„é”€å”®è®¢å•çš„é‡‘é¢æ˜¯å¦‚ä½•å˜æˆè´Ÿæ•°çš„</strong>ï¼Œè€Œä¸”ä»–ä»¬è¿˜è¯´è‚¡ç¥¨çš„ä»·æ ¼ä¸é‡è¦ï¼Œä»–ä»¬çš„å¼•æ“ä¼šåœ¨å†…éƒ¨é€‰æ‹©ä¸€ä¸ªä»·æ ¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> - å‚æ•° stock: è‚¡ç¥¨çš„åå­—</span><br><span class="line"> - å‚æ•° amount: é‡‘é¢, è´Ÿæ•°è¡¨ç¤ºé”€å”®é¢, æ­£æ•°è¡¨ç¤ºè´­ä¹°é¢</span><br><span class="line">*/</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">process</span><span class="params">(stock: String, <span class="number">_</span> amount: Int)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">"<span class="subst">\(amount)</span> of <span class="subst">\(stock)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹ä¸€æ­¥å°±æ˜¯å¯¹äº¤æ˜“è¿›è¡Œå¤„ç†ã€‚ä½ ä¼šå‘ç°æ¨¡å¼åŒ¹é…åœ¨å†™è¿™ä¸ªä¸šåŠ¡æ—¶æ‰€å…·å¤‡çš„å¼ºå¤§å¤„ç†èƒ½åŠ›ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> aTrade = <span class="type">Trades</span>.<span class="type">Buy</span>(stock: <span class="string">"APPL"</span>, amount: <span class="number">200</span>, stockPrice: <span class="number">115.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> aTrade &#123;</span><br><span class="line"><span class="keyword">case</span> .<span class="type">Buy</span>(<span class="keyword">let</span> stock, <span class="keyword">let</span> amount, <span class="number">_</span>):</span><br><span class="line">    process(stock, amount)</span><br><span class="line"><span class="keyword">case</span> .<span class="type">Sell</span>(<span class="keyword">let</span> stock, <span class="keyword">let</span> amount, <span class="number">_</span>):</span><br><span class="line">    process(stock, amount * -<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º "buy 200 of APPL"</span></span><br></pre></td></tr></table></figure>
<p>Swift å¯ä»¥è®©æˆ‘ä»¬éå¸¸æ–¹ä¾¿çš„ä» <code>enum</code> ä¸­è§£æ„/æå–å‡ºæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„ä¿¡æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­åªæœ‰ <code>stock</code> å’Œ <code>amount</code> è¢«è§£æ„å‡ºæ¥ã€‚</p>
<p>çœŸæ£’ï¼Œç°åœ¨ä½ å¯ä»¥å»åå°”è¡—å±•ç¤ºè¿™ä¸ªæå¥½çš„äº¤æ˜“å¹³å°äº†ã€‚ç„¶è€Œï¼Œç°å®å¾€å¾€æ¯”ç¾å¥½çš„æƒ³è±¡è¦æ®‹é…·å¾—å¤šã€‚ä½ ä»¥ä¸ºäº¤æ˜“å°±æ˜¯ä½ ä»¥ä¸ºçš„äº¤æ˜“ä¹ˆï¼Ÿ</p>
<ul>
<li>ä½ å¿…é¡»æ ¹æ®ä¸åŒçš„äº¤æ˜“æ–¹å¼è®¡ç®—è´¹ç”¨ã€‚</li>
<li>æœºæ„è¶Šå°ï¼Œè´¹ç”¨è¶Šé«˜</li>
<li>è€Œä¸”ï¼Œæœºæ„è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</li>
</ul>
<p>åå°”è¡—çš„äººä¹Ÿæ„è¯†åˆ°è¦å¤„ç†è¿™äº›é—®é¢˜ä½ éœ€è¦æ–°çš„ APIï¼Œæ‰€ä»¥ä»–ä»¬ç»™äº†ä½ ä¸‹é¢çš„ä¸¤ä¸ªï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">processSlow</span><span class="params">(stock: String, <span class="number">_</span> amount: Int, <span class="number">_</span> fee: Float)</span></span> &#123; <span class="built_in">print</span>(<span class="string">"slow"</span>) &#125;</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">processFast</span><span class="params">(stock: String, <span class="number">_</span> amount: Int, <span class="number">_</span> fee: Float)</span></span> &#123; <span class="built_in">print</span>(<span class="string">"fast"</span>) &#125;</span><br></pre></td></tr></table></figure>
<h2 id="äº¤æ˜“ç±»å‹">äº¤æ˜“ç±»å‹</h2><p>äºæ˜¯ä½ å›åˆ°ç»˜å›¾æ¿é‡æ–°å¢åŠ äº†ä¸€ä¸ª <code>enum</code>ã€‚äº¤æ˜“ç±»å‹ä¹Ÿæ˜¯æ¯ä¸ªäº¤æ˜“çš„ä¸€éƒ¨åˆ†ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">TraderType</span> </span>&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="type">SingleGuy</span></span><br><span class="line"><span class="keyword">case</span> <span class="type">Company</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Trades</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Buy</span>(stock: <span class="type">String</span>, amount: <span class="type">Int</span>, stockPrice: <span class="type">Float</span>, type: <span class="type">TraderType</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Sell</span>(stock: <span class="type">String</span>, amount: <span class="type">Int</span>, stockPrice: <span class="type">Float</span>, type: <span class="type">TraderType</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œå¦‚ä½•æ›´å¥½åœ°å®ç°è¿™ä¸€æ–°æœºåˆ¶å‘¢ï¼Ÿä½ å¯ä»¥ç”¨ä¸€ä¸ª <code>if / else</code> åˆ†æ”¯æ¥å®ç°è´­ä¹°å’Œé”€å”®ï¼Œä½†æ˜¯è¿™ä¼šå¯¼è‡´ä»£ç åµŒå¥—ä»¥è‡³äºå¾ˆå¿«ä»£ç å°±å˜çš„ä¸æ¸…æ™°äº†â€”â€”è€Œä¸”è°çŸ¥é“é‚£äº›åå°”è¡—äººä¼šä¸ä¼šç»™ä½ æ‰¾æ–°çš„éº»çƒ¦ã€‚æ‰€ä»¥ä½ åº”è¯¥æŠŠå®ƒå®šä¹‰ä¸ºæ¨¡å¼åŒ¹é…çš„ä¸€ä¸ªæ–°è¦æ±‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> aTrade = <span class="type">Trades</span>.<span class="type">Sell</span>(stock: <span class="string">"GOOG"</span>, amount: <span class="number">100</span>, stockPrice: <span class="number">666.0</span>, type: <span class="type">TraderType</span>.<span class="type">Company</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> aTrade &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Buy</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">SingleGuy</span>):</span><br><span class="line">    processSlow(stock, amount, <span class="number">5.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Sell</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">SingleGuy</span>):</span><br><span class="line">    processSlow(stock, -<span class="number">1</span> * amount, <span class="number">5.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Buy</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">Company</span>):</span><br><span class="line">    processFast(stock, amount, <span class="number">2.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Sell</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">Company</span>):</span><br><span class="line">    processFast(stock, -<span class="number">1</span> * amount, <span class="number">2.0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç çš„ä¼˜é›…ä¹‹å¤„åœ¨äºå®ƒéå¸¸ç®€æ´çš„æè¿°äº†ä¸åŒå¯èƒ½çš„ç»„åˆã€‚æ³¨æ„æˆ‘ä»¬æŠŠ <code>.Buy(let stock, let amount)</code> ä¿®æ”¹æˆ <code>let .Buy(stock, amount)</code> æ¥è¿›è¡Œç®€åŒ–ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨æ›´å°‘çš„è¯­å¥æ¥åƒä¹‹å‰ä¸€æ ·å¯¹ <code>enum</code> è¿›è¡Œè§£æ„ã€‚</p>
<h2 id="è­¦å«ï¼è­¦å«ï¼å‘¼å«è­¦å«ï¼">è­¦å«ï¼è­¦å«ï¼å‘¼å«è­¦å«ï¼</h2><p>äºæ˜¯ä½ å†æ¬¡å‘ä½ çš„åå°”è¡—ç”¨æˆ·å±•ç¤ºä½ çš„å¼€å‘æˆæœï¼Œè€Œä»–ä»¬åˆæå‡ºäº†æ–°çš„é—®é¢˜ï¼ˆä½ çœŸåº”è¯¥æŠŠé¡¹ç›®çš„ç»†èŠ‚é—®å¾—æ›´æ¸…æ¥šä¸€ç‚¹ï¼‰ã€‚</p>
<ul>
<li>äº¤æ˜“æ€»é¢è¶…è¿‡ 1.000.000\$ çš„é”€å”®è®¢å•é€šå¸¸éœ€è¦æ›´å¿«è¿›è¡Œå¤„ç†ï¼Œå°±ç®—æ˜¯ä¸ªäººå®¢æˆ·ä¹Ÿå¾—è¿™æ ·ã€‚</li>
<li>äº¤æ˜“æ€»é¢å°äº 1.000\$ çš„è´­ä¹°è®¢å•é€šå¸¸å¤„ç†æ›´æ…¢ã€‚</li>
</ul>
<p>å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„ <code>if</code> è¯­å¥ï¼Œè¿™æ—¶ä»£ç å°±åº”è¯¥å·²ç»æœ‰ç‚¹å‡Œä¹±äº†ï¼Œè€Œ <code>switch</code> å°±ä¸ä¼šã€‚Swift ä¸º <code>switch cases</code> æä¾›äº†ä¿æŠ¤æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶å¯ä»¥è®©ä½ è¿›ä¸€æ­¥çš„å¯¹å¯èƒ½åŒ¹é…çš„ <code>case</code> è¿›è¡Œçº¦æŸã€‚</p>
<p>ä½ åªéœ€è¦å¯¹ <code>switch</code> è¯­å¥ç¨ä½œä¿®æ”¹å°±å¯ä»¥æ»¡è¶³æ–°çš„å˜åŒ–ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> aTrade = <span class="type">Trades</span>.<span class="type">Buy</span>(stock: <span class="string">"GOOG"</span>, amount: <span class="number">1000</span>, stockPrice: <span class="number">666.0</span>, type: <span class="type">TraderType</span>.<span class="type">SingleGuy</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> aTrade &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Buy</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">SingleGuy</span>):</span><br><span class="line">    processSlow(stock, amount, <span class="number">5.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Sell</span>(stock, amount, price, <span class="type">TraderType</span>.<span class="type">SingleGuy</span>)</span><br><span class="line">    <span class="keyword">where</span> price*<span class="type">Float</span>(amount) &gt; <span class="number">1000000</span>:</span><br><span class="line">    processFast(stock, -<span class="number">1</span> * amount, <span class="number">5.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Sell</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">SingleGuy</span>):</span><br><span class="line">    processSlow(stock, -<span class="number">1</span> * amount, <span class="number">5.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Buy</span>(stock, amount, price, <span class="type">TraderType</span>.<span class="type">Company</span>)</span><br><span class="line">    <span class="keyword">where</span> price*<span class="type">Float</span>(amount) &lt; <span class="number">1000</span>:</span><br><span class="line">    processSlow(stock, amount, <span class="number">2.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Buy</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">Company</span>):</span><br><span class="line">    processFast(stock, amount, <span class="number">2.0</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Sell</span>(stock, amount, <span class="number">_</span>, <span class="type">TraderType</span>.<span class="type">Company</span>):</span><br><span class="line">    processFast(stock, -<span class="number">1</span> * amount, <span class="number">2.0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ç»“æ„å¾ˆæ¸…æ™°ï¼Œé˜…è¯»èµ·æ¥ä¹Ÿç›¸å½“ç®€å•ï¼Œå¯¹å¤æ‚æƒ…å†µçš„å°è£…ä¹Ÿå¾ˆå¥½ã€‚</p>
<p>å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸçš„å®ç°äº†æˆ‘ä»¬çš„äº¤æ˜“å¼•æ“ã€‚ç„¶è€Œï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆè¿˜æ˜¯æœ‰ç‚¹ç¹çï¼›æˆ‘ä»¬åœ¨æƒ³æ˜¯å¦è¿˜æœ‰å¯¹å…¶è¿›è¡Œæ”¹è¿›çš„æ¨¡å¼åŒ¹é…æ–¹æ¡ˆã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ç»§ç»­æ·±å…¥ç ”ç©¶ä¸€ä¸‹æ¨¡å¼åŒ¹é…ã€‚</p>
<h1 id="æ¨¡å¼åŒ¹é…è¿›é˜¶">æ¨¡å¼åŒ¹é…è¿›é˜¶</h1><p>ç°åœ¨æˆ‘ä»¬åœ¨å®æˆ˜ä¸­å·²ç»è§è¿‡äº†å‡ ç§æ¨¡å¼ã€‚ä½†å…¶è¯­æ³•æ˜¯ä»€ä¹ˆï¼Ÿè¿˜èƒ½åŒ¹é…ä»€ä¹ˆï¼ŸSwift å°†è¿™äº›æ¨¡å¼åˆ†ä¸º <strong>7</strong> ç§ã€‚æˆ‘ä»¬ç°åœ¨å°±æ¥è®¤è¯†ä¸€ä¸‹å®ƒä»¬ã€‚</p>
<p>æ‰€æœ‰çš„è¿™äº›æ¨¡å¼ä¸ä»…èƒ½ç”¨åœ¨ <code>switch</code> å…³é”®è¯ä¸Šï¼Œè€Œä¸”å¯ä»¥ç”¨åœ¨ <code>if</code>ï¼Œ<code>guard</code> å’Œ <code>for</code> å…³é”®è¯ä¸Šã€‚å¦‚éœ€äº†è§£è¯¦æƒ…ï¼Œæ¥ç€çœ‹ä¸‹é¢çš„å†…å®¹ã€‚</p>
<h2 id="1-_é€šé…ç¬¦æ¨¡å¼">1. é€šé…ç¬¦æ¨¡å¼</h2><p>é€šé…ç¬¦æ¨¡å¼ä¼šå¿½ç•¥éœ€è¦åŒ¹é…çš„å€¼ï¼Œè¿™ç§ <code>case</code> ä¸‹ä»»ä½•å€¼éƒ½æ˜¯æœ‰å¯èƒ½çš„ã€‚è¿™å’Œ <code>let _ = fn()</code> ä¸€æ ·çš„æ¨¡å¼ï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œ <code>_</code>  è¡¨ç¤ºä½ å°†ä¸å†ä½¿ç”¨è¿™ä¸ªå€¼ã€‚æœ‰æ„æ€çš„æ˜¯è¿™ä¸ªæ¨¡å¼å¯ä»¥åŒ¹é…åŒ…æ‹¬ <code>nil</code> <a href="#1">1</a>åœ¨å†…çš„æ‰€æœ‰å€¼ ã€‚å¦‚æœå¢åŠ ä¸€ä¸ª <code>?</code>ï¼Œå®ƒç”šè‡³å¯ä»¥åŒ¹é…å¯é€‰å€¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p: <span class="type">String</span>? = <span class="literal">nil</span></span><br><span class="line"><span class="keyword">switch</span> p &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">_</span>?: <span class="built_in">print</span> (<span class="string">"Has String"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="literal">nil</span>: <span class="built_in">print</span> (<span class="string">"No String"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°±åƒä½ åœ¨äº¤æ˜“ä¾‹å­é‡Œé¢çœ‹åˆ°çš„ä¸€æ ·ï¼Œå®ƒä¹Ÿå…è®¸ä½ å¿½ç•¥éœ€è¦åŒ¹é…çš„ <code>enum</code> æˆ–è€… <code>tuples</code> ä¸­æ— ç”¨çš„æ•°æ®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (<span class="number">15</span>, <span class="string">"example"</span>, <span class="number">3.14</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">_</span>, <span class="number">_</span>, <span class="keyword">let</span> pi): <span class="built_in">print</span> (<span class="string">"pi: <span class="subst">\(pi)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-_æ ‡ç¤ºæ¨¡å¼">2. æ ‡ç¤ºæ¨¡å¼</h2><p>åŒ¹é…ä¸€ä¸ªå…·ä½“çš„å€¼ã€‚è¿™ä¸ªå’Œ Objective-C çš„ <code>switch</code> å®ç°æ˜¯ä¸€æ ·çš„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> <span class="number">5</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">5</span>: <span class="built_in">print</span>(<span class="string">"5"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-_å€¼ç»‘å®šæ¨¡å¼">3. å€¼ç»‘å®šæ¨¡å¼</h2><p>è¿™ç§æ¨¡å¼å’Œé€šè¿‡ <code>let</code> æˆ–è€… <code>var</code> ç»‘å®šå€¼åˆ°å˜é‡ä¸€æ ·ï¼Œä½†æ˜¯åªèƒ½ç”¨åœ¨ <code>switch</code> ä¸­ã€‚å› ä¸ºä½ ä¹‹å‰å·²ç»è§åˆ°è¿‡ï¼Œæ‰€ä»¥æˆ‘åªç»™å‡ºä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (<span class="number">4</span>, <span class="number">5</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">let</span> (x, y): <span class="built_in">print</span>(<span class="string">"<span class="subst">\(x)</span> <span class="subst">\(y)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-_å…ƒç»„æ¨¡å¼">4. å…ƒç»„æ¨¡å¼</h2><p><a href="http://appventure.me/2015/07/19/tuples-swift-advanced-usage-best-practices/" target="_blank" rel="external">å…³äºå…ƒç»„æˆ‘å·²ç»å†™äº†ä¸€æ•´ç¯‡åšæ–‡</a>ï¼Œè¿™ç¯‡åšæ–‡æ‰€æä¾›çš„ä¿¡æ¯è¿œè¿œæ¯”è¿™é‡Œå¤šï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯åœ¨è¿™é‡Œç»™å‡ºä¸€ä¸ªç®€çŸ­çš„ä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = <span class="number">23</span></span><br><span class="line"><span class="keyword">let</span> job: <span class="type">String</span>? = <span class="string">"Operator"</span></span><br><span class="line"><span class="keyword">let</span> payload: <span class="type">AnyObject</span> = <span class="type">NSDictionary</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (age, job, payload) &#123;</span><br><span class="line">  <span class="keyword">case</span> (<span class="keyword">let</span> age, <span class="number">_</span>?, <span class="number">_</span> <span class="keyword">as</span> <span class="type">NSDictionary</span>):</span><br><span class="line">  <span class="built_in">print</span>(age)</span><br><span class="line">  <span class="keyword">default</span>: ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ 3 ä¸ªå€¼ç»“åˆæ”¾åˆ°ä¸€ä¸ªå…ƒç»„ä¸­ï¼ˆå‡æƒ³å®ƒä»¬æ˜¯é€šè¿‡è°ƒç”¨ä¸åŒçš„ API å¾—åˆ°çš„ï¼‰ï¼Œç„¶åä¸€å£æ°”åŒ¹é…å®ƒä»¬ï¼Œæ³¨æ„è¿™ä¸ªæ¨¡å¼å®Œæˆäº†ä¸‰ä»¶äº‹æƒ…ï¼š</p>
<ol>
<li>æå– <code>age</code></li>
<li>ç¡®ä¿å­˜åœ¨ä¸€ä¸ª <code>job</code>ï¼Œå°±ç®—æˆ‘ä»¬ä¸éœ€è¦å®ƒ</li>
<li>ç¡®ä¿ <code>payload</code> çš„ç±»å‹æ˜¯ <code>NSDictionary</code>ï¼Œå°½ç®¡æˆ‘ä»¬åŒæ ·ä¸éœ€è¦è®¿é—®å®ƒçš„å…·ä½“å€¼ã€‚</li>
</ol>
<h2 id="5-_æšä¸¾_Case_æ¨¡å¼ï¼ˆEnumeration_Case_Patternï¼‰">5. æšä¸¾ Case æ¨¡å¼ï¼ˆEnumeration Case Patternï¼‰</h2><p>å°±å¦‚ä½ åœ¨äº¤æ˜“ä¾‹å­ä¸­æ‰€è§ï¼Œæ¨¡å¼åŒ¹é…å¯¹ Swift çš„ <code>enum</code> æ”¯æŒ<strong>ç›¸å½“æ£’</strong>ã€‚è¿™æ˜¯å› ä¸º <code>enum cases</code> å°±åƒå¯†å°ã€ä¸å¯å˜ä¸”å¯è§£æ„çš„ç»“æ„ä½“ã€‚è¿™éå¸¸åƒ <code>tuples</code>ï¼Œä½ å¯ä»¥æ‰“å¼€æ­£å¥½åŒ¹é…ä¸Šçš„æŸä¸ªå•ç‹¬ <code>case</code> çš„å†…å®¹ç„¶ååªæŠ½å–å‡ºä½ éœ€è¦çš„ä¿¡æ¯<a href="#2">2</a>ã€‚ </p>
<p>å‡æƒ³ä½ æ­£åœ¨ç”¨å‡½æ•°å¼çš„é£æ ¼å†™ä¸€ä¸ªæ¸¸æˆï¼Œç„¶åä½ éœ€è¦å®šä¹‰ä¸€äº›å®ä½“ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>structs</code> ä½†æ˜¯ä½ çš„å®ä½“çš„çŠ¶æ€å¾ˆå°‘ï¼Œä½ è§‰å¾—è¿™æ ·æœ‰ç‚¹çŸ«æ‰è¿‡æ­£ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Entities</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Soldier</span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Tank</span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Player</span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ éœ€è¦å®ç°ç»˜å›¾å¾ªç¯ã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ X å’Œ Y åæ ‡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> entities() &#123;</span><br><span class="line">    <span class="keyword">switch</span> e &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Soldier</span>(x, y):</span><br><span class="line">      drawImage(<span class="string">"soldier.png"</span>, x, y)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Tank</span>(x, y):</span><br><span class="line">      drawImage(<span class="string">"tank.png"</span>, x, y)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Player</span>(x, y):</span><br><span class="line">      drawImage(<span class="string">"player.png"</span>, x, y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-_ç±»å‹è½¬æ¢æ¨¡å¼">6. ç±»å‹è½¬æ¢æ¨¡å¼</h2><p>å°±åƒåå­—æ‰€è¡¨ç¤ºçš„ä¸€æ ·ï¼Œè¿™ç§æ¨¡å¼è½¬æ¢æˆ–è€…åŒ¹é…ç±»å‹ã€‚å®ƒæœ‰ä¸¤ç§ä¸åŒçš„å…³é”®è¯ï¼š</p>
<ul>
<li><code>is</code> <strong>ç±»å‹</strong>ï¼šåŒ¹é…å³æ‰‹è¾¹å†…å®¹çš„è¿è¡Œæ—¶ç±»å‹ï¼ˆæˆ–è€…ç±»å‹çš„å­ç±»ï¼‰ã€‚å®ƒä¼šåšç±»å‹è½¬æ¢ä½†æ˜¯ä¸å…³æ³¨è¿”å›å€¼ã€‚æ‰€ä»¥ä½ çš„ <code>case</code> å—ä¸çŸ¥é“æ‰€åŒ¹é…çš„ç±»å‹æ˜¯ä»€ä¹ˆã€‚</li>
<li>æ¨¡å¼ <code>as</code> <strong>ç±»å‹</strong>ï¼šå’Œ <code>is</code> æ¨¡å¼åšåŒæ ·çš„åŒ¹é…æ“ä½œï¼Œä½†æ˜¯å¦‚æœæˆåŠŸçš„è¯ä¼šæŠŠç±»å‹è½¬æ¢åˆ°å·¦ä¾§æŒ‡å®šçš„æ¨¡å¼ä¸­ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯è¿™ä¸¤ç§å…³é”®è¯çš„ä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a: <span class="type">Any</span> = <span class="number">5</span> </span><br><span class="line"><span class="keyword">switch</span> a &#123;</span><br><span class="line">  <span class="comment">// è¿™ä¼šå¤±è´¥å› ä¸ºå®ƒçš„ç±»å‹ä»ç„¶æ˜¯ `Any`</span></span><br><span class="line">  <span class="comment">// é”™è¯¯: binary operator '+' cannot be applied to operands of type 'Any' and 'Int'</span></span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">is</span> <span class="type">Int</span>: <span class="built_in">print</span> (a + <span class="number">1</span>)</span><br><span class="line">  <span class="comment">// æœ‰æ•ˆå¹¶è¿”å› '6'</span></span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">let</span> n <span class="keyword">as</span> <span class="type">Int</span>: <span class="built_in">print</span> (n + <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">default</span>: ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ <code>is</code> å‰æ²¡æœ‰ <code>pattern</code>ã€‚å®ƒç›´æ¥å’Œ <code>a</code> åšåŒ¹é…ã€‚</p>
<h2 id="7-_è¡¨è¾¾æ¨¡å¼">7. è¡¨è¾¾æ¨¡å¼</h2><p>è¡¨è¾¾æ¨¡å¼éå¸¸å¼ºå¤§ã€‚å®ƒå¯ä»¥æŠŠ <code>switch</code> çš„å€¼å’Œå®ç°äº† <code>~=</code> æ“ä½œç¬¦çš„è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ã€‚è€Œä¸”å¯¹äºè¿™ä¸ªæ“ä½œç¬¦æœ‰é»˜è®¤çš„å®ç°ï¼Œæ¯”å¦‚å¯¹äºèŒƒå›´åŒ¹é…ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> <span class="number">5</span> &#123;</span><br><span class="line"> <span class="keyword">case</span> <span class="number">0</span>..<span class="number">10</span>: <span class="built_in">print</span>(<span class="string">"In range 0-10"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œæ›´æœ‰è¶£çš„å¯èƒ½æ˜¯è‡ªå·±é‡å†™æ“ä½œç¬¦ï¼Œç„¶åä½¿ä½ çš„è‡ªå®šä¹‰ç±»å‹å¯ä»¥åŒ¹é…ã€‚æˆ‘ä»¬å‡å®šä½ æƒ³é‡å†™ä¹‹å‰å†™çš„å£«å…µæ¸¸æˆï¼Œè€Œä¸”ä½ æ— è®ºå¦‚ä½•éƒ½è¦ä½¿ç”¨ç»“æ„ä½“ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Soldier</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> hp: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">let</span> x: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">let</span> y: <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ æƒ³è½»æ¾çš„åŒ¹é…æ‰€æœ‰è¡€é‡ä¸º <strong>0</strong> çš„å®ä½“ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢ä¸€æ ·å®ç° <code>~=</code> æ“ä½œç¬¦ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> ~= <span class="params">(pattern: Int, value: Soldier)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> pattern == value.hp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¯¹ä¸€ä¸ªå®ä½“åšåŒ¹é…äº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> soldier = <span class="type">Soldier</span>(hp: <span class="number">99</span>, x: <span class="number">10</span>, y: <span class="number">10</span>)</span><br><span class="line"><span class="keyword">switch</span> soldier &#123;</span><br><span class="line">   <span class="keyword">case</span> <span class="number">0</span>: <span class="built_in">print</span>(<span class="string">"dead soldier"</span>)</span><br><span class="line">   <span class="keyword">default</span>: ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸å¹¸çš„æ˜¯ï¼Œå¯¹å…ƒç»„åšå…¨åŒ¹é…ä¼¼ä¹ä¸å¥½ä½¿ã€‚å¦‚æœä½ ç¼–å†™ä¸‹é¢çš„ä»£ç ï¼Œå°±ä¼šå‡ºç°ç±»å‹æ£€æŸ¥é”™è¯¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> ~= <span class="params">(pattern: <span class="params">(hp: Int, x: Int, y: Int)</span></span></span>, value: <span class="type">Soldier</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">   <span class="keyword">let</span> (hp, x, y) = pattern</span><br><span class="line">   <span class="keyword">return</span> hp == value.hp &amp;&amp; x == value.x &amp;&amp; y == value.y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªå¯èƒ½è§£å†³ä¸Šè¿°ç±»ä¼¼é—®é¢˜çš„æ–¹æ¡ˆæ˜¯ç»™ä½ çš„ <code>struct</code> å¢åŠ ä¸€ä¸ª <code>unapply</code> æ–¹æ³•ç„¶åå†è¿›è¡ŒåŒ¹é…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Soldier</span> </span>&#123;</span><br><span class="line">   <span class="func"><span class="keyword">func</span> <span class="title">unapply</span><span class="params">()</span></span> -&gt; (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (<span class="keyword">self</span>.hp, <span class="keyword">self</span>.x, <span class="keyword">self</span>.y)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> ~= <span class="params">(p: <span class="params">(Int, Int, Int)</span></span></span>, t: (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>)) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> p.<span class="number">0</span> == t.<span class="number">0</span> &amp;&amp; p.<span class="number">1</span> == t.<span class="number">1</span> &amp;&amp; p.<span class="number">2</span> == t.<span class="number">2</span> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> soldier = <span class="type">Soldier</span>(hp: <span class="number">99</span>, x: <span class="number">10</span>, y: <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(soldier.unapply() ~= (<span class="number">99</span>, <span class="number">10</span>, <span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ç›¸å½“ç¹çè€Œä¸”æ²¡æœ‰åˆ©ç”¨å¥½æ¨¡å¼åŒ¹é…èƒŒåçš„å¤§é‡é­”æ³•èˆ¬çš„æ•ˆæœã€‚</p>
<p>åœ¨è¿™ç¯‡åšæ–‡ä¹‹å‰çš„ç‰ˆæœ¬ä¸­æˆ‘å†™è¿‡ <code>~=</code> ä¸é€‚ç”¨äºåè®®ï¼Œä½†æ˜¯æˆ‘é”™äº†ã€‚æˆ‘è®°å¾—æˆ‘åœ¨ä¸€ä¸ª <code>Playground</code> ä¸­è¯•è¿‡ã€‚è€Œè¿™ä¸ªä¾‹å­ï¼ˆ<a href="https://www.reddit.com/r/swift/comments/3hq6id/match_me_if_you_can_swift_pattern_matching_in/cub187r" target="_blank" rel="external">ç”± reddit ä¸Šçš„ latrodectus å‹æƒ…æä¾›</a>ï¼‰æ˜¯å®Œå…¨å¯ç”¨çš„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Entity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value: <span class="type">Int</span> &#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tank</span>: <span class="title">Entity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> value: <span class="type">Int</span>) &#123; <span class="keyword">self</span>.value = value &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Peasant</span>: <span class="title">Entity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> value: <span class="type">Int</span>) &#123; <span class="keyword">self</span>.value = value &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> ~=<span class="params">(pattern: Entity, x: Entity)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> pattern.value == x.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> <span class="type">Tank</span>(<span class="number">42</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Peasant</span>(<span class="number">42</span>): <span class="built_in">print</span>(<span class="string">"Matched"</span>) <span class="comment">// åŒ¹é…æˆåŠŸ</span></span><br><span class="line">    <span class="keyword">default</span>: ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥åˆ©ç”¨ <code>Expression Patterns</code> åšå¾ˆå¤šäº‹æƒ…ã€‚å¦‚æœæƒ³è¦äº†è§£æ›´å¤šè¡¨è¾¾æ¨¡å¼çš„ç»†èŠ‚ï¼Œ<a href="http://austinzheng.com/2014/12/17/custom-pattern-matching/" target="_blank" rel="external">çœ‹çœ‹è¿™ç¯‡ç”± Austin Zheng å†™çš„è¶…æ£’åšæ–‡</a>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»è®²å®Œäº†æ‰€æœ‰å¯èƒ½çš„ <code>switch</code> æ¨¡å¼ã€‚åœ¨æˆ‘ä»¬ç»§ç»­è®²è§£ä¹‹å‰ï¼Œè¿˜éœ€è¦è®¨è®ºæœ€åä¸€ä»¶äº‹æƒ…ã€‚</p>
<h2 id="fallthroughï¼Œbreak_å’Œæ ‡ç­¾">fallthroughï¼Œbreak å’Œæ ‡ç­¾</h2><p>ä¸‹é¢çš„å†…å®¹å’Œæ¨¡å¼åŒ¹é…æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œä»…ä»…æ˜¯å’Œ <code>switch</code> å…³é”®è¯æœ‰å…³ï¼Œæ‰€ä»¥æˆ‘å°±ç®€å•è¯´äº†ã€‚å’Œ C/C++/Objective-C ä¸ä¸€æ ·çš„æ˜¯ï¼š<code>switch cases</code> ä¸ä¼šè‡ªåŠ¨è¿›å…¥ä¸‹ä¸€ä¸ª <code>case</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Swift ä¸éœ€è¦ç»™æ¯ä¸ª <code>case</code> éƒ½å†™ä¸Š <code>break</code>ã€‚ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ <code>fallthrough</code> å…³é”®è¯æ¥å®ç°ä¼ ç»Ÿçš„è‡ªåŠ¨è¿›å…¥ä¸‹ä¸€ä¸ª <code>case</code> çš„è¡Œä¸ºã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> <span class="number">5</span> &#123;</span><br><span class="line">   <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Is 5"</span>)</span><br><span class="line">    <span class="keyword">fallthrough</span></span><br><span class="line">   <span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Is a number"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¼šåœ¨å‘½ä»¤è¡Œè¾“å‡º: "Is 5" "Is a number"</span></span><br></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>break</code> æ¥æå‰è·³å‡º <code>switch</code> è¯­å¥ã€‚æ—¢ç„¶ä¸ä¼šé»˜è®¤è¿›å…¥ä¸‹ä¸€ä¸ª <code>case</code>ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦è¿™ä¹ˆåšå‘¢ï¼Ÿæ¯”å¦‚ä½ çŸ¥é“åœ¨ä¸€ä¸ª <code>case</code> ä¸­æœ‰ä¸€ä¸ªå¿…é¡»çš„è¦æ±‚æ˜¯ä¸æ»¡è¶³çš„ï¼Œè¿™æ ·ä½ å°±ä¸èƒ½ç»§ç»­æ‰§è¡Œè¿™ä¸ª <code>case</code> äº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> userType = <span class="string">"system"</span></span><br><span class="line"><span class="keyword">let</span> userID = <span class="number">10</span></span><br><span class="line"><span class="keyword">switch</span> (userType, userID)  &#123;</span><br><span class="line">   <span class="keyword">case</span> (<span class="string">"system"</span>, <span class="number">_</span>):</span><br><span class="line">     <span class="keyword">guard</span> <span class="keyword">let</span> userData = getSystemUser(userID) <span class="keyword">else</span> &#123; <span class="keyword">break</span> &#125;</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">"user info: <span class="subst">\(userData)</span>"</span>)</span><br><span class="line">     insertIntoRemoteDB(userData)</span><br><span class="line">   <span class="keyword">default</span>: ()</span><br><span class="line">&#125;</span><br><span class="line">... å…¶ä»–ä½ éœ€è¦æ‰§è¡Œçš„ä»£ç </span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå½“ <code>getSystemUser</code> è¿”å›çš„ç»“æœæ˜¯ <code>nil</code> æ—¶ä½ ä¸æƒ³å†ç»§ç»­è°ƒç”¨ <code>insertIntoRemoteData</code>ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨ <code>if let</code>ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªè¿™æ ·çš„æƒ…å†µç»“åˆåˆ°ä¸€èµ·çš„æ—¶å€™ï¼Œå¾ˆå¿«ä½ å°±ä¼šå¾—åˆ°ä¸€å †å¯æ€•ä¸‘é™‹çš„ <code>if lets</code> åµŒå¥—ä»£ç ã€‚</p>
<p>ä½†æ˜¯å¦‚æœä½ æ˜¯åœ¨ä¸€ä¸ª <code>while</code> å¾ªç¯ä¸­æ‰§è¡Œä½ çš„ <code>switch</code> è¯­å¥ï¼Œç„¶åä½ æƒ³è·³å‡ºå¾ªç¯ï¼Œè€Œä¸æ˜¯ <code>switch</code> çš„æ—¶å€™ï¼Œä½ éœ€è¦æ€ä¹ˆåšå‘¢ï¼Ÿå¯¹ä¸è¿™ç§æƒ…å†µï¼Œ Swift å…è®¸ä½ å®šä¹‰ä¸€ä¸ª <code>labels</code> ï¼Œç„¶å <code>break</code> æˆ–è€… <code>continue</code> åˆ°è¿™ä¸ª <code>labels</code>ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gameLoop: <span class="keyword">while</span> <span class="literal">true</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> state() &#123;</span><br><span class="line">     <span class="keyword">case</span> .<span class="type">Waiting</span>: <span class="keyword">continue</span> gameLoop</span><br><span class="line">     <span class="keyword">case</span> .<span class="type">Done</span>: calculateNextState()</span><br><span class="line">     <span class="keyword">case</span> .<span class="type">GameOver</span>: <span class="keyword">break</span> gameLoop</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡ <code>switch</code> å’Œæ¨¡å¼åŒ¹é…çš„è¯­æ³•å’Œå®ç°ç»†èŠ‚ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€äº›ï¼ˆå¤šå°‘æœ‰ç‚¹ï¼‰æœ‰è¶£çš„çœŸå®æ¡ˆä¾‹ã€‚</p>
<h1 id="çœŸå®æ¡ˆä¾‹">çœŸå®æ¡ˆä¾‹</h1><h2 id="å¯é€‰å€¼">å¯é€‰å€¼</h2><p><a href="http://appventure.me/2014/06/13/swift-optionals-made-simple/" target="_blank" rel="external">å¯¹å¯é€‰å€¼è¿›è¡Œè§£åŒ…çš„æ–¹å¼æœ‰å¾ˆå¤šç§</a>ï¼Œæ¨¡å¼åŒ¹é…å°±æ˜¯å…¶ä¸­ä¸€ç§ã€‚å¯èƒ½åˆ°ç°åœ¨è¿™ç§æ–¹æ³•ä½ å·²ç»ç”¨å¾—éå¸¸é¢‘ç¹äº†ï¼Œä½†è¿˜æ˜¯ç»™ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­å§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result: <span class="type">String</span>? = secretMethod()</span><br><span class="line"><span class="keyword">switch</span> result &#123;</span><br><span class="line"><span class="keyword">case</span> .<span class="type">None</span>:</span><br><span class="line">    <span class="built_in">println</span>(<span class="string">"is nothing"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> a:</span><br><span class="line">    <span class="built_in">println</span>(<span class="string">"<span class="subst">\(a)</span> is a value"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯ Swift 2.0 çš„è¯ï¼Œè¿™ä¼šæ›´ç®€å•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result: <span class="type">String</span>? = secretMethod()</span><br><span class="line"><span class="keyword">switch</span> result &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="literal">nil</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"is nothing"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> a?:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(a)</span> is a value"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚ä½ æ‰€è§ï¼Œ<code>result</code> å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯å®ƒä¹Ÿå¯èƒ½æ˜¯ <code>nil</code>ï¼Œå› ä¸ºå®ƒæ˜¯ <code>optional</code> å€¼ã€‚é€šè¿‡å¯¹ <code>result</code> æ‰§è¡Œ <code>switch</code>ã€‚æˆ‘ä»¬å¯ä»¥ç¡®å®šå®ƒæ˜¯ <code>.None</code> æˆ–è€…æ˜¯ä¸€ä¸ªç¡®å®šçš„å€¼ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœä»–æ˜¯ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>a</code> è¿™ç§æƒ…å†µä¸‹é©¬ä¸ŠæŠŠè¿™ä¸ªå€¼ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ã€‚è¿™æ®µä»£ç ä»£ç çš„ä¼˜ç¾ä¹‹å¤„åœ¨äºï¼šå˜é‡ <code>result</code> å¯èƒ½å­˜åœ¨çš„ä¸¤ç§çŠ¶æ€è¢«éå¸¸æ˜æ˜¾çš„åŒºåˆ†å¼€æ¥ã€‚</p>
<h2 id="ç±»å‹åŒ¹é…">ç±»å‹åŒ¹é…</h2><p>åšä¸ºå¼ºç±»å‹è¯­è¨€ï¼ŒSwift é€šå¸¸ä¸ä¼šåƒ Objective-C é‚£æ ·ç»å¸¸éœ€è¦è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ã€‚ç„¶è€Œï¼Œå½“ä½ éœ€è¦ä¸ä¼ ç»Ÿçš„ Objective-C ä»£ç äº¤äº’æ—¶ï¼ˆ<a href="https://netguru.co/blog/objective-c-generics" target="_blank" rel="external">è¿™è¿˜æ²¡æœ‰æ›´æ–°åˆ°ç®€å•æ³›å‹çš„åå°„ä¸€æ–‡ä¸­</a>ï¼‰ï¼Œé‚£ä½ å°±ç»å¸¸ä¼šç¢°åˆ°éœ€è¦åšç±»å‹æ£€æŸ¥çš„ä»£ç ã€‚å‡æƒ³ä½ å¾—åˆ°äº†ä¸€ä¸ªåŒ…å« <code>NSString</code> å’Œ <code>NSNumber</code> å…ƒç´ çš„æ•°ç»„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> u = <span class="type">NSArray</span>(array: [<span class="type">NSString</span>(string: <span class="string">"String1"</span>), <span class="type">NSNumber</span>(int: <span class="number">20</span>), <span class="type">NSNumber</span>(int: <span class="number">40</span>)])</span><br></pre></td></tr></table></figure>
<p>å½“ä½ éå†è¿™ä¸ª <code>NSArray</code> æ—¶ï¼Œä½ æ°¸è¿œä¸çŸ¥é“å¾—åˆ°çš„æ˜¯ä»€ä¹ˆç±»å‹ã€‚ç„¶è€Œï¼Œ <code>switch</code> è¯­å¥å¯ä»¥è®©ä½ å¾ˆç®€å•çš„æ£€æŸ¥è¿™äº›ç±»å‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> u &#123;</span><br><span class="line">    <span class="keyword">switch</span> x &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">_</span> <span class="keyword">as</span> <span class="type">NSString</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"string"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="number">_</span> <span class="keyword">as</span> <span class="type">NSNumber</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"number"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Unknown types"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æŒ‰èŒƒå›´åšåˆ†çº§">æŒ‰èŒƒå›´åšåˆ†çº§</h2><p>ç°åœ¨ä½ æ­£åœ¨ç»™ä½ å½“åœ°çš„é«˜æ ¡å†™åˆ†çº§çš„ iOS åº”ç”¨ã€‚è€å¸ˆæƒ³è¦è¾“å…¥ä¸€ä¸ª 0 åˆ° 100 çš„æ•°å€¼ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªç›¸åº”çš„ç­‰çº§å­—ç¬¦ï¼ˆA-Fï¼‰ã€‚æ¨¡å¼åŒ¹é…ç°åœ¨è¦æ¥æ‹¯æ•‘ä½ äº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> aGrade = <span class="number">84</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> aGrade &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">90</span>...<span class="number">100</span>: <span class="built_in">print</span>(<span class="string">"A"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">80</span>...<span class="number">90</span>: <span class="built_in">print</span>(<span class="string">"B"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">70</span>...<span class="number">80</span>: <span class="built_in">print</span>(<span class="string">"C"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">60</span>...<span class="number">70</span>: <span class="built_in">print</span>(<span class="string">"D"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>...<span class="number">60</span>: <span class="built_in">print</span>(<span class="string">"F"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Incorrect Grade"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å­—é¢‘ç‡ç»Ÿè®¡">å­—é¢‘ç‡ç»Ÿè®¡</h2><p>æœ‰ä¸€ç³»åˆ—çš„æ•°æ®å¯¹ï¼Œæ¯ä¸ªæ•°æ®å¯¹ä»£è¡¨ä¸€ä¸ªå­—å’Œå®ƒåœ¨æŸæ®µæ–‡å­—ä¸­å‡ºç°çš„é¢‘ç‡ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æŠŠé‚£äº›ä½äºæˆ–è€…é«˜äºæŸä¸ªå›ºå®šé˜ˆå€¼çš„æ•°æ®å¯¹è¿‡æ»¤æ‰ï¼Œç„¶ååªè¿”å›å‰©ä¸‹çš„ä¸åŒ…å«å…¶é¢‘ç‡çš„æ‰€æœ‰å­—ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬çš„å­—é›†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wordFreqs = [(<span class="string">"k"</span>, <span class="number">5</span>), (<span class="string">"a"</span>, <span class="number">7</span>), (<span class="string">"b"</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ <code>map</code> å’Œ <code>filter</code> è¿›è¡Œå»ºæ¨¡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res = wordFreqs.<span class="built_in">filter</span>(&#123; (e) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">if</span> e.<span class="number">1</span> &gt; <span class="number">3</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="built_in">map</span> &#123; $<span class="number">0.0</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œå› ä¸º <code>flatmap</code> åªèƒ½è¿”å›éç©ºå…ƒç´ ï¼Œæ‰€ä»¥è¿™ä¸ªè§£å†³æ–¹æ¡ˆè¿˜æœ‰å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥æ”¾å¼ƒä½¿ç”¨ <code>e.1</code> è€Œåˆ©ç”¨å…ƒç»„æ¥åšé€‚å½“çš„è§£æ„ï¼ˆä½ çŒœå¯¹äº†ï¼‰ã€‚ç„¶åæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ä¸€æ¬¡ <code>flatmap</code>ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å…ˆ <code>filter</code> å <code>map</code> æ‰€å¸¦æ¥çš„ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res = wordFreqs.flatMap &#123; (e) -&gt; <span class="type">String</span>? <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">switch</span> e &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> (s, t) <span class="keyword">where</span> t &gt; <span class="number">3</span>: <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">default</span>: <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h2 id="éå†ç›®å½•">éå†ç›®å½•</h2><p>å‡æƒ³ä½ éœ€è¦éå†ä¸€ä¸ªæ–‡ä»¶æ ‘ç„¶åæŸ¥æ‰¾ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>æ‰€æœ‰ customer1 å’Œ customer2 åˆ›å»ºçš„ â€œpsdâ€œæ–‡ä»¶</li>
<li>æ‰€æœ‰ customer2 åˆ›å»ºçš„ â€œblendâ€œæ–‡ä»¶</li>
<li>æ‰€æœ‰ç”¨æˆ·åˆ›å»ºçš„ â€œjpegâ€œæ–‡ä»¶</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> enumerator = <span class="type">NSFileManager</span>.defaultManager().enumeratorAtPath(<span class="string">"/customers/2014/"</span>)</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> enumerator &#123;</span><br><span class="line">    <span class="keyword">switch</span> (url.pathComponents, url.pathExtension) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// customer1 å’Œ customer2 åˆ›å»ºçš„ â€œpsdâ€œæ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">case</span> (<span class="keyword">let</span> f, <span class="string">"psd"</span>) </span><br><span class="line">	    <span class="keyword">where</span> f.<span class="built_in">contains</span>(<span class="string">"customer1"</span>) </span><br><span class="line">	    || f.<span class="built_in">contains</span>(<span class="string">"customer2"</span>): <span class="built_in">print</span>(url)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// customer2 åˆ›å»ºçš„ â€œblendâ€œæ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">case</span> (<span class="keyword">let</span> f, <span class="string">"blend"</span>) <span class="keyword">where</span> f.<span class="built_in">contains</span>(<span class="string">"customer2"</span>): <span class="built_in">print</span>(url)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰€æœ‰çš„ â€œjpegâ€œæ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">case</span> (<span class="number">_</span>, <span class="string">"jpg"</span>): <span class="built_in">print</span>(url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>: ()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ <code>contains</code> åœ¨ç¬¬ä¸€ä¸ªåŒ¹é…å°±ç»“æŸç„¶åå°±ä¸ç”¨éå†å®Œæ•´çš„è·¯å¾„äº†ã€‚åŒæ ·ï¼Œæ¨¡å¼åŒ¹é…çš„ä»£ç éå¸¸ç®€æ´æ˜äº†ã€‚</p>
<h2 id="Fibonacci">Fibonacci</h2><p>åŒæ ·ï¼Œæ¥çœ‹ä¸€ä¸‹ä½¿ç”¨æ¨¡å¼åŒ¹é…å®ç°çš„ fibonacci ç®—æ³•æœ‰å¤šä¼˜ç¾<a href="#3">3</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">fibonacci</span><span class="params">(i: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span>(i) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> n <span class="keyword">where</span> n &lt;= <span class="number">0</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>, <span class="number">1</span>: <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> n: <span class="keyword">return</span> fibonacci(n - <span class="number">1</span>) + fibonacci(n - <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fibonacci(<span class="number">8</span>))</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œå¦‚æœæ˜¯å¤§æ•°çš„è¯ï¼Œç¨‹åºæ ˆä¼šçˆ†æ‰ã€‚</p>
<h2 id="ä¼ ç»Ÿçš„_API_å’Œå€¼æå–">ä¼ ç»Ÿçš„ API å’Œå€¼æå–</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“ä½ ä»å¤–éƒ¨æºå–æ•°æ®çš„æ—¶å€™ï¼Œæ¯”å¦‚ä¸€ä¸ªåº“ï¼Œæˆ–è€…ä¸€ä¸ª APIï¼Œå®ƒä¸ä»…æ˜¯ä¸€ç§å¾ˆå¥½çš„åšæ³•ï¼Œè€Œä¸”é€šå¸¸åœ¨è§£ææ•°æ®ä¹‹å‰éœ€è¦æ£€æŸ¥æ•°æ®çš„ä¸€è‡´æ€§ã€‚ä½ éœ€è¦ç¡®ä¿æ‰€æœ‰çš„ <code>key</code> éƒ½æ˜¯å­˜åœ¨çš„ã€æˆ–è€…æ•°æ®çš„ç±»å‹éƒ½æ­£ç¡®ã€æˆ–è€…æ•°ç»„çš„é•¿åº¦æ»¡è¶³è¦æ±‚ã€‚å¦‚æœä¸è¿™ä¹ˆåšå°±ä¼šå› ä¸º bugï¼ˆæœ‰çš„ <code>key</code> ä¸å­˜åœ¨ï¼‰è€Œå¯¼è‡´ app å´©æºƒï¼ˆç´¢å¼•ä¸å­˜åœ¨çš„æ•°ç»„é¡¹ï¼‰ã€‚è€Œä¼ ç»Ÿçš„åšæ³•é€šå¸¸æ˜¯åµŒå¥— <code>if</code> è¯­å¥ã€‚</p>
<p>å‡æƒ³æœ‰ API è¿”å›ä¸€æ¡ç”¨æˆ·ä¿¡æ¯ã€‚ä½†æ˜¯æœ‰ä¸¤ç§ç±»å‹çš„ç”¨æˆ·ï¼šç³»ç»Ÿç”¨æˆ·â€”â€”å¦‚ç®¡ç†å‘˜æˆ–è€…é‚®æ”¿å±€é•¿â€”â€”å’Œæœ¬åœ°ç”¨æˆ·â€”â€”å¦‚ â€œJohn Bâ€ã€â€œBill Gatesâ€ç­‰ã€‚å› ä¸ºç³»ç»Ÿçš„è®¾è®¡å’Œå¢é•¿ï¼ŒAPI çš„ä½¿ç”¨è€…éœ€è¦å¤„ç†ä¸€äº›éº»çƒ¦çš„äº‹æƒ…ï¼š</p>
<ul>
<li><code>system</code> å’Œ <code>local</code> ç”¨æˆ·æ¥è‡ªåŒä¸€ä¸ª API è°ƒç”¨ã€‚</li>
<li>å› ä¸ºæ—©æœŸç‰ˆæœ¬çš„æ•°æ®åº“æ²¡æœ‰ <code>department</code> è¿™ä¸ªå­—æ®µï¼Œæ‰€ä»¥è¿™ä¸ª <code>key</code> å¯èƒ½æ˜¯ä¸å­˜åœ¨çš„ï¼Œè€Œä¸”æ—©æœŸçš„é›‡å‘˜ä»æ¥éƒ½ä¸éœ€è¦å¡«å†™è¿™ä¸ªå­—æ®µã€‚</li>
<li>æ ¹æ®ç”¨æˆ·è¢«åˆ›å»ºçš„æ—¶é—´ï¼Œ<code>name</code> æ•°ç»„å¯èƒ½åŒ…å« 4 ä¸ªå…ƒç´ ï¼ˆusernameï¼Œmiddlenameï¼Œlastname å’Œ firstnameï¼‰æˆ–è€… 2 ä¸ªå…ƒç´ ï¼ˆfull nameï¼Œusernameï¼‰</li>
<li><code>age</code> æ˜¯ä»£è¡¨ç”¨æˆ·å¹´é¾„çš„æ•´å‹æ•°</li>
</ul>
<p>æˆ‘ä»¬çš„ç³»ç»Ÿéœ€è¦ç»™è¿™ä¸ª API è¿”å›çš„æ‰€æœ‰ç³»ç»Ÿç”¨æˆ·åˆ›å»ºç”¨æˆ·è´¦å·ï¼Œè´¦å·ä¿¡æ¯åªåŒ…å«å¦‚ä¸‹ä¿¡æ¯ï¼šusername å’Œ departmentã€‚æˆ‘ä»¬åªéœ€è¦ 1980 å¹´ä»¥å‰å‡ºç”Ÿçš„ç”¨æˆ·ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š departmentï¼Œå°±æŒ‡å®šä¸º â€œCorpâ€ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">legacyAPI</span><span class="params">(id: Int)</span></span> -&gt; [<span class="type">String</span>: <span class="type">AnyObject</span>] &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">"type"</span>: <span class="string">"system"</span>, <span class="string">"department"</span>: <span class="string">"Dark Arts"</span>, <span class="string">"age"</span>: <span class="number">57</span>, </span><br><span class="line">	   <span class="string">"name"</span>: [<span class="string">"voldemort"</span>, <span class="string">"Tom"</span>, <span class="string">"Marvolo"</span>, <span class="string">"Riddle"</span>]] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¸ºç»™å®šçš„çº¦æŸå®ç°ä¸€ä¸ªæ¨¡å¼æ¥è¿›è¡ŒåŒ¹é…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> item = legacyAPI(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">switch</span> (item[<span class="string">"type"</span>], item[<span class="string">"department"</span>], item[<span class="string">"age"</span>], item[<span class="string">"name"</span>]) &#123;</span><br><span class="line">   <span class="keyword">case</span> <span class="keyword">let</span> (sys <span class="keyword">as</span> <span class="type">String</span>, dep <span class="keyword">as</span> <span class="type">String</span>, age <span class="keyword">as</span> <span class="type">Int</span>, name <span class="keyword">as</span> [<span class="type">String</span>]) <span class="keyword">where</span> </span><br><span class="line">      age &lt; <span class="number">1980</span> &amp;&amp;</span><br><span class="line">      sys == <span class="string">"system"</span>:</span><br><span class="line">     createSystemUser(name.<span class="built_in">count</span> == <span class="number">2</span> ? name.last! : name.first!, dep: dep ?? <span class="string">"Corp"</span>)</span><br><span class="line">  <span class="keyword">default</span>:()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å› ("voldemort", "Dark Arts")</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™æ®µä»£ç åšäº†ä¸€ä¸ªå¾ˆå±é™©çš„å‡è®¾ï¼šå°±æ˜¯å¦‚æœ <code>name</code> æ•°ç»„å…ƒç´ çš„ä¸ªæ•°ä¸æ˜¯ 2 ä¸ªçš„è¯ï¼Œé‚£ä¹ˆå®ƒ<strong>ä¸€å®š</strong>åŒ…å« 4 ä¸ªå…ƒç´ ã€‚å¦‚æœè¿™ç§å‡è®¾ä¸æˆç«‹ï¼Œæˆ‘ä»¬è·å¾—äº†åŒ…å« 0 ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œè¿™æ®µä»£ç å°±ä¼šå´©æºƒã€‚</p>
<p>é™¤äº†è¿™ä¸€ç‚¹ï¼Œæ¨¡å¼åŒ¹é…å‘ä½ å±•ç¤ºäº†å®ƒæ˜¯å¦‚ä½•åœ¨åªæœ‰ä¸€ä¸ª <code>case</code> çš„æƒ…å†µä¸‹å¸®åŠ©ä½ ç¼–å†™å¹²å‡€çš„ä»£ç å’Œç®€åŒ–å€¼çš„æå–çš„ã€‚</p>
<p>åŒæ ·æ¥çœ‹çœ‹æˆ‘ä»¬æ˜¯æ€ä¹ˆå†™ç´§è·Ÿåœ¨ <code>case</code> ä¹‹å <code>let</code> çš„ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸å¿…åœ¨æ¯ä¸€æ¬¡èµ‹å€¼çš„æ—¶å€™éƒ½é‡å¤å†™å®ƒã€‚</p>
<h1 id="æ¨¡å¼å’Œå…¶ä»–å…³é”®è¯">æ¨¡å¼å’Œå…¶ä»–å…³é”®è¯</h1><p>Swift çš„æ–‡æ¡£æŒ‡å‡ºä¸æ˜¯æ‰€æœ‰çš„æ¨¡å¼éƒ½å¯ä»¥åœ¨ <code>if</code>ã€<code>for</code> æˆ–è€… <code>guard</code> è¯­å¥ä¸­ä½¿ç”¨ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæ–‡æ¡£ä¼¼ä¹ä¸æ˜¯æœ€æ–°çš„ã€‚æ‰€æœ‰ 7 ç§æ¨¡å¼å¯¹è¿™ä¸‰ä¸ªå…³é”®è¯éƒ½æœ‰æ•ˆã€‚</p>
<p>æˆ‘ä¸ºé‚£äº›æ„Ÿå…´è¶£çš„äººç¼–äº†ä¸€ä¸ªä¾‹å­è¦ç‚¹ï¼Œä¸ºæ¯ä¸ªæ¨¡å¼å’Œæ¯ä¸ªå…³é”®è¯éƒ½å†™äº†ä¸€ä¸ªä¾‹å­ã€‚</p>
<p><a href="https://gist.github.com/terhechte/6eaeb90276bbfcd1ea41" target="_blank" rel="external">ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æ‰€æœ‰çš„æ ·ä¾‹æ¨¡å¼</a></p>
<p>æ¥çœ‹ä¸€ä¸ªå¯¹ä¸‰ä¸ªå…³é”®è¯ä½¿ç”¨ <strong>å€¼ç»‘å®š</strong>ã€<strong>å…ƒç»„</strong>å’Œ<strong>ç±»å‹è½¬æ¢</strong>æ¨¡å¼çš„ç®€çŸ­ä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ°å—ç¼–è¯‘ååªæ˜¯ä¸€ä¸ªå…³é”®è¯çš„é›†åˆã€‚å…¶æœ¬èº«æ²¡æœ‰ä»»ä½•æ„ä¹‰</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">valueTupleType</span><span class="params">(a: <span class="params">(Int, Any)</span></span></span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="comment">// guard case çš„ä¾‹å­</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">case</span> <span class="keyword">let</span> (x, <span class="number">_</span> <span class="keyword">as</span> <span class="type">String</span>) = a <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// for case çš„ä¾‹å­</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">let</span> (a, <span class="number">_</span> <span class="keyword">as</span> <span class="type">String</span>) <span class="keyword">in</span> [a] &#123;</span><br><span class="line">	<span class="built_in">print</span>(a)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if case çš„ä¾‹å­</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">case</span> <span class="keyword">let</span> (x, <span class="number">_</span> <span class="keyword">as</span> <span class="type">String</span>) = a &#123;</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">"if"</span>, x)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// switch case example</span></span><br><span class="line">    <span class="keyword">switch</span> a &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> (a, <span class="number">_</span> <span class="keyword">as</span> <span class="type">String</span>):</span><br><span class="line">	<span class="built_in">print</span>(a)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">default</span>: <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> u: <span class="type">Any</span> = <span class="string">"a"</span></span><br><span class="line"><span class="keyword">let</span> b: <span class="type">Any</span> = <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(valueTupleType((<span class="number">5</span>, u)))</span><br><span class="line"><span class="built_in">print</span>(valueTupleType((<span class="number">5</span>, b)))</span><br><span class="line"><span class="comment">// 5, 5, "if 5", 5, true, false</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥å¸¦ç€è¿™ä¸ªæƒ³æ³•è¯¦ç»†åœ°çœ‹ä¸€çœ‹æ¯ä¸€ä¸ªå…³é”®è¯ã€‚</p>
<h1 id="ä½¿ç”¨_for_case"><strong>ä½¿ç”¨</strong> for case</h1><p>åˆ°äº† Swift 2.0 åï¼Œæ¨¡å¼åŒ¹é…å˜å¾—æ›´åŠ é‡è¦ï¼Œå› ä¸ºå®ƒè¢«æ‰©å±•åˆ°ä¸ä»…å¯ä»¥æ”¯æŒ <code>switch</code> ï¼Œè¿˜å¯ä»¥æ”¯æŒå…¶ä»–çš„å…³é”®è¯ã€‚æ¯”å¦‚ï¼Œè®©æˆ‘ä»¬å†™ä¸€ä¸ªç®€å•çš„åªè¿”å›éç©ºå…ƒç´ çš„æ•°ç»„å‡½æ•°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">nonnil</span><span class="generics">&lt;T&gt;</span><span class="params">(array: [T?])</span></span> -&gt; [<span class="type">T</span>] &#123;</span><br><span class="line">   <span class="keyword">var</span> result: [<span class="type">T</span>] = []</span><br><span class="line">   <span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">let</span> x? <span class="keyword">in</span> array &#123;</span><br><span class="line">      result.append(x)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(nonnil([<span class="string">"a"</span>, <span class="literal">nil</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="literal">nil</span>]))</span><br></pre></td></tr></table></figure>
<p>å…³é”®è¯ <code>case</code> å¯ä»¥è¢« <code>for</code> å¾ªç¯ä½¿ç”¨ï¼Œå°±åƒ <code>switch</code> ä¸­çš„ <code>case</code> ä¸€æ ·ã€‚ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰è¯´çš„æ¸¸æˆä¹ˆï¼Ÿç»è¿‡ç¬¬ä¸€æ¬¡é‡æ„ä¹‹åï¼Œç°åœ¨æˆ‘ä»¬çš„å®ä½“ç³»ç»Ÿçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Entity</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">EntityType</span> </span>&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="type">Soldier</span></span><br><span class="line">	<span class="keyword">case</span> <span class="type">Player</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Entry</span>(type: <span class="type">EntityType</span>, x: <span class="type">Int</span>, y: <span class="type">Int</span>, hp: <span class="type">Int</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœŸæ£’ï¼è¿™å¯ä»¥è®©æˆ‘ä»¬ç”¨æ›´å°‘çš„ä»£ç ç»˜åˆ¶å‡ºæ‰€æœ‰çš„é¡¹ç›®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">let</span> <span class="type">Entity</span>.<span class="type">Entry</span>(t, x, y, <span class="number">_</span>) <span class="keyword">in</span> gameEntities()</span><br><span class="line"><span class="keyword">where</span> x &gt; <span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span> &#123;</span><br><span class="line">    drawEntity(t, x, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç”¨ä¸€è¡Œå°±è§£æå‡ºäº†æ‰€æœ‰å¿…éœ€çš„å±æ€§ï¼Œç„¶åç¡®ä¿æˆ‘ä»¬ä¸ä¼šåœ¨ 0 ä¸€ä¸‹çš„èŒƒå›´ç»˜åˆ¶ï¼Œæœ€åæˆ‘ä»¬è°ƒç”¨æ¸²æŸ“æ–¹æ³•ï¼ˆ<code>drawEntity</code>ï¼‰ã€‚</p>
<p>ä¸ºäº†çŸ¥é“é€‰æ‰‹æ˜¯å¦åœ¨æ¸¸æˆä¸­èƒœå‡ºï¼Œæˆ‘ä»¬æƒ³è¦çŸ¥é“æ˜¯å¦æœ‰è‡³å°‘ä¸€ä¸ªå£«å…µçš„è¡€é‡æ˜¯å¤§äº 0 çš„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">gameOver</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">case</span> <span class="type">Entity</span>.<span class="type">Entry</span>(.<span class="type">Soldier</span>, <span class="number">_</span>, <span class="number">_</span>, <span class="keyword">let</span> hp) <span class="keyword">in</span> gameEntities() </span><br><span class="line">    <span class="keyword">where</span> hp &gt; <span class="number">0</span> &#123;<span class="keyword">return</span> <span class="literal">false</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(gameOver())</span><br></pre></td></tr></table></figure>
<p>å¥½çš„æ˜¯ <code>Soldier</code> çš„åŒ¹é…æ˜¯ <code>for</code> æŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ„Ÿè§‰æœ‰ç‚¹åƒ <code>SQL</code> è€Œä¸æ˜¯å‘½ä»¤å¾ªç¯ç¼–ç¨‹ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿå¯ä»¥è®©ç¼–è¯‘å™¨æ›´æ¸…æ™°çš„çŸ¥é“æˆ‘ä»¬çš„æ„å›¾ï¼Œä»è€Œå°±æœ‰äº†æ‰“é€šè°ƒåº¦å¢å¼ºè¿™æ¡è·¯çš„å¯èƒ½æ€§ã€‚å¦å¤–ä¸€ä¸ªå¾ˆå¥½çš„ä½“éªŒå°±æ˜¯æˆ‘ä»¬ä¸éœ€è¦å®Œæˆçš„æ‹¼å†™å‡º <code>Entity.EntityType.Soldier</code>ã€‚å°±ç®—æˆ‘ä»¬åƒä¸Šé¢ä¸€æ ·åªå†™ <code>.Soldier</code>ï¼ŒSwift ä¹Ÿèƒ½æ˜ç™½æˆ‘ä»¬çš„æ„å›¾ã€‚</p>
<h1 id="ä½¿ç”¨_guard_case"><strong>ä½¿ç”¨</strong> guard case</h1><p>å¦å¤–ä¸€ä¸ªæ”¯æŒæ¨¡å¼åŒ¹é…çš„å…³é”®è¯å°±æ˜¯æ–°å¼•å…¥çš„ <code>guard</code> å…³é”®è¯ã€‚å®ƒå…è®¸ä½ åƒ <code>if let</code> ä¸€æ ·æŠŠ <code>optionals</code> ç»‘å®šåˆ°æœ¬åœ°èŒƒå›´ï¼Œè€Œä¸”ä¸éœ€è¦ä»»ä½•åµŒå¥—ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">example</span><span class="params">(a: String?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> a = a <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">&#125;</span><br><span class="line">example(<span class="string">"yes"</span>)</span><br></pre></td></tr></table></figure>
<p><code>guard let case</code> å…è®¸ä½ åšä¸€äº›ç±»ä¼¼æ¨¡å¼åŒ¹é…æ‰€ä»‹ç»çš„äº‹æƒ…ã€‚è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å£«å…µçš„ä¾‹å­ã€‚åœ¨ç©å®¶çš„è¡€é‡å˜æ»¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—éœ€è¦å¢åŠ çš„è¡€é‡ã€‚å£«å…µä¸èƒ½æ¶¨è¡€ï¼Œæ‰€ä»¥å¯¹äºå£«å…µå®ä½“è€Œè¨€ï¼Œæˆ‘ä»¬å§‹ç»ˆè¿”å› 0ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="type">MAX_HP</span> = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">healthHP</span><span class="params">(entity: Entity)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">case</span> <span class="keyword">let</span> <span class="type">Entity</span>.<span class="type">Entry</span>(.<span class="type">Player</span>, <span class="number">_</span>, <span class="number">_</span>, hp) = entity </span><br><span class="line">    <span class="keyword">where</span> hp &lt; <span class="type">MAX_HP</span> </span><br><span class="line">    <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="number">0</span> &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">MAX_HP</span> - hp</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Soldier"</span>, healthHP(<span class="type">Entity</span>.<span class="type">Entry</span>(type: .<span class="type">Soldier</span>, x: <span class="number">10</span>, y: <span class="number">10</span>, hp: <span class="number">79</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Player"</span>, healthHP(<span class="type">Entity</span>.<span class="type">Entry</span>(type: .<span class="type">Player</span>, x: <span class="number">10</span>, y: <span class="number">10</span>, hp: <span class="number">57</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º:</span></span><br><span class="line"><span class="string">"Soldier 0"</span></span><br><span class="line"><span class="string">"Player 43"</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯æŠŠæˆ‘ä»¬ç›®å‰è®¨è®ºçš„å„ç§æœºåˆ¶ç”¨åˆ°æè‡´çš„ä¸€ä¸ªä¾‹å­ã€‚</p>
<ul>
<li>å®ƒéå¸¸æ¸…æ™°ï¼Œæ²¡æœ‰ç‰µæ‰¯åˆ°ä»»ä½•åµŒå¥—</li>
<li>çŠ¶æ€çš„é€»è¾‘å’Œåˆå§‹åŒ–æ˜¯åœ¨ <code>func</code> ä¹‹å‰å¤„ç†çš„ï¼Œè¿™æ ·å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§</li>
<li>éå¸¸ç®€æ´</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ <code>switch</code> å’Œ <code>for</code> çš„å®Œç¾ç»“åˆï¼Œå¯ä»¥æŠŠå¤æ‚çš„é€»è¾‘ç»“æ„å°è£…æˆæ˜“è¯»çš„æ ¼å¼ã€‚å½“ç„¶ï¼Œå®ƒä¸ä¼šè®©é€»è¾‘å˜å¾—æ›´å®¹æ˜“ç†è§£ï¼Œä½†æ˜¯è‡³å°‘ä¼šä»¥æ›´æ¸…æ™°çš„æ–¹å¼å±•ç°ç»™ä½ ã€‚ç‰¹åˆ«æ˜¯ä½¿ç”¨ <code>enums</code> çš„æ—¶å€™ã€‚</p>
<h1 id="ä½¿ç”¨_if_case"><strong>ä½¿ç”¨</strong> if case</h1><p><code>if case</code> çš„ä½œç”¨å’Œ <code>guard case</code> ç›¸åã€‚å®ƒæ˜¯ä¸€ç§éå¸¸æ£’çš„åœ¨åˆ†æ”¯ä¸­æ‰“å¼€å’ŒåŒ¹é…æ•°æ®çš„æ–¹å¼ã€‚ç»“åˆä¹‹å‰ <code>guard</code> çš„ä¾‹å­ã€‚å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª <code>move</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å…è®¸æˆ‘ä»¬è¡¨ç¤ºä¸€ä¸ªå®ä½“åœ¨æœä¸€ä¸ªæ–¹å‘ç§»åŠ¨ã€‚å› ä¸ºæˆ‘ä»¬çš„å®ä½“æ˜¯ <code>enums</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿”å›ä¸€ä¸ªæ›´æ–°è¿‡çš„å®ä½“ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">move</span><span class="params">(entity: Entity, xd: Int, yd: Int)</span></span> -&gt; <span class="type">Entity</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">case</span> <span class="type">Entity</span>.<span class="type">Entry</span>(<span class="keyword">let</span> t, <span class="keyword">let</span> x, <span class="keyword">let</span> y, <span class="keyword">let</span> hp) = entity</span><br><span class="line">	<span class="keyword">where</span> (x + xd) &lt; <span class="number">1000</span> &amp;&amp;</span><br><span class="line">	    (y + yd) &lt; <span class="number">1000</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="type">Entity</span>.<span class="type">Entry</span>(type: t, x: (x + xd), y: (y + yd), hp: hp)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> entity</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(move(<span class="type">Entity</span>.<span class="type">Entry</span>(type: .<span class="type">Soldier</span>, x: <span class="number">10</span>, y: <span class="number">10</span>, hp: <span class="number">79</span>), xd: <span class="number">30</span>, yd: <span class="number">500</span>))</span><br><span class="line"><span class="comment">// è¾“å‡º: Entry(main.Entity.EntityType.Soldier, 40, 510, 79)</span></span><br></pre></td></tr></table></figure>
<h1 id="é™åˆ¶">é™åˆ¶</h1><p>ä¸€äº›é™åˆ¶å·²ç»åœ¨æ–‡ç« ä¸­è¯´è¿‡ï¼Œæ¯”å¦‚æœ‰å…³ <code>Expression Patterns</code> çš„é—®é¢˜ï¼Œçœ‹èµ·æ¥å®ƒä¼¼ä¹ä¸èƒ½åŒ¹é… <code>tuples</code> ï¼ˆé‚£æ ·çš„è¯å°±çœŸçš„å¾ˆæ–¹ä¾¿äº†ï¼‰ã€‚åœ¨ Scala å’Œ Clojure ä¸­ï¼Œæ¨¡å¼åŒ¹é…åœ¨é›†åˆä¸ŠåŒæ ·å¯ç”¨ï¼Œæ‰€ä»¥ä½ å¯ä»¥åŒ¹é…å®ƒçš„å¤´éƒ¨ã€å°¾éƒ¨å’Œéƒ¨åˆ†ç­‰ã€‚<a href="#4">4</a>ã€‚è¿™åœ¨ Swift ä¸­æ˜¯ä¸æ”¯æŒçš„ï¼ˆ<a href="http://austinzheng.com/2014/12/17/custom-pattern-matching/" target="_blank" rel="external">å°½ç®¡ Austin Zheng åœ¨æˆ‘ä¹‹å‰é“¾æ¥çš„åšå®¢é‡Œå·®ä¸å¤šå®ç°äº†è¿™ä¸€ç‚¹</a>ï¼‰</p>
<p>å¦å¤–ä¸€ç§ä¸å¯ç”¨çš„çš„æƒ…å†µæ˜¯ï¼ˆè¿™ä¸€ç‚¹ Scala åŒæ ·åšå¾—å¾ˆå¥½ï¼‰å¯¹ç±»æˆ–è€…ç»“æ„ä½“è¿›è¡Œè§£æ„ã€‚Swift å…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª <code>unapply</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åšçš„äº‹æƒ…å¤§ä½“å’Œ <code>init</code> ç›¸åã€‚å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œç„¶åå°±å¯ä»¥è®©ç±»å‹æ£€æŸ¥å™¨å¯¹ç±»è¿›è¡ŒåŒ¹é…ã€‚è€Œåœ¨ Swift ä¸­ï¼Œå®ƒçœ‹èµ·æ¥å°±åƒä¸‹é¢ä¸€æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Imaginary</span> </span>&#123;</span><br><span class="line">   <span class="keyword">let</span> x: <span class="type">Int</span></span><br><span class="line">   <span class="keyword">let</span> y: <span class="type">Int</span></span><br><span class="line">   <span class="func"><span class="keyword">func</span> <span class="title">unapply</span><span class="params">()</span></span> -&gt; (<span class="type">Int</span>, <span class="type">Int</span>) &#123;</span><br><span class="line">     <span class="comment">// å®ç°è¿™ä¸ªæ–¹æ³•ä¹‹åï¼Œç†è®ºä¸Šæ¥è¯´å®ç°äº†è§£æ„å˜é‡æ‰€éœ€çš„æ‰€æœ‰ç»†èŠ‚</span></span><br><span class="line">     <span class="keyword">return</span> (<span class="keyword">self</span>.x, <span class="keyword">self</span>.y)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç„¶åè¿™ä¸ªå°±ä¼šè‡ªåŠ¨ unapply ç„¶åå†è¿›è¡ŒåŒ¹é…</span></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">case</span> <span class="keyword">let</span> <span class="type">Imaginary</span>(x, y) = anImaginaryObject <span class="keyword">else</span> &#123; <span class="keyword">break</span> &#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ›´æ–°">æ›´æ–°</h1><p><strong>08/21/2015</strong> ç»“åˆ <a href="https://www.reddit.com/r/swift/comments/3hq6id/match_me_if_you_can_swift_pattern_matching_in/" target="_blank" rel="external">Reddit ä¸Š foBrowsing çš„æœ‰ç”¨åé¦ˆ</a></p>
<ul>
<li>å¢åŠ  <code>guard case let</code></li>
<li>å¢åŠ ç®€åŒ–ç‰ˆçš„ let è¯­æ³•ï¼ˆå¦‚ï¼š<code>let (x, y)</code> æ›¿ä»£ <code>(let x, let y)</code>ï¼‰</li>
</ul>
<p><strong>08/22/2015</strong> <a href="https://www.reddit.com/r/swift/comments/3hq6id/match_me_if_you_can_swift_pattern_matching_in/" target="_blank" rel="external">ä¼¼ä¹æœ‰ä¸€äº›ä¸œè¥¿æˆ‘æ²¡æµ‹è¯•å¥½</a>ã€‚æˆ‘åˆ—ä¸¾çš„ä¸€äº›é™åˆ¶å®é™…ä¸Šæ˜¯å¯ç”¨çš„ï¼Œå¦å¤–ä¸€ä¸ª Reddit ä¸Šçš„è¯„è®ºè€…ï¼ˆlatrodectusï¼‰æå‡ºäº†ä¸€äº›éå¸¸æœ‰ç”¨çš„æŒ‡æ­£ã€‚</p>
<ul>
<li>å°†ä¹‹å‰çš„ä¿®æ­£ä¸ºï¼šæ‰€æœ‰çš„æ¨¡å¼å¯¹ä¸‰ä¸ªå…³é”®è¯éƒ½é€‚ç”¨ï¼Œç„¶åå¢åŠ äº†ä¸€äº›è¦ç‚¹æ¡ˆä¾‹</li>
<li>å…³äºåè®®å’Œè¡¨è¾¾å¼æ¨¡å¼æ— æ•ˆè¿™ä¸ªé™åˆ¶ï¼Œå…¶å®æ²¡æœ‰çš„</li>
<li>å¢åŠ  â€œæ¨¡å¼å¯ç”¨æ€§â€œç« èŠ‚</li>
</ul>
<p><strong>08/24/2015</strong> </p>
<ul>
<li>å¢åŠ  <code>if case</code> æ ·ä¾‹ï¼Œé‡å‘½åäº†ä¸€äº›ç« èŠ‚ã€‚</li>
<li>ä¿®å¤äº†ä¸€äº›æ–‡æœ¬æ‹¼å†™é”™è¯¯ã€‚å°¤å…¶æˆ‘ä¸å°å¿ƒå†™é“ï¼š<code>_</code> ä¸èƒ½åŒ¹é… <code>nil</code>ã€‚é‚£å½“ç„¶æ˜¯ä¸å¯¹çš„ï¼Œ<code>_</code> å¯ä»¥åŒ¹é…æ‰€æœ‰çš„ä¸œè¥¿ã€‚ï¼ˆæ„Ÿè°¢ <a href="https://github.com/obecker" target="_blank" rel="external">obecker</a>ï¼‰</li>
</ul>
<p><strong>09/18/2015</strong></p>
<ul>
<li>æ·»åŠ äº†æ—¥è¯­ç¿»è¯‘çš„é“¾æ¥</li>
</ul>
<hr>
<p><a name="1">1.å¯ä»¥æŠŠå®ƒå½“åš <code>shell</code> é‡Œé¢çš„ <code>*</code> é€šé…ç¬¦</a></p>
<p><a name="2">2.æˆ‘ä¸æ¸…æ¥šç¼–è¯‘å™¨æ˜¯å¦åœ¨å¯¹è¿™ç‚¹è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½†ç†è®ºä¸Šæ¥è¯´ï¼Œå®ƒåº”è¯¥èƒ½è®¡ç®—å‡ºæ‰€éœ€æ•°æ®çš„æ­£ç¡®ä½ç½®ï¼Œç„¶åå¿½ç•¥ <code>enum</code> çš„å…¶ä»–æƒ…å†µå¹¶å†…è”è¿™ä¸ªåœ°å€</a></p>
<p><a name="3">3.å½“ç„¶ï¼Œä¸æ˜¯ Haskellå®ç°çš„å¯¹æ‰‹ï¼š<br>fib 0 = 0<br>fib 1 = 1<br>fib n = fib (n-1) + fib (n-2)<br></a></p>
<p><a name="4">4.æ¯”å¦‚ï¼šswitch [1, 2, 4, 3] {<br>case [<em>, 2, </em>, 3]:<br>}</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šBenedikt Terhechteï¼Œ<a href="http://appventure.me/2015/08/20/swift-pattern-matching-in-detail/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-08-20<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/mmoaay">mmoaay</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨ä¼—å¤š Swift æä¾›ç»™ Objective-C ç¨‹åºå‘˜ä½¿ç”¨çš„æ–°ç‰¹æ€§ä¸­ï¼Œæœ‰ä¸ªç‰¹æ€§æŠŠè‡ªå·±ä¼ªè£…æˆä¸€ä¸ªæ— èŠçš„è€å¤´ï¼Œä½†æ˜¯å´åœ¨å¦‚ä½•ä¼˜é›…çš„è§£å†³â€œé­å°¸é‡‘å­—å¡”â€œçš„é—®é¢˜ä¸Šæœ‰ç€å·¨å¤§çš„æ½œåŠ›ã€‚å¾ˆæ˜¾ç„¶æˆ‘æ‰€è¯´çš„è¿™ä¸ªç‰¹æ€§å°±æ˜¯ <code>switch</code> è¯­å¥ï¼Œ å¯¹äºå¾ˆå¤š Objective-C ç¨‹åºå‘˜æ¥è¯´ï¼Œé™¤äº†ç”¨åœ¨ <a href="http://en.wikipedia.org/wiki/Duff%27s_device">Duffâ€™s Device</a> ä¸Šæ¯”è¾ƒæœ‰è¶£ä¹‹å¤–ï¼Œ<code>switch</code> è¯­å¥éå¸¸ç¬¨æ‹™ï¼Œä¸å¤šä¸ª <code>if</code> è¯­å¥ç›¸æ¯”ï¼Œå®ƒå‡ ä¹æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ã€‚</p>]]>
    
    </summary>
    
      <category term="APPVENTURE" scheme="http://swiftggteam.github.io/tags/APPVENTURE/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Swift ä¸­çš„èŒƒå›´å’ŒåŒºé—´]]></title>
    <link href="http://swiftggteam.github.io/2015/10/26/swift-ranges-and-intervals/"/>
    <id>http://swiftggteam.github.io/2015/10/26/swift-ranges-and-intervals/</id>
    <published>2015-10-26T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="http://oleb.net/blog/2015/09/swift-ranges-and-intervals/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-24<br>è¯‘è€…ï¼š<a href="http://www.dianqk.org/" target="_blank" rel="external">é›é’K</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="external">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>æœ¬ç³»åˆ—å…¶å®ƒæ–‡ç« ï¼š</p>
<p>(1)<a href="http://oleb.net/blog/2015/09/swift-pattern-matching/" target="_blank" rel="external">è‡ªå®šä¹‰æ¨¡å¼åŒ¹é…</a></p>
<p>(2)èŒƒå›´å’ŒåŒºé—´(å³æœ¬ç¯‡)</p>
<p>(3)<a href="http://oleb.net/blog/2015/09/more-pattern-matching-examples/" target="_blank" rel="external">æ›´å¤šæœ‰å…³æ¨¡å¼åŒ¹é…çš„ä¾‹å­</a></p>
<blockquote>
<p>ä¸‹è½½æœ¬ç¯‡æ–‡ç« æ‰€éœ€è¦çš„ <a href="http://oleb.net/media/swift-ranges-and-intervals.playground.zip" target="_blank" rel="external">playground</a> ï¼ˆXcode7 è¿è¡Œç¯å¢ƒï¼‰</p>
</blockquote>
<a id="more"></a>
<p>åœ¨å‰ä¸€ç¯‡<a href="http://oleb.net/blog/2015/09/swift-pattern-matching/" target="_blank" rel="external">æœ‰å…³æ¨¡å¼åŒ¹é…</a>çš„æ–‡ç« ä¸­ï¼Œæˆ‘æåŠæ ‡å‡†åº“ä¸­å·²ç»é’ˆå¯¹<strong>èŒƒå›´å’ŒåŒºé—´</strong>ä½¿ç”¨<code>~=</code>æ¨¡å¼åŒ¹é…æ“ä½œç¬¦è¿›è¡Œäº†é‡è½½ã€‚</p>
<p>è¿™ä¸¤ä¸ªæ•°æ®ç±»å‹æ˜¯ç›¸å…³çš„ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›é‡è¦çš„åŒºåˆ«ã€‚å¯¹äºå¦‚ä½•åœ¨<code>switch</code>ä¸­è¿›è¡Œä¸ç­‰å¼æ¡ä»¶åŒ¹é…çš„é—®é¢˜ï¼Œå®ƒä»¬ä¸å¤±ä¸ºä¸€ä¸ªå¯é€‰çš„è§£å†³æ–¹æ¡ˆï¼Œæœ¬æ–‡å°†å¯¹å®ƒä»¬è¿›è¡Œæ·±å…¥è®¨è®ºã€‚</p>
<h2 id="Ranges">Ranges</h2><p>èŒƒå›´æ˜¯ç”¨<a href="http://swiftdoc.org/swift-2/type/Range/" target="_blank" rel="external">Range</a>ç±»å‹è¡¨è¾¾çš„ã€‚ä¸€ä¸ªèŒƒå›´å°±æ˜¯ä¸€ä¸ª<em>ç´¢å¼•</em>é›†åˆã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šä¸€ä¸ªèŒƒå›´å°±æ˜¯ä¸€ä¸ªç´¢å¼•é›†åˆã€‚</p>
</blockquote>
<p><em>Range</em>åœ¨æ ‡å‡†åº“ä¸­è¢«é¢‘ç¹ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯å¤„åœ¨é›†åˆçš„ä¸Šä¸‹æ–‡å½“ä¸­æ—¶ã€‚å½“æˆ‘ä»¬æŸ¥çœ‹<code>Range</code>å®šä¹‰æ—¶ï¼ŒèŒƒå›´å’Œé›†åˆä¹‹é—´çš„ç´§å¯†å…³ç³»ä¸€ç›®äº†ç„¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Range</span>&lt;<span class="title">Element</span> : <span class="title">ForwardIndexType</span>&gt; : <span class="title">CollectionType</span>, <span class="title">Indexable</span>, ... </span>&#123; </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸€ä¸ªèŒƒå›´ä¸­çš„å…ƒç´ å¿…éœ€éµå®ˆ<code>ForwardIndexType</code>åè®®ï¼ŒåŒæ—¶<code>CollecitonType</code>åè®®ä¸­çš„å¤§é‡åŠŸèƒ½ä¹Ÿæ˜¯åŸºäºå®ƒå®ç°çš„ã€‚æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ç”¨æ¥è¡¨ç¤ºé›†åˆç´¢å¼•çš„èŒƒå›´ï¼Œå¯¹äºè·å–ä¸€ä¸ªé›†åˆçš„å­é›†æ˜¯ç›¸å½“æœ‰æ„ä¹‰çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨èŒƒå›´è·å–ä¸€ä¸ªæ•°ç»„çš„éƒ¨åˆ†:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="comment">// 1..&lt;5 ç­‰ä»·äº Range(start: 1, end: 5)</span></span><br><span class="line">numbers[<span class="number">1</span>..&lt;<span class="number">5</span>] <span class="comment">// [2,3,4,5]</span></span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚ç±»å‹å®šä¹‰ä¸­æ‰€çœ‹åˆ°çš„ï¼Œ<em>Range</em>è‡ªèº«éµå¾ª<code>CollectionType</code>åè®®ï¼Œæ‰€ä»¥å‡ ä¹æ‰€æœ‰æ•°ç»„å¯ä»¥åšçš„äº‹æƒ…ï¼ŒèŒƒå›´ä¹Ÿèƒ½å¤Ÿé€‚ç”¨ã€‚æ¯”å¦‚ç”¨<code>for</code>å¾ªç¯éå†å…ƒç´ ï¼Œæˆ–è€…ä½¿ç”¨<code>contains(_:)</code>æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦åœ¨è¿™ä¸ªèŒƒå›´å†…ã€‚</p>
<p>è™½ç„¶èŒƒå›´ä¸»è¦é€‚ç”¨äºä¸å…¶ä»–é›†åˆé…åˆä½¿ç”¨ï¼Œä½†è°ä¹Ÿæ— æ³•é˜»æ­¢ä½ åˆ›å»ºä¸€ä¸ªç”¨äºè¡¨ç¤ºæ•°å­—åŒºé—´çš„<code>Range&lt;Int&gt;</code>ã€‚æ¯•ç«Ÿ<a href="http://swiftdoc.org/swift-2/type/Int/" target="_blank" rel="external">Int</a>å·²ç»å®ç°äº†<code>ForwardIndexType</code>åè®®ã€‚ç°åœ¨å›åˆ°æˆ‘ä»¬çš„æ¨¡å¼åŒ¹é…é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªèŒƒå›´<code>(Int.min..&lt;0).contains(x)</code>è¡¨ç¤º x &lt; 0 çš„æƒ…å†µï¼Œè¿™æ˜¯å®Œå…¨ç­‰ä»·çš„ï¼Œä¸è¿‡æ‰§è¡Œé€Ÿåº¦å·¨æ…¢ã€‚æ¯•ç«Ÿé»˜è®¤éœ€è¦éå†æ•´ä¸ªé›†åˆï¼Œæœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ï¼Œå°†æ‰§è¡Œ<a href="https://en.wikipedia.org/wiki/9223372036854775807" target="_blank" rel="external">9,223,372,036,854,775,808æ¬¡</a>ï¼Œè¿™ç›¸å½“è€—è´¹èµ„æºã€‚æˆ‘ä»¬å¯ä»¥ä¸º<code>Comparable</code>ï¼ˆæ¯”å¦‚<code>Int</code>ï¼‰ç±»å‹çš„ç´¢å¼•æä¾›ä¸€ä¸ªæ›´å¥½å®ç°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Range</span> <span class="title">where</span> <span class="title">Element</span> : <span class="title">Comparable</span> </span>&#123;</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">contains</span><span class="params">(element: Element)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> element &gt;= startIndex &amp;&amp; element &lt; endIndex</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span>).<span class="built_in">contains</span>(-<span class="number">1</span>) <span class="comment">// true</span></span><br><span class="line">(<span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span>).<span class="built_in">contains</span>(<span class="number">0</span>) <span class="comment">// false</span></span><br><span class="line">(<span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span>).<span class="built_in">contains</span>(<span class="number">1</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç»ƒä¹ ï¼Œä¸è¿‡åœ¨æˆ‘ä»¬æ¡ˆä¾‹ä¸­å¯æœ‰å¯æ— ï¼Œå› ä¸º<code>~=</code>æ“ä½œç¬¦ä¸º<code>Range</code>å®ç°çš„åŒ¹é…è¶³å¤Ÿé«˜æ•ˆï¼ˆå°±åƒæˆ‘ä»¬çš„<code>contains(_:)</code>ï¼Œ<code>Comparable</code>åªæ˜¯åœ¨ç´¢å¼•ä¸­å·¥ä½œï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·çš„åšï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span> ~= -<span class="number">1</span> <span class="comment">// true</span></span><br><span class="line"><span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span> ~= <span class="number">0</span> <span class="comment">// false</span></span><br><span class="line"><span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span> ~= <span class="number">1</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª<code>switch</code>è¯­å¥ï¼Œä½¿ç”¨èŒƒå›´æŸ¥è¯¢åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦å¤§äºï¼Œå°äºè¿˜æ˜¯ç­‰äº 0ï¼Œå¯¹å—ï¼Ÿä¸å¹¸åœ°æ˜¯ï¼Œè¿™å¹¶ä¸é€‚ç”¨ã€‚è¿™æ®µä»£ç ä¼šå´©æºƒï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">10</span></span><br><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>...<span class="type">Int</span>.<span class="built_in">max</span>: <span class="comment">// EXC_BAD_INSTRUCTION</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"Should be unreachable"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¼šåœ¨<code>case 1...Int.max</code>è¿™ä¸€è¡Œä¸­å¾—åˆ°ä¸€ä¸ª<code>EXC_BAD_INSTRUCTION</code> é”™è¯¯ä¿¡æ¯è¡¨æ˜â€œfatal error: Range end index has no valid successorâ€ã€‚å¯¼è‡´é”™è¯¯çš„åŸå› åœ¨äº:<code>range</code>ä¸­çš„<code>endIndex</code>æ€»æ˜¯æŒ‡å‘èŒƒå›´ä¸­æœ€åä¸€ä¸ªå…ƒç´ çš„åé¢ã€‚è¿™å¯¹äºåŠå¼€åŒºé—´ï¼ˆç”¨ ..&lt; æ“ä½œç¬¦åˆ›å»ºï¼‰å’Œé—­åˆåŒºé—´ï¼ˆç”¨ â€¦ æ“ä½œç¬¦åˆ›å»ºï¼‰éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºäºŒè€…çš„å†…éƒ¨å®ç°æ˜¯ä¸€æ ·çš„ï¼Œ<code>a...b</code>äº‹å®ä¸Šå°±æ˜¯<code>a..&lt;b.successor()</code>ã€‚ </p>
<blockquote>
<p>æ³¨æ„ï¼šä¸€ä¸ª<code>Range&lt;Int&gt;</code>æ°¸è¿œéƒ½ä¸èƒ½æœ‰<code>Int.max</code></p>
</blockquote>
<p>è¿™æ„å‘³ç€<code>Int.max</code>æ°¸è¿œéƒ½ä¸ä¼šæˆä¸ºä¸€ä¸ª<code>Range&lt;Int&gt;</code>çš„æˆå‘˜ï¼Œè¿™åŒæ ·é€‚ç”¨äºå…¶ä»–æœ‰æœ€å¤§å€¼çš„ç±»å‹ã€‚è¿™ä¸ªé™åˆ¶ä½¿èŒƒå›´ä¸èƒ½æ»¡è¶³æˆ‘ä»¬æ‰€è¦çš„éœ€æ±‚ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹åŒºé—´èƒ½ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚</p>
<h2 id="åŒºé—´">åŒºé—´</h2><p>èŒƒå›´å’ŒåŒºé—´æ˜¯åŸºæœ¬ç›¸åŒçš„æ¦‚å¿µæ„å»ºçš„ï¼ˆä¸€ä¸ªè¿ç»­å…ƒç´ çš„ç³»åˆ—ï¼Œæœ‰å¼€å§‹æœ‰ç»“å°¾ï¼‰ï¼Œä½†ä½¿ç”¨äº†ä¸åŒçš„æ–¹æ³•ã€‚èŒƒå›´åŸºäºç´¢å¼•ï¼Œå› æ­¤å¯ä»¥æ˜¯ä¸ªé›†åˆï¼Œä»–ä»¬çš„å¤§å¤šæ•°åŠŸèƒ½éƒ½æ˜¯åŸºæœ¬è¿™ä¸ªç‰¹æ€§çš„ã€‚åŒºé—´<em>ä¸æ˜¯</em>é›†åˆï¼Œä»–ä»¬çš„å®ç°æ˜¯ä¾èµ–<code>Comparable</code>åè®®çš„ã€‚æˆ‘ä»¬åªå¯ä»¥ä¸ºæœä»<code>Comparable</code>åè®®çš„ç±»å‹åˆ›å»ºåŒºé—´ç±»å‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">IntervalType</span> </span>&#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Bound</span> : <span class="type">Comparable</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰åˆ«äºèŒƒå›´çš„å®šä¹‰ï¼ŒåŒºé—´ä½¿ç”¨<code>IntervalType</code>åè®®å‘ˆç°ï¼Œè¿™ä¸ªåè®®æœ‰ä¸¤ä¸ªå…·ä½“çš„å®ç°ï¼Œ<code>HalfOpenInterval</code>å’Œ<code>ClosedInterval</code>ã€‚ä¸¤ä¸ªèŒƒå›´æ“ä½œç¬¦ä¹Ÿä¸ºåŒºé—´æä¾›äº†é‡è½½ï¼š..&lt; åˆ›å»ºä¸€ä¸ª<code>HalfOpenInterval</code>å’Œ â€¦ åˆ›å»ºä¸€ä¸ª<code>ClosedInterval</code>ã€‚ç”±äºé»˜è®¤æ˜¯é‡è½½äº†<code>Range</code>ï¼Œæ‰€ä»¥ä½ å¿…é¡»æ˜ç¡®å˜é‡ä¸ºåŒºé—´ç±»å‹(IntervalType)ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> int1: <span class="type">HalfOpenInterval</span> = <span class="number">1</span>..&lt;<span class="number">5</span></span><br><span class="line">int1.<span class="built_in">contains</span>(<span class="number">5</span>) <span class="comment">// false</span></span><br><span class="line"><span class="keyword">let</span> int2: <span class="type">ClosedInterval</span> = <span class="number">1</span>...<span class="number">5</span></span><br><span class="line">int2.<span class="built_in">contains</span>(<span class="number">5</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ä»¶äº‹æƒ…å°±æ˜¯è®°å¾—<code>ClosedInterval</code>ä¸å¯ä»¥ä¸ºç©ºï¼Œxâ€¦x æ€»æ˜¯ä¼šåŒ…å« xï¼Œè€Œ xâ€¦(x-1) ä¼šé€ æˆè¿è¡Œæ—¶é”™è¯¯ã€‚</p>
<p>ç„¶è€Œé—­åˆåŒºé—´å¯ä»¥åŒ…å«ä¸€ä¸ªç±»å‹çš„æœ€å¤§å€¼ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ç°åœ¨å¯ä»¥å†™æˆ‘ä»¬çš„<code>switch</code>è¯­å¥äº†ã€‚é‡å¤ä¸€éï¼Œä¸€å®šè¦æ˜ç¡®ç±»å‹ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨æˆ‘ä»¬æƒ³è¦çš„æ˜¯åŒºé—´è€Œä¸æ˜¯èŒƒå›´ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">10</span></span><br><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>...<span class="type">Int</span>.<span class="built_in">max</span> <span class="keyword">as</span> <span class="type">ClosedInterval</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="type">Int</span>.<span class="built_in">min</span>..&lt;<span class="number">0</span> <span class="keyword">as</span> <span class="type">HalfOpenInterval</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"Should be unreachable"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ºå¼€åŒºé—´å®šåˆ¶æ“ä½œç¬¦">ä¸ºå¼€åŒºé—´å®šåˆ¶æ“ä½œç¬¦</h2><p>éå¸¸å¥½ï¼Œä½†æˆ‘æƒ³æ‘†è„±<code>Int.min</code>å’Œ<code>Int.max</code>ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå¼€åŒºé—´å’Œé—­åŒºé—´è‡ªå®šä¹‰å‰ç¼€æ“ä½œç¬¦å’Œåç¼€æ“ä½œç¬¦ï¼Œç”¨äºè¡¨ç¤ºæ‰€æœ‰å°äºä¸€ä¸ªä¸Šè¾¹ç•Œçš„å€¼ï¼Œæˆ–è€…å¤§äºä¸€ä¸ªä¸‹è¾¹ç•Œçš„å€¼ã€‚è¿™æ ·ä¸ä»…åœ¨è¯­æ³•ä¸Šè¦æ›´å‹å–„ï¼›ç†æƒ³æƒ…å†µä¸‹ï¼Œè¿™äº›æ“ä½œç¬¦ä¸ä»…é€‚ç”¨äº <code>Int</code> ç±»å‹ï¼Œä¹Ÿå¯ä»¥é€‚åˆäºå…¶å®ƒæ‹¥æœ‰æœ€å°å’Œæœ€å¤§å€¼çš„ç±»å‹ã€‚å®ç°çœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>...: <span class="comment">// an interval from 1 to Int.max (inclusive)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> ..&lt;<span class="number">0</span>: <span class="comment">// an interval from Int.min to 0 (exclusive)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦ä¸º <code>..&lt;</code> å’Œ <code>...</code> åˆ†åˆ«å®šä¹‰å‰ç¼€å’Œåç¼€çš„å®ç°æ–¹å¼ ã€‚ä¸‹é¢è¿™æ®µä»£ç åŸºæœ¬æ˜¯åŸºäº <a href="http://natecook.com/" target="_blank" rel="external">Nate Cook</a> å†™çš„ <a href="https://gist.github.com/natecook1000/3b15b8bd974c8c08b3df" target="_blank" rel="external">gistç‰‡æ®µ</a> ï¼Œä»–å·²ç»åœ¨ 2014 å¹´ 11 æœˆä½¿ç”¨èŒƒå›´å’ŒåŒºé—´æ··åˆå®ç°äº†å®ƒã€‚æˆ‘æŠŠä½¿ç”¨åŒºé—´çš„éƒ¨åˆ†æ”¾åœ¨è¿™é‡Œã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å¿…é¡»å£°æ˜éœ€è¦è§£é‡Šçš„æ“ä½œç¬¦ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">prefix</span> <span class="keyword">operator</span> ..&lt; &#123; &#125;</span><br><span class="line"><span class="keyword">prefix</span> <span class="keyword">operator</span> ... &#123; &#125;</span><br><span class="line"><span class="keyword">postfix</span> <span class="keyword">operator</span> ..&lt; &#123; &#125;</span><br><span class="line"><span class="keyword">postfix</span> <span class="keyword">operator</span> ... &#123; &#125;</span><br></pre></td></tr></table></figure>
<p>ç´§æ¥ç€ä¸º<code>Int</code>å®ç°ç¬¬ä¸€ä¸ªè¿ç®—ç¬¦çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Forms a half-open interval from `Int.min` to `upperBound`</span></span><br><span class="line"><span class="keyword">prefix</span> <span class="func"><span class="keyword">func</span> ..<span class="generics">&lt; (upperBound: Int) -&gt;</span> <span class="title">HalfOpenInterval</span><span class="generics">&lt;Int&gt;</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Int</span>.<span class="built_in">min</span>..&lt;upperBound</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥ï¼Œä½†æˆ‘ä»¬åº”è¯¥è®©å®ƒæ›´é€šç”¨ã€‚åŒºé—´è¦æ±‚å®ƒçš„åº•å±‚ç±»å‹éƒ½éµå¾ª<code>Comparable</code>åè®®ï¼Œæ‰€ä»¥ä½¿ç”¨ç›¸åŒçš„æ¡ä»¶çº¦æŸæ˜¯ä¸€ä¸ªå¾ˆè‡ªç„¶çš„é€‰æ‹©ã€‚ä½†åœ¨è¿™é‡Œæˆ‘ä»¬ä¼šç¢°åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦çŸ¥é“ T ç±»å‹çš„æœ€å°å€¼æ¥åˆ›å»ºåŒºé—´ï¼Œä½†è¿™å¹¶æ²¡æœ‰ä¸€ä¸ªé€šç”¨çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">prefix</span> <span class="func"><span class="keyword">func</span> ..<span class="generics">&lt; &lt;T : Comparable&gt;</span><span class="params">(upperBound: T)</span></span> -&gt; <span class="type">HalfOpenInterval</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">T</span>.<span class="built_in">min</span>..&lt;upperBound <span class="comment">// error: type 'T' has no member 'min'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”šè‡³æ˜¯åœ¨æ ‡å‡†åº“ä¸­çš„å…¶ä»–åè®®éƒ½æ²¡æœ‰ä¸ºæ•°å­—ï¼ˆå°±æ¯”å¦‚<code>IntegerType</code>ï¼‰æä¾›è¿™äº›â€“å®šä¹‰åœ¨æ•°å­—ç±»å‹ä¸­çš„<code>min</code>å’Œ<code>max</code>å±æ€§ã€‚</p>
<p>Nate æƒ³å‡ºäº†ä¸€ä¸ªå¾ˆé…·çš„è§£å†³æ–¹æ¡ˆï¼šå®šä¹‰ä¸€ä¸ª<code>MinMaxType</code>çš„è‡ªå®šä¹‰åè®®ï¼Œè¿™ä¸ªåè®®å®šä¹‰äº† <code>min</code> å’Œ <code>max</code> ä¸¤ä¸ªå±æ€§ã€‚å› ä¸ºæ‰€æœ‰æ•´æ•°ç±»å‹éƒ½æœ‰è¿™ä¸¤ä¸ªå±æ€§ï¼Œè®©ä»–ä»¬éµå®ˆæ–°çš„åè®®å°±ä¸ç”¨é¢å¤–å†™ä»£ç äº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Conforming types provide static `max` and `min` constants.</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">MinMaxType</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> <span class="built_in">min</span>: <span class="type">Self</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> <span class="built_in">max</span>: <span class="type">Self</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Extend relevant types</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int8</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int16</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int32</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int64</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UInt</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UInt8</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UInt16</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UInt32</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UInt64</span> : <span class="title">MinMaxType</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå€¼å¾—ç‰¢è®°çš„æŠ€å·§ã€‚ä»»ä½•æ—¶å€™ï¼Œå½“ä½ æœ‰å‡ ä¸ªä¸ç›¸å…³çš„ç±»å‹ï¼Œä½†å®ƒä»¬å…·æœ‰ç›¸åŒç±»å‹çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•ã€å±æ€§ï¼Œä½ éƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„åè®®ç»™ä»–ä»¬æä¾›ä¸€ä¸ªé€šç”¨æ¥å£ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šä»»ä½•æ—¶å€™ï¼Œå½“ä½ æœ‰å‡ ä¸ªä¸ç›¸å…³çš„ç±»å‹ï¼Œä½†å®ƒä»¬å…·æœ‰ç›¸åŒç±»å‹çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•ã€å±æ€§ï¼Œä½ éƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„åè®®ç»™ä»–ä»¬æä¾›ä¸€ä¸ªé€šç”¨æ¥å£ã€‚</p>
</blockquote>
<p>å‘Šè¯‰æˆ‘ä»¬çš„é€šç”¨ç±»å‹ T éµå®ˆ<code>MinMaxType</code>åè®®ä»¥ä½¿è¿™ä¸ªå®ç°å¯ä»¥æ­£å¸¸è¿è¡Œï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Forms a half-open interval from `T.min` to `upperBound`</span></span><br><span class="line"><span class="keyword">prefix</span> <span class="func"><span class="keyword">func</span> ..<span class="generics">&lt; &lt;T : Comparable where T : MinMaxType&gt;</span></span><br><span class="line">    <span class="params">(upperBound: T)</span></span> -&gt; <span class="type">HalfOpenInterval</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">T</span>.<span class="built_in">min</span>..&lt;upperBound</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯å…¶ä»–ä¸‰ä¸ªæ“ä½œç¬¦çš„å®ç°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Forms a closed interval from `T.min` to `upperBound`</span></span><br><span class="line"><span class="keyword">prefix</span> <span class="func"><span class="keyword">func</span> ... <span class="generics">&lt;T : Comparable where T : MinMaxType&gt;</span></span><br><span class="line">    <span class="params">(upperBound: T)</span></span> -&gt; <span class="type">ClosedInterval</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">T</span>.<span class="built_in">min</span>...upperBound</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Forms a half-open interval from `lowerBound` to `T.max`</span></span><br><span class="line"><span class="keyword">postfix</span> <span class="func"><span class="keyword">func</span> ..<span class="generics">&lt; &lt;T : Comparable where T : MinMaxType&gt;</span></span><br><span class="line">    <span class="params">(lowerBound: T)</span></span> -&gt; <span class="type">HalfOpenInterval</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> lowerBound..&lt;<span class="type">T</span>.<span class="built_in">max</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Forms a closed interval from `lowerBound` to `T.max`</span></span><br><span class="line"><span class="keyword">postfix</span> <span class="func"><span class="keyword">func</span> ... <span class="generics">&lt;T : Comparable where T : MinMaxType&gt;</span></span><br><span class="line">    <span class="params">(lowerBound: T)</span></span> -&gt; <span class="type">ClosedInterval</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> lowerBound...<span class="type">T</span>.<span class="built_in">max</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ä¸€äº›æµ‹è¯•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(..&lt;<span class="number">0</span>).<span class="built_in">contains</span>(<span class="type">Int</span>.<span class="built_in">min</span>) <span class="comment">// true</span></span><br><span class="line">(..&lt;<span class="number">0</span>).<span class="built_in">contains</span>(-<span class="number">1</span>) <span class="comment">// true</span></span><br><span class="line">(..&lt;<span class="number">0</span>).<span class="built_in">contains</span>(<span class="number">0</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">(...<span class="number">0</span>).<span class="built_in">contains</span>(<span class="type">Int</span>.<span class="built_in">min</span>) <span class="comment">// true</span></span><br><span class="line">(...<span class="number">0</span>).<span class="built_in">contains</span>(<span class="number">0</span>) <span class="comment">// true</span></span><br><span class="line">(...<span class="number">0</span>).<span class="built_in">contains</span>(<span class="number">1</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">(<span class="number">0</span>..&lt;).<span class="built_in">contains</span>(-<span class="number">1</span>) <span class="comment">// false</span></span><br><span class="line">(<span class="number">0</span>..&lt;).<span class="built_in">contains</span>(<span class="number">0</span>) <span class="comment">// true</span></span><br><span class="line">(<span class="number">0</span>..&lt;).<span class="built_in">contains</span>(<span class="type">Int</span>.<span class="built_in">max</span>) <span class="comment">// false</span></span><br><span class="line">(<span class="number">0</span>..&lt;).<span class="built_in">contains</span>(<span class="type">Int</span>.<span class="built_in">max</span> - <span class="number">1</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">(<span class="number">0</span>...).<span class="built_in">contains</span>(-<span class="number">1</span>) <span class="comment">// false</span></span><br><span class="line">(<span class="number">0</span>...).<span class="built_in">contains</span>(<span class="number">0</span>) <span class="comment">// true</span></span><br><span class="line">(<span class="number">0</span>...).<span class="built_in">contains</span>(<span class="type">Int</span>.<span class="built_in">max</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>å›åˆ°æˆ‘ä»¬çš„<code>switch</code>è¯­å¥ï¼Œç°åœ¨å¾ˆå¥½åœ°å·¥ä½œäº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>...:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> ..&lt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"Should be unreachable"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç»“è®º">ç»“è®º</h2><p>Swift ä¸­èŒƒå›´å’ŒåŒºé—´éƒ½æœ‰ç›¸ä¼¼çš„ç›®çš„ï¼Œä½†æœ‰ç€ä¸åŒçš„å®ç°å’Œæ³›å‹çº¦æŸã€‚èŒƒå›´åŸºäºç´¢å¼•å¹¶ä¸”ç»å¸¸ç”¨äºé›†åˆä¸Šä¸‹æ–‡ä¸­ã€‚è¿™æ„å‘³ç€èŒƒå›´ä¸èƒ½åŒ…å«ä¸€ä¸ªç±»å‹æœ€å¤§å€¼ï¼Œè¿™å°±ä¸é€‚åˆç”¨åœ¨æ•°å­—çš„åŒºé—´ä¸Šã€‚åŒºé—´å…¼å®¹æ‰€æœ‰çš„<code>Comparable</code>ç±»å‹ï¼Œå¹¶ä¸”æ²¡æœ‰æœ€å¤§å€¼çš„é™åˆ¶ã€‚</p>
<p>è™½ç„¶æˆ‘ä»¬åº”è¯¥å¯¹è‡ªå®šä¹‰æ“ä½œç¬¦æŒè°¨æ…çš„æ€åº¦ï¼Œä½†æˆ‘è®¤ä¸ºåœ¨è¿™ä¸ªç‰¹å®šçš„ä¾‹å­ä¸­ï¼Œä»–ä»¬å¯ä»¥æ˜æ˜¾åœ°æé«˜å¯è¯»æ€§è€Œæ²¡æœ‰é™ä½å¯ç†è§£æ€§â€“è¿™ä¸ªå‰ç¼€å’Œåç¼€æ“ä½œç¬¦éå¸¸æ¥è¿‘ä»–ä»¬åŸæœ¬çš„æ„æ€ï¼Œç”šè‡³æ˜¯ä¸ç†Ÿæ‚‰è¿™æ®µä»£ç çš„è¯»è€…åœ¨ç†è§£å®ƒçš„æ—¶å€™ä¹Ÿä¸ä¼šæœ‰å¤šå¤§çš„å›°éš¾ã€‚</p>
<p>å³ä¾¿å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯è®¤ä¸ºåœ¨è¿™ä¸ªç‰¹å®šçš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨è‡ªå®šä¹‰æ“ä½œç¬¦æ¥æ›¿ä»£æ ‡å‡†çš„ Swift å¥æ³•ï¼ˆcase _ where x &gt; 0ï¼‰æ‰€å¾—åˆ°çš„å¥½å¤„æ˜¯å¾ˆå°çš„ï¼Œå› æ­¤åœ¨å®æˆ˜ä»£ç ä¸­è¿˜æ˜¯ä¸å€¼å¾—ä½¿ç”¨ã€‚æŠŠè¿™ä¸ªæ–¹æ³•æš‚æ—¶è§†ä¸ºæ€è€ƒä¸Šçš„å®è·µï¼Œè€Œéæ¨èä½¿ç”¨ã€‚</p>
<p>å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢ Chris Eidhof å’Œ Airspeed Velocity çš„å³å°†å‡ºç‰ˆçš„ä¹¦ï¼Œ<a href="https://www.objc.io/books/advanced-swift/" target="_blank" rel="external">Swift è¿›é˜¶</a>ã€‚ä»–ä»¬å¯¹äºç›¸åŒçš„åœ¨åŒºé—´ä¸‹æ ‡ä¸Šä¸‹æ–‡ä¸­çš„å¼€é—­åŒºé—´ä¸»é¢˜è®¨è®ºäº†å¾ˆå¤šå…¶å®ƒçš„ä¸œè¥¿ã€‚æˆ‘æ˜¯è¿™æœ¬ä¹¦çš„æŠ€æœ¯å®¡æ ¡ï¼Œæ‰€ä»¥æˆ‘çš„æ„è§åå‘çš„ï¼Œä½†æ˜¯å¦‚æœä½ å¯¹ Swift å¾ˆæ„Ÿå…´è¶£ï¼Œæˆ‘è¿˜æ˜¯éå¸¸æ¨èè¿™æœ¬ä¹¦ç»™ä½ ã€‚è¿™æœ¬ä¹¦å½“å‰æ˜¯ beta çŠ¶æ€ï¼Œä½†æ˜¯ç°åœ¨å·²ç»å¯ä»¥ä¹°åˆ°å®ƒçš„æ—©æœŸé¢„è§ˆç‰ˆäº†ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="http://oleb.net/blog/2015/09/swift-ranges-and-intervals/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-24<br>è¯‘è€…ï¼š<a href="http://www.dianqk.org/">é›é’K</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>æœ¬ç³»åˆ—å…¶å®ƒæ–‡ç« ï¼š</p>
<p>(1)<a href="http://oleb.net/blog/2015/09/swift-pattern-matching/">è‡ªå®šä¹‰æ¨¡å¼åŒ¹é…</a></p>
<p>(2)èŒƒå›´å’ŒåŒºé—´(å³æœ¬ç¯‡)</p>
<p>(3)<a href="http://oleb.net/blog/2015/09/more-pattern-matching-examples/">æ›´å¤šæœ‰å…³æ¨¡å¼åŒ¹é…çš„ä¾‹å­</a></p>
<blockquote>
<p>ä¸‹è½½æœ¬ç¯‡æ–‡ç« æ‰€éœ€è¦çš„ <a href="http://oleb.net/media/swift-ranges-and-intervals.playground.zip">playground</a> ï¼ˆXcode7 è¿è¡Œç¯å¢ƒï¼‰</p>
</blockquote>]]>
    
    </summary>
    
      <category term="Ole Begemann" scheme="http://swiftggteam.github.io/tags/Ole-Begemann/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[3D Touchä¹‹æˆ‘è§]]></title>
    <link href="http://swiftggteam.github.io/2015/10/23/3d-touch-impressions-and-thoughts/"/>
    <id>http://swiftggteam.github.io/2015/10/23/3d-touch-impressions-and-thoughts/</id>
    <published>2015-10-23T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šTomasz Szulcï¼Œ<a href="http://szulctomasz.com/3d-touch-impressions-and-thoughts" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-26<br>è¯‘è€…ï¼š<a href="http://www.brighttj.com" target="_blank" rel="external">saitjr</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="external">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="external">åƒå¶çŸ¥é£</a></p>
</blockquote>
<p>Heyï¼Œç°åœ¨æœ‰äº†æ”¯æŒ3D Touchçš„iPhoneå’ŒiOS9ï¼Œè¿™æ˜¯ä¸€é¡¹ä¼Ÿå¤§çš„ç§‘æŠ€æ°ä½œã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ºå¼€å‘è€…å’Œç”¨æˆ·éƒ½å¸¦æ¥äº†ä»€ä¹ˆå‘¢ã€‚æœ¬æ–‡ä¸»è¦æ˜¯æˆ‘å¯¹3D Touchçš„ç†è§£ï¼Œç„¶ååˆ—ä¸¾äº†ä¸€äº›éœ€è¦æ³¨æ„çš„ç‚¹ã€‚</p>
<a id="more"></a>
<h2 id="å‡ºå¸ˆä¸åˆ©">å‡ºå¸ˆä¸åˆ©</h2><p>æœ¬æ¥æˆ‘æƒ³å†™ä¸€ç¯‡å…¥é—¨çº§å…³äº3D Touchçš„å¯¼è¯»æ–‡ç« ï¼Œä½†æ˜¯é‡åˆ°ä¸€ä¸ªé—®é¢˜â€”â€”Xcode7çš„æ¨¡æ‹Ÿå™¨å¹¶ä¸èƒ½æ¨¡æ‹Ÿ3D Touchã€‚</p>
<p>è‹¹æœå®˜æ–¹çš„è¯´æ³•æ˜¯ï¼š</p>
<blockquote>
<p>Xcode7.0ä¸­ï¼Œä½ å¿…é¡»ä½¿ç”¨æ”¯æŒ3D Touchçš„çœŸæœºè¿›è¡Œå¼€å‘ã€‚å› ä¸ºXcode7.0çš„æ¨¡æ‹Ÿå™¨ä¸æ”¯æŒ3D Touchã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸ªæ‚²ä¼¤çš„æ•…äº‹ï¼Œä½†æ˜¯åˆæœ‰ä»€ä¹ˆåŠæ³•å‘¢ã€‚æˆ‘æƒ³ï¼Œè‹¹æœåº”è¯¥ä¼šæƒ³åŠæ³•æ¨¡æ‹Ÿå‡ºæ¥ã€‚å¯èƒ½åœ¨ä¸‹ä¸€ä¸ªXcodeå‘å¸ƒç‰ˆæœ¬ä¸­å°±èƒ½çœ‹åˆ°ã€‚</p>
<p>å¦ä¸€ä¸ªé—®é¢˜åˆ™æ˜¯æ–°çš„iPhoneè¿˜æ²¡æœ‰åœ¨æ³¢å…°å‘å”®ï¼Œå¯èƒ½è¿˜è¦ç­‰2å‘¨ï¼ˆè¯‘è€…æ³¨ï¼šä½œè€…å†™æ–‡åœ¨æ³¢å…°iPhoneå‘å”®ä»¥å‰ï¼‰ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªåŠæ³•ï¼Œæˆ‘10æœˆè¦åœ¨San Franciscoå’ŒPalo Altoå‘†ä¸Šæ•´æ•´ä¸€æœˆï¼Œæ‰€ä»¥æˆ‘å¯èƒ½ä¼šä¹°ä¸€éƒ¨iPhoneï¼Œä½†ä¸ç¡®å®šæ˜¯6sè¿˜æ˜¯6s plusã€‚</p>
<p>å¦‚æœä¹°äº†è®¾å¤‡ï¼Œé‚£æˆ‘è‚¯å®šä¼šå‘å¸ƒä¸€å¤§æ³¢3D Touchçš„æ–‡ç« ã€‚</p>
<h2 id="Peek_and_popæ“ä½œ">Peek and popæ“ä½œ</h2><p>è¿™æ˜¯è‹¹æœä»‹ç»3D Touchçš„ç¬¬ä¸€ä¸ªç‰¹æ€§â€”â€”æˆ–è€…è¯´æ˜¯ä¸¤ä¸ªç‰¹æ€§ã€‚</p>
<ul>
<li>è½»å‹(peek,è½»åº¦æŒ‰å‹)æ“ä½œèƒ½è®©ç”¨æˆ·åœ¨ä¸ç¦»å¼€å½“å‰ç•Œé¢çš„æƒ…å†µä¸‹é¢„è§ˆå†…å®¹ã€‚å¦‚æœè½»æŒ‰æŸä¸ªé€‰é¡¹èƒ½å¤Ÿå¼¹å‡ºä¸€ä¸ªå°çš„çŸ©å½¢è§†å›¾ï¼Œåˆ™è¡¨æ˜å®ƒæ”¯æŒè½»å‹æ“ä½œã€‚</li>
<li>peekæ‰‹åŠ¿å¼¹å‡ºçš„è§†å›¾åº”è¯¥è¶³å¤Ÿå¤§ï¼Œè¿™æ ·å†…å®¹å°±ä¸ä¼šè¢«æ‰‹æŒ‡æŒ¡ä½ï¼Œä»è€Œç”¨æˆ·å¯ä»¥é€‰æ‹©æ˜¯å¦é‡å‹ï¼Œå³popæ“ä½œï¼ˆè¯‘è€…æ³¨ï¼špeekæ“ä½œå³è½»æŒ‰ï¼Œç”¨äºé¢„è§ˆï¼Œpopæ“ä½œåˆ™æ˜¯é‡å‹ï¼Œç”¨äºè¿›ä¸€æ­¥ç¡®è®¤ã€‚popèƒ½æ»¡è¶³åœ¨é¢„è§ˆä¹‹åï¼Œè¿›å…¥ç‰¹å®šé¡µé¢çš„éœ€æ±‚ï¼‰ã€‚</li>
<li>popåˆ™æ˜¯å½“ç”¨æˆ·åœ¨peekå¼¹å‡ºçš„è§†å›¾ä¸ŠåŠ é‡æŒ‰å‹åŠ›åº¦ï¼Œæ˜¾ç¤ºæ›´è¯¦ç»†çš„å†…å®¹ã€‚</li>
<li>å³ä½¿peekèƒ½ç»™ç”¨æˆ·è¶³å¤Ÿå¤šçš„ä¿¡æ¯ï¼Œä½ ä¹Ÿåº”è¯¥è®©ç”¨æˆ·å°†è¯¥æ“ä½œè½¬åŒ–ä¸ºpopã€‚popæ‰€æ˜¾ç¤ºçš„ç•Œé¢åº”è¯¥å’Œç”¨æˆ·ç‚¹å‡»è¿›å…¥ç•Œé¢ç›¸åŒã€‚</li>
<li>è¯·å‹¿åœ¨peeké¢„è§ˆçš„ç•Œé¢ä¸­æ”¾å…¥æŒ‰é’®ï¼Œå› ä¸ºç”¨æˆ·æ‰‹æŒ‡ä¸€ç¦»å¼€é¢„è§ˆç•Œé¢ï¼Œé¢„è§ˆç•Œé¢å°±ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥æ ¹æœ¬ç‚¹ä¸åˆ°æŒ‰é’®ã€‚</li>
<li>å½“ç”¨æˆ·åœ¨é¢„è§ˆç•Œé¢ä¸­å‘ä¸Šæ»‘åŠ¨æ—¶ï¼Œpeekå¯ä»¥æä¾›ä¸€äº›å¿«æ·æ“ä½œ(quick action)ã€‚ä½ å¯ä»¥åœ¨é¢„è§ˆç•Œé¢ä¸­æ·»åŠ ä¸€äº›å¿«æ·æ“ä½œï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥ä¸Šæ»‘ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªä½ æ‰€æä¾›çš„æ“ä½œäº†ã€‚</li>
<li>å¦‚æœä½ ä¸ºæŸä¸ªé€‰é¡¹æä¾›äº†é•¿æŒ‰æ‰‹åŠ¿äº‹ä»¶(touch-and-holdï¼Œæˆ–è€…å«long press)ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨peekæ¥ä»£æ›¿é•¿æŒ‰æ‰‹åŠ¿ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å°è¯•ã€‚</li>
<li>å¦‚æœä½ æƒ³ä½¿ç”¨å¿«æ·æ“ä½œã€peekå’Œpopï¼Œé‚£ä¹ˆè®°ä½åœ¨ä½¿ç”¨å‰å…ˆåˆ¤æ–­3D Touchæ˜¯å¦å¯ç”¨ã€‚</li>
<li>ä¸æ˜¯æ¯ä¸ªè®¾å¤‡éƒ½æ”¯æŒpeekå’Œpopæ“ä½œçš„ï¼Œå¹¶ä¸”3D Touchä¹Ÿå¯èƒ½å¤„äºç¦ç”¨çŠ¶æ€ã€‚æ‰€ä»¥ä¸è¦è®©æŸäº›äº‹ä»¶åªèƒ½ç”±peekæ¥è§¦å‘ã€‚æœ€å¥½æœ‰ä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆï¼Œå³è§†å›¾ä¹Ÿèƒ½é€šè¿‡é•¿æŒ‰æ‰‹åŠ¿æ¥å±•ç¤ºã€‚</li>
</ul>
<h2 id="å¿«æ·æ“ä½œ">å¿«æ·æ“ä½œ</h2><p>æ¥ä¸‹æ¥ï¼Œä»‹ç»ä¸€äº›ç”¨æˆ·åœ¨é‡å‹åº”ç”¨å›¾æ ‡æ—¶çš„ä¸€äº›å¿«æ·æ“ä½œã€‚</p>
<ul>
<li>å¼¹å‡ºæ¡†åŒ…å«äº†ä¸»æ ‡é¢˜ã€å‰¯æ ‡é¢˜ä¸å›¾æ ‡ã€‚</li>
<li>è¯¥æ“ä½œå¯ä»¥åœ¨åº”ç”¨ç¨‹åºæ›´æ–°æ—¶ï¼Œæ˜¾ç¤ºæ›´æ–°ä¿¡æ¯ã€‚</li>
<li>ä½ çš„åº”ç”¨åœ¨Homeç•Œé¢ä¸­ï¼Œåº”è¯¥è‡³å°‘æä¾›ä¸€ä¸ªå¿«æ·é€‰é¡¹ã€‚è¿™æ ·ç”¨æˆ·å°±å¯ä»¥ä½¿ç”¨æ‰‹åŠ¿æ“ä½œä½ çš„åº”ç”¨ï¼Œæ–¹ä¾¿å¿«æ·ã€‚</li>
<li>åŒ»ç”¨æœ€å¤šå¯ä»¥æä¾›å››ä¸ªå¿«æ·æ“ä½œã€‚</li>
<li>ä¸è¦ä½¿ç”¨å¿«æ·æ“ä½œæ¥æé†’ç”¨æˆ·æ›´æ–°ã€å˜æ›´ä¹‹ç±»çš„äº‹ã€‚å¦‚æœ‰éœ€è¦ï¼Œé€šçŸ¥(<em>Notifications</em>)æ›´èƒ½èƒœä»»è¿™äº›ä»»åŠ¡ã€‚</li>
<li>å¿«æ·æ“ä½œçš„å‘½ååº”è¯¥ç®€æ´ï¼Œå¦‚æœ‰éœ€è¦ï¼Œè¿˜åº”è¯¥æœ‰å‰¯æ ‡é¢˜å’Œå›¾æ ‡ã€‚å°½é‡è®©ç”¨æˆ·æ˜ç¡®è¯¥æ“ä½œçš„ä½œç”¨ã€‚å¦‚æœæä¾›äº†å‰¯æ ‡é¢˜ï¼Œé‚£ä¹ˆæ ‡é¢˜æ å°†ä¼šæ›´é•¿ï¼Œå¦‚æœå¤§å°ä¸èƒ½é€‚åº”ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æˆªå–ã€‚å¦‚æœæ²¡æœ‰å‰¯æ ‡é¢˜ï¼Œé‚£ä¹ˆä¸»æ ‡é¢˜è¿‡é•¿ä¼šè‡ªåŠ¨æ¢è¡Œã€‚</li>
</ul>
<h2 id="æ€»ç»“">æ€»ç»“</h2><p>3D Touchæ˜¯ä¸€ä¸ªéå¸¸çˆ½çš„ç‰¹æ€§ï¼Œå®ƒæä¾›äº†å…¨æ–°çš„äº¤äº’æ–¹å¼ã€‚è®¾å¤‡ä¸­åŒ…å«äº†ä¸€ä¸ªçº¿æ€§æŒ¯åŠ¨å™¨(Taptic Engine)ï¼Œæ‰€ä»¥æŒ‰å‹å±å¹•æ—¶ï¼Œè®¾å¤‡èƒ½æœ‰ä¸€å®šå“åº”â€”â€”å¤ªå¥½äº†ï¼Œè¿«ä¸åŠå¾…æƒ³è¦è¯•è¯•ã€‚</p>
<p>éå¸¸é—æ†¾ï¼Œè‹¹æœæ²¡æœ‰åœ¨æœ€æ–°çš„Xcode 7 beta 2ä¸­è§£å†³æ— æ³•æ¨¡æ‹Ÿçš„é—®é¢˜ï¼Œè¿˜æ˜¯å¸Œæœ›ä»–ä»¬å°½å¿«æå®šå§â€”â€”æˆ–è®¸ä»–ä»¬ä¸ä¿®å¤æ˜¯ä¸ºäº†å¢åŠ é”€é‡ï¼Œå› ä¸ºç”¨æˆ·å·²ç»è¿«ä¸åŠå¾…çš„æƒ³è¦è¯•è¯•è¿™ä¸ªæ–°ç‰¹æ€§äº†ï¼Œè€Œæœ€ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œå°±æ˜¯ä¹°ä¸ªæ–°è®¾å¤‡ :Dã€‚</p>
<p>æˆ‘å·²ç»è¿«ä¸åŠå¾…çš„æƒ³è¦å°è¯•åŸºäº3D Touchçš„åº”ç”¨äº†ï¼Œå¦‚æ¸¸æˆå’Œç”»å›¾ï¼Œè¿˜æœ‰ä¸€äº›æˆ‘æƒ³è±¡ä¸åˆ°çš„åº”ç”¨ã€‚æˆ–è®¸è¿˜å¯ä»¥çœ‹åˆ°è®¡é‡é‡é‡çš„åº”ç”¨ï¼Œæ¯”å¦‚ç§°ä¸€ä¸ªæ°´æœçš„é‡é‡ï¼Œæˆ–æ˜¯ä¸€ä¸ªæ”¾ç½®åœ¨å±å¹•ä¸Šçš„ç‰©ä½“çš„é‡é‡ç­‰ç­‰ :&gt;ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šTomasz Szulcï¼Œ<a href="http://szulctomasz.com/3d-touch-impressions-and-thoughts">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-26<br>è¯‘è€…ï¼š<a href="http://www.brighttj.com">saitjr</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao">åƒå¶çŸ¥é£</a></p>
</blockquote>
<p>Heyï¼Œç°åœ¨æœ‰äº†æ”¯æŒ3D Touchçš„iPhoneå’ŒiOS9ï¼Œè¿™æ˜¯ä¸€é¡¹ä¼Ÿå¤§çš„ç§‘æŠ€æ°ä½œã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ºå¼€å‘è€…å’Œç”¨æˆ·éƒ½å¸¦æ¥äº†ä»€ä¹ˆå‘¢ã€‚æœ¬æ–‡ä¸»è¦æ˜¯æˆ‘å¯¹3D Touchçš„ç†è§£ï¼Œç„¶ååˆ—ä¸¾äº†ä¸€äº›éœ€è¦æ³¨æ„çš„ç‚¹ã€‚</p>]]>
    
    </summary>
    
      <category term="Tomasz Szulc" scheme="http://swiftggteam.github.io/tags/Tomasz-Szulc/"/>
    
      <category term="3D Touch" scheme="http://swiftggteam.github.io/categories/3D-Touch/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/3D-Touch/Swift-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Swift ç¼–ç¨‹æ€æƒ³ Part 4ï¼šmap all the things!]]></title>
    <link href="http://swiftggteam.github.io/2015/10/22/thinking-in-swift-4/"/>
    <id>http://swiftggteam.github.io/2015/10/22/thinking-in-swift-4/</id>
    <published>2015-10-22T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/10/11/thinking-in-swift-4/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-11<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/97c49dfd1f9f/latest_articles" target="_blank" rel="external">ray16897188</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.futantan.com" target="_blank" rel="external">Prayer</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a></p>
</blockquote>
<p>ç³»åˆ—æ–‡ç« åœ°å€ï¼š</p>
<ul>
<li><a href="http://swift.gg/2015/09/29/thinking-in-swift-1/" target="_blank" rel="external">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬ä¸€éƒ¨åˆ†ï¼šæ‹¯æ•‘å°é©¬</a></li>
<li><a href="http://swift.gg/2015/10/09/thinking-in-swift-2/" target="_blank" rel="external">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼šæ•°ç»„çš„ Map æ–¹æ³•</a></li>
<li><a href="http://alisoftware.github.io/swift/2015/10/03/thinking-in-swift-3/" target="_blank" rel="external">Swiftç¼–ç¨‹æ€æƒ³ç¬¬ä¸‰éƒ¨åˆ†ï¼šç»“æ„ä½“å’Œç±»</a></li>
</ul>
<p><a href="http://swift.gg/2015/10/09/thinking-in-swift-2/" target="_blank" rel="external">åœ¨æœ¬ç³»åˆ—ä¹‹å‰çš„æ–‡ç« ä¸­</a>æˆ‘ä»¬å­¦åˆ°äº†å¦‚ä½•ä½¿ç”¨<code>map</code>å’Œ<code>flatMap</code>æ¥æ“ä½œæ•°ç»„(arrays)ã€‚ä»Šå¤©æˆ‘ä»¬ç»§ç»­ç ”ç©¶å¦‚ä½•å¯¹å¯é€‰ç±»å‹(Optionals)ä»¥åŠå¾ˆå¤šå…¶ä»–ç±»å‹ä½¿ç”¨<code>map</code>å’Œ<code>flatMap</code>ã€‚</p>
<a id="more"></a>
<h3 id="æ•°ç»„_vs-_å¯é€‰ç±»å‹">æ•°ç»„ vs. å¯é€‰ç±»å‹</h3><p>å›é¡¾ä¸€ä¸‹ï¼Œå­¦å®Œå‰é¢çš„æ–‡ç« åæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œ<code>Array&lt;T&gt;</code>å¯¹åº”çš„<code>map()</code>å’Œ<code>flatMap()</code>å‡½æ•°ç­¾åæ˜¯ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½œç”¨åœ¨Array&lt;T&gt;ä¸Šçš„æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">map</span>( transform: <span class="type">T</span> -&gt;          <span class="type">U</span>  ) -&gt; <span class="type">Array</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">flatMap( transform: <span class="type">T</span> -&gt;    <span class="type">Array</span>&lt;<span class="type">U</span>&gt; ) -&gt; <span class="type">Array</span>&lt;<span class="type">U</span>&gt;</span><br></pre></td></tr></table></figure>
<p>æ„æ€æ˜¯ä½ å¯ä»¥ç”¨ä¸€ä¸ªç»™å®šçš„<code>transform: T-&gt;U</code>å°†ä¸€ä¸ªå…ƒç´ ç±»å‹æ˜¯<code>T</code>çš„æ•°ç»„è½¬æ¢æˆä¸€ä¸ªå…ƒç´ ç±»å‹æ˜¯<code>U</code>çš„æ•°ç»„ã€‚å¯¹<code>Array&lt;T&gt;</code>è°ƒç”¨<code>map( transform: T-&gt;U )</code>æ–¹æ³•å°±ä¼šè¿”å›ä¸€ä¸ª<code>Array&lt;U&gt;</code>ï¼Œå°±è¿™ä¹ˆç®€å•ã€‚</p>
<p>å—¯ï¼Œä¸å‡ºæ„å¤–ï¼Œå¯¹äº<code>Optional&lt;T&gt;</code>æ¥è¯´ï¼Œ<code>map()</code>å’Œ<code>flatMap()</code>çš„å‡½æ•°ç­¾åååˆ†ç±»ä¼¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½œç”¨åœ¨Optional&lt;T&gt;ä¸Šçš„æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">map</span>( transform: <span class="type">T</span> -&gt;          <span class="type">U</span>  ) -&gt; <span class="type">Optional</span>&lt;<span class="type">U</span>&gt;</span><br><span class="line">flatMap( transform: <span class="type">T</span> -&gt; <span class="type">Optional</span>&lt;<span class="type">U</span>&gt; ) -&gt; <span class="type">Optional</span>&lt;<span class="type">U</span>&gt;</span><br></pre></td></tr></table></figure>
<p>æ˜¯ä¸æ˜¯å¾ˆåƒï¼Ÿ</p>
<h3 id="ä½œç”¨åœ¨å¯é€‰ç±»å‹ä¸Šçš„_map()">ä½œç”¨åœ¨å¯é€‰ç±»å‹ä¸Šçš„ map()</h3><p>é‚£ä¹ˆ<code>map</code>æ–¹æ³•åˆ°åº•å¯¹<code>Optional&lt;T&gt;</code>ç±»å‹(ä¹Ÿå«åš<code>T?</code>)åšäº†ä»€ä¹ˆï¼Ÿ</p>
<p>å…¶å®å¾ˆç®€å•ï¼šå’Œä½œç”¨åœ¨<code>Array&lt;T&gt;</code>ä¸Šçš„ä¸€æ ·ï¼Œ<code>map</code>æ–¹æ³•å°†<code>Optional&lt;T&gt;</code>ä¸­çš„å†…å®¹å–å‡ºæ¥ï¼Œç”¨æŒ‡å®šçš„<code>transform: T-&gt;U</code>æ–¹æ³•åšå‡ºè½¬æ¢ï¼Œç„¶åæŠŠç»“æœåŒ…è£…æˆä¸€ä¸ªæ–°çš„<code>Optional&lt;U&gt;</code>ã€‚</p>
<p>å¦‚æœç»†æƒ³ä¸€ä¸‹ï¼Œè¿™å’Œ<code>Array&lt;T&gt;.map</code>åšçš„äº‹æƒ…ååˆ†ç›¸ä¼¼ï¼šè¿™ä¸ªæ–¹æ³•å¯¹<code>Array&lt;T&gt;</code>(ä¸ä¹‹ç›¸åº”çš„æ˜¯<code>Optional&lt;T&gt;</code>)ä¸­çš„æ¯ä¸ªå…ƒç´ ä½¿ç”¨<code>transform</code>å‡½æ•°è½¬æ¢ï¼Œå¹¶å°†è½¬æ¢è¿‡çš„å€¼å°è£…åœ¨ä¸€ä¸ªæ–°çš„<code>Array&lt;U&gt;</code>ä¸­(ä¸ä¹‹ç›¸åº”çš„æ˜¯<code>Optional&lt;U&gt;</code>)ï¼Œä½œä¸ºç»“æœè¿”å›ã€‚</p>
<h3 id="å›åˆ°æˆ‘ä»¬çš„ä¾‹å­">å›åˆ°æˆ‘ä»¬çš„ä¾‹å­</h3><p>é‚£ä¹ˆè¿™å¯¹æˆ‘ä»¬ä¸€ç›´åœ¨åšçš„ç¤ºä¾‹ä»£ç æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Ÿ</p>
<p>åœ¨<a href="http://alisoftware.github.io/swift/2015/10/03/thinking-in-swift-3/#converting-our-class-to-a-struct" target="_blank" rel="external">æˆ‘ä»¬æœ€æ–°ç‰ˆä»£ç ä¸­</a>ï¼Œæœ‰ä¸€ä¸ª<code>String?</code>ç±»å‹çš„<code>itemDesc[&quot;icon&quot;]</code>ï¼Œæˆ‘ä»¬å½“æ—¶æƒ³æŠŠå®ƒè½¬æ¢æˆä¸€ä¸ª<code>UIImage</code>ï¼›ä½†æ˜¯<code>UIImage(named:)</code>è¦æ±‚ä¼ å…¥ä¸€ä¸ª<code>String</code>å‹çš„å‚æ•°ï¼Œè€Œä¸æ˜¯<code>String?</code>å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å¯é€‰å‹ä¸­ç¡®å®æœ‰å€¼æ—¶(é<code>nil</code>)å°†å†…éƒ¨çš„<code>String</code>å€¼ä¼ å…¥ã€‚</p>
<p>ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å¯é€‰ç»‘å®š(Optional Binding)ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> icon: <span class="type">UIImage</span>?</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">  icon = <span class="type">UIImage</span>(named: iconName)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  icon = <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¯¹äºä¸€ä¸ªå¦‚æ­¤ç®€å•çš„æ“ä½œæ¥è¯´ä»£ç é‡å¤ªå¤§ã€‚</p>
<p>ä¹‹å‰çš„ä¸€ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç”¨äº†å¦å¤–ä¸€ç§(å¾ˆä¸ä¼˜é›…çš„)æ–¹å¼ï¼Œä½¿ç”¨<code>nil</code>-è”åˆæ“ä½œç¬¦<code>??</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line"><span class="keyword">let</span> icon = <span class="type">UIImage</span>(named: iconName ?? <span class="string">""</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¹ˆåšæ˜¯å¯ä»¥ï¼Œä½†æ˜¯ä¹‹æ‰€ä»¥èƒ½å¤ŸæˆåŠŸï¼Œæ˜¯å› ä¸ºå½“<code>iconName</code>æ˜¯<code>nil</code>æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯ä½¿ç”¨äº†<code>UIImage(named: &quot;&quot;)</code>çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œè¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•åœ¨ä¼ å…¥ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¿”å›<code>nil</code>ã€‚ä½†æ˜¯è¿™æ ·çš„è§£å†³åŠæ³•ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä¾èµ–äºè¯¥åˆå§‹åŒ–æ–¹æ³•çš„ç‰¹æ€§ï¼ˆä¼ å…¥ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¿”å›<code>nil</code>ï¼‰æ¥å®ç°çš„ã€‚</p>
<h3 id="æ¥ç”¨_map_å§">æ¥ç”¨ map å§</h3><p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¸ç”¨<code>map</code>å‘¢ï¼Ÿæœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æ˜¯æƒ³è¦åœ¨<code>Optional&lt;String&gt;</code>ä¸æ˜¯<code>nil</code>çš„æ—¶å€™å°†å…¶è§£åŒ…ï¼ŒæŠŠé‡Œé¢çš„å€¼è½¬æ¢æˆä¸€ä¸ª<code>UIImage</code>å¯¹è±¡ç„¶åæŠŠè¿™ä¸ª<code>UIImage</code>è¿”å›ï¼Œè¿™ä¸å°±æ˜¯ä¸€ä¸ªç»ä½³çš„ç”¨ä¾‹ä¹ˆï¼Ÿ</p>
<p>è¯•è¯•çœ‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line">item.icon = iconName.<span class="built_in">map</span> &#123; imageName <span class="keyword">in</span> <span class="type">UIImage</span>(named: imageName) &#125;</span><br></pre></td></tr></table></figure>
<p>ç­‰ä¼šå„¿â€¦. ç¼–è¯‘ä¸é€šè¿‡ã€‚èƒ½çŒœå‡ºä¸ºä»€ä¹ˆå—ï¼Ÿ</p>
<h3 id="å“ªå„¿æœ‰é—®é¢˜ï¼Ÿ">å“ªå„¿æœ‰é—®é¢˜ï¼Ÿ</h3><p>ä¸Šé¢çš„ä»£ç ä¸­çš„é—®é¢˜æ˜¯<code>UIImage(named: â€¦)</code>ä¹Ÿè¿”å›ä¸€ä¸ªå¯é€‰ç±»å‹ï¼šå¦‚æœå¯¹ç»™å®šçš„<code>name</code>æ²¡æœ‰ç›¸åº”çš„å›¾ç‰‡ï¼Œå°±ä¸èƒ½åˆ›å»ºå‡ºä¸€ä¸ª<code>UIImage</code>ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹è¯¥åˆå§‹åŒ–æ–¹æ³•ä¸º<em>å¯å¤±è´¥çš„(failable)</em>ï¼Œå¹¶è¿”å›<code>nil</code>ï¼Œæ˜¯å®Œå…¨åˆç†çš„ã€‚</p>
<p>äºæ˜¯é—®é¢˜å°±åœ¨äºæˆ‘ä»¬ç»™<code>map</code>çš„è¿™ä¸ªé—­åŒ…ç”¨ä¸€ä¸ª<code>String</code>ä½œä¸ºå‚æ•°è€Œè¿”å›â€¦ä¸€ä¸ª<code>UIImage?</code>ç±»å‹â€”â€”å› ä¸ºå›¾ç‰‡çš„åˆå§‹åŒ–æ–¹æ³•æ˜¯<em>å¯å¤±è´¥çš„</em>ï¼Œä¼šè¿”å›<code>nil</code>ã€‚å†çœ‹ä¸€ä¸‹<code>map</code>æ–¹æ³•çš„ç­¾åï¼Œå®ƒæƒ³è¦çš„æ˜¯ä¸€ä¸ª<code>T-&gt;U</code>ç±»å‹çš„é—­åŒ…ï¼Œè¿™ä¸ªé—­åŒ…ä¼šè¿”å›ä¸€ä¸ª<code>U?</code>ç±»å‹ã€‚æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ<code>U</code>ä»£è¡¨<code>UIImage?</code>çš„è¯ï¼Œæ•´ä¸ª<code>map</code>è¡¨è¾¾å¼ä¼šè¿”å›ä¸€ä¸ª<code>U?</code>ç±»å‹ï¼Œä¹Ÿå°±æ˜¯â€¦ä¸€ä¸ª<code>UIImage??</code>ç±»å‹â€¦æ˜¯çš„ï¼Œä¸€ä¸ªåŒé‡å¯é€‰ç±»å‹ï¼Œå“æ­»å®å®äº†ï¼</p>
<h3 id="flatMap()_æ¥å¸®å¿™äº†">flatMap() æ¥å¸®å¿™äº†</h3><p><code>flatMap()</code>ä¸<code>map</code>ç±»ä¼¼ï¼Œä½†æ˜¯åšçš„æ˜¯ä¸€ä¸ª<code>T-&gt;U?</code>çš„è½¬æ¢(ä¸æ˜¯<code>T-&gt;U</code>)ï¼Œå®ƒæŠŠç»“æœâ€œæ‰å¹³åŒ–(é¡¾åæ€ä¹‰)â€æˆä¸€ä¸ªå•é‡çš„å¯é€‰ç±»å‹ã€‚è¿™æ°æ°å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line">item.icon = iconName.flatMap &#123; imageName <span class="keyword">in</span> <span class="type">UIImage</span>(named: imageName) &#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸­<code>flatMap</code>åšäº†å¦‚ä¸‹å·¥ä½œï¼š</p>
<ul>
<li>å¦‚æœ<code>iconName</code>æ˜¯<code>nil</code>çš„è¯ï¼Œå®ƒå°±ç›´æ¥è¿”å›<code>nil</code>(ä½†è¿”å›ç±»å‹è¿˜æ˜¯<code>UIImage?</code>)</li>
<li>å¦‚æœ<code>iconName</code>ä¸æ˜¯<code>nil</code>ï¼Œå®ƒå°±æŠŠ<code>transform</code>ä½œç”¨åˆ°<code>iconName</code>çš„å®é™…çš„å€¼ä¸Šï¼Œå°è¯•ç”¨è¿™ä¸ª<code>String</code>åˆ›å»ºä¸€ä¸ª<code>UIImage</code>å¹¶å°†ç»“æœè¿”å›â€”â€”ç»“æœæœ¬èº«å·²ç»æ˜¯ä¸€ä¸ª<code>UIImage?</code>ç±»å‹ï¼Œå› æ­¤å¦‚æœ<code>UIImage</code>åˆå§‹åŒ–æ–¹æ³•å¤±è´¥çš„è¯ï¼Œè¿”å›ç»“æœå°±æ˜¯<code>nil</code>ã€‚</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>item.icon</code>åªä¼šåœ¨<code>itemDesc[&quot;icon&quot;] as? String</code>éç©ºã€å¹¶ä¸”<code>UIImage(named: imageName)</code>åˆå§‹åŒ–æ–¹æ³•æˆåŠŸçš„æƒ…å†µä¸‹æ‰æ˜¯ä¸€ä¸ªéç©ºå€¼ã€‚</p>
<p>å’Œä½¿ç”¨<code>??</code>æ¬ºéª—åˆå§‹åŒ–æ–¹æ³•ç›¸æ¯”ï¼Œè¿™ä¹ˆåšæ›´å¥½ï¼Œæ›´åœ°é“ã€‚</p>
<h3 id="æŠŠ_init_å½“é—­åŒ…æ¥ç”¨">æŠŠ init å½“é—­åŒ…æ¥ç”¨</h3><p>æ›´è¿›ä¸€æ­¥ï¼Œç”±äºç°åœ¨ Xcode 7 å¯ä»¥é€šè¿‡ç±»å‹çš„<code>.init</code>å±æ€§æš´éœ²è¯¥ç±»å‹çš„æ„é€ å™¨(constructors)ï¼Œä¸Šé¢çš„ä»£ç è¿˜èƒ½å†™çš„æ›´åŠ ç´§å‡‘ã€‚</p>
<p>è¿™æ„å‘³ç€<code>UIImage.init</code>æœ¬è´¨ä¸Šå°±å·²ç»æ˜¯ä¸€ä¸ªæ¥æ”¶<code>String</code>å¹¶è¿”å›<code>UIImage?</code>çš„æ–¹æ³•äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç›´æ¥å½“æˆå‚æ•°æ¥è°ƒç”¨<code>flatMap</code>ï¼Œä¸ç”¨æŠŠå®ƒå†åŒ…è¿›ä¸€ä¸ªé—­åŒ…é‡Œï¼</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line">item.icon = iconName.flatMap(<span class="type">UIImage</span>.<span class="keyword">init</span>)</span><br></pre></td></tr></table></figure>
<p>å“‡å“¦ï¼å¤ªé­”å¹»äº†ï¼</p>
<p><img src="/img/articles/thinking-in-swift-4/magic.gif1445562506.7864432" alt=""></p>
<p>å¥½äº†ï¼Œæœ‰äººè¯´è¿™ä¹ˆå†™å¾ˆéš¾è¯»æ‡‚ï¼Œä¸ºäº†è®©ä»£ç æ›´æ˜äº†æ›´æ¸…æ™°ï¼Œåœ¨è¿™é‡Œè¿˜æ˜¯æ›´å–œæ¬¢ç”¨ä¸€ä¸ªæ˜¾å¼é—­åŒ…ã€‚ä½†æ˜¯è¿™åªæ˜¯å…³ä¹ä¸ªäººåå¥½ï¼Œå¹¶ä¸”çŸ¥é“è¿™ä¹ˆåšå¯è¡Œä¹Ÿæ˜¯å¥½äº‹ã€‚</p>
<h3 id="æœ€ç»ˆçš„Swiftä»£ç ">æœ€ç»ˆçš„Swiftä»£ç </h3><p>ä¸‹é¢å°±æ˜¯å°†æœ¬è¯¾æ‰€å­¦åº”ç”¨åˆ°ä¹‹å‰ä»£ç é‡Œçš„æ ·å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListItem</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> icon: <span class="type">UIImage</span>?</span><br><span class="line">  <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> url: <span class="type">NSURL</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> <span class="func"><span class="keyword">func</span> <span class="title">listItemsFromJSONData</span><span class="params">(jsonData: NSData?)</span></span> -&gt; [<span class="type">ListItem</span>] &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> jsonData = jsonData,</span><br><span class="line">      <span class="keyword">let</span> json = <span class="keyword">try</span>? <span class="type">NSJSONSerialization</span>.<span class="type">JSONObjectWithData</span>(jsonData, options: []),</span><br><span class="line">      <span class="keyword">let</span> jsonItems = json <span class="keyword">as</span>? <span class="type">Array</span>&lt;<span class="type">NSDictionary</span>&gt; <span class="keyword">else</span> &#123; <span class="keyword">return</span> [] &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> jsonItems.flatMap &#123; (itemDesc: <span class="type">NSDictionary</span>) -&gt; <span class="type">ListItem</span>? <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> title = itemDesc[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">        <span class="keyword">let</span> urlString = itemDesc[<span class="string">"url"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">        <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: urlString)</span><br><span class="line">        <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">      <span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line">      <span class="keyword">let</span> icon = iconName.flatMap &#123; <span class="type">UIImage</span>(named: $<span class="number">0</span>) &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">ListItem</span>(icon: icon, title: title, url: url)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å›å¤´çœ‹ä¸€çœ¼æˆ‘ä»¬çš„_ObjC_ä»£ç ">å›å¤´çœ‹ä¸€çœ¼æˆ‘ä»¬çš„ ObjC ä»£ç </h3><p>èŠ±ä¸€ç‚¹å„¿æ—¶é—´æ¯”è¾ƒä¸€ä¸‹æˆ‘ä»¬æœ€ç»ˆçš„ Swift ä»£ç å’Œ<a href="http://alisoftware.github.io/swift/2015/09/06/thinking-in-swift-1/#the-objc-code" target="_blank" rel="external">æœ€å¼€å§‹çš„ObjCä»£ç </a>ã€‚æˆ‘ä»¬ç€å®æ”¹äº†å¾ˆå¤§ä¸€éƒ¨åˆ†å†…å®¹ã€‚</p>
<p>å¦‚æœä½ ä»”ç»†çœ‹ä¸€ä¸‹ ObjC å’Œ Swift ä»£ç ï¼Œä¼šå‘ç° Swift çš„ä»£ç é‡å¹¶ä¸æ˜¯é‚£ä¹ˆå°‘(ObjC æ˜¯ 5+15 LoC<sup>1</sup>ï¼Œå¯¹æ¯” Swift çš„ 19 LoC)ï¼Œä½†æ˜¯<strong>å®‰å…¨æ€§é«˜äº†å¤ªå¤š</strong>ã€‚</p>
<p>å°¤å…¶æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„<code>guard</code>ï¼Œ<code>try?</code>å’Œ<code>as?</code>ä¼šè¿«ä½¿æˆ‘ä»¬å»æ£€æŸ¥æ‰€æœ‰ç±»å‹æ˜¯å¦éƒ½å¦‚æ‰€æœŸï¼ŒObjC ä»£ç ä¸ä¼šå…³å¿ƒè¿™äº›ï¼Œå› æ­¤å¯èƒ½å´©æºƒğŸ’£ğŸ’¥ã€‚æ‰€ä»¥è™½ç„¶ä»£ç é‡ç›¸å½“ï¼Œä½† ObjC ä»£ç æ›´å±é™©ã€‚</p>
<h3 id="ç»“è®º">ç»“è®º</h3><p>é€šè¿‡æœ¬ç³»åˆ—æ–‡ç« ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½å¤Ÿæ„è¯†åˆ°ï¼šä¸è¦å°è¯•å°†ä½ çš„ ObjC ä»£ç ç›´è¯‘æˆ Swiftã€‚ç›¸åï¼Œä½ è¦å»é‡æ–°è€ƒè™‘ä¸€ä¸‹ä½ çš„ä»£ç ï¼Œé‡æ–°æƒ³è±¡ä¸€ä¸‹ä½ çš„ä»£ç ã€‚ä»ä¸€ä¸ªç©ºç™½çŠ¶æ€å¼€å§‹ï¼Œè„‘ä¸­ç§‰æŒç€ Swift çš„ç†å¿µé‡å†™ä½ çš„ä»£ç æ€»ä¼šæ¯”ä½ æŠŠ ObjC ä»£ç ç›´è¯‘è¿‡æ¥è¦å¥½ã€‚</p>
<p>æˆ‘æ²¡è¯´è¿‡è¿™æ˜¯ä»¶å®¹æ˜“çš„äº‹å„¿ã€‚å½“ä½ å·²ç»ä¹ æƒ¯äº†ç”¨ ObjC å†™ä»£ç ï¼Œç†Ÿæ‚‰äº†å®ƒçš„æ¨¡å¼å’Œå†™ä»£ç çš„æ–¹å¼çš„è¯ï¼Œåšå‡ºæ€ç»´ä¸Šçš„æ”¹å˜ä¼šéœ€è¦ä¸€äº›æ—¶é—´ã€‚ä½†æ˜¯è¿™ç»å¯¹æœ‰æ›´å¤šçš„å¥½å¤„ã€‚</p>
<hr>
<p>ä»¥ä¸Šå°±æ˜¯ Swift ç¼–ç¨‹æ€æƒ³ç³»åˆ—çš„æœ€åä¸€éƒ¨åˆ†å†…å®¹<sup>2</sup>ã€‚ç°åœ¨ä½ è¦å¼€å§‹ä¸ºæ–° Swift é¡¹ç›®å‘ç‹‚äº†ï¼ŒæŠŠ Swift ç¼–ç¨‹æ€æƒ³å…¨éƒ¨è´¯å½»åˆ°ä½ çš„è„‘æµ·ä¸­ã€‚</p>
<p>ç¥ç”¨ Swift ç¼–ç¨‹æ„‰å¿«ï¼Œå¹¶ä¸”â€¦<br><img src="/img/articles/thinking-in-swift-4/map-all-the-things.jpg1445562507.5226758" alt="MAP ä¸€åˆ‡ï¼ŒFLATMAP ä¸€åˆ‡ï¼"></p>
<hr>
<ol>
<li>Lines of Codesï¼ŒæŒ‡æœ‰å¤šå°‘è¡Œä»£ç </li>
<li>æˆ‘ä¼šé©¬ä¸Šå‘å¸ƒä¸€ä¸ªæ”¶å°¾æ–‡ç« ï¼Œç•™ä¸€ä¸ªå…³äº<em>Monads</em>çš„å£é£ï¼Œå¹¶æŠŠè¿™ä¸ªç³»åˆ—çœŸæ­£å®Œç»“ã€‚åˆ«æ„ï¼Œä¹‹åè¿˜æœ‰å¾ˆå¤šå…³äº Swift çš„æ–‡ç« ä¼šé™†ç»­å‘å¸ƒã€‚</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/10/11/thinking-in-swift-4/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-11<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/97c49dfd1f9f/latest_articles">ray16897188</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.futantan.com">Prayer</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a></p>
</blockquote>
<p>ç³»åˆ—æ–‡ç« åœ°å€ï¼š</p>
<ul>
<li><a href="http://swift.gg/2015/09/29/thinking-in-swift-1/">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬ä¸€éƒ¨åˆ†ï¼šæ‹¯æ•‘å°é©¬</a></li>
<li><a href="http://swift.gg/2015/10/09/thinking-in-swift-2/">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼šæ•°ç»„çš„ Map æ–¹æ³•</a></li>
<li><a href="http://alisoftware.github.io/swift/2015/10/03/thinking-in-swift-3/">Swiftç¼–ç¨‹æ€æƒ³ç¬¬ä¸‰éƒ¨åˆ†ï¼šç»“æ„ä½“å’Œç±»</a></li>
</ul>
<p><a href="http://swift.gg/2015/10/09/thinking-in-swift-2/">åœ¨æœ¬ç³»åˆ—ä¹‹å‰çš„æ–‡ç« ä¸­</a>æˆ‘ä»¬å­¦åˆ°äº†å¦‚ä½•ä½¿ç”¨<code>map</code>å’Œ<code>flatMap</code>æ¥æ“ä½œæ•°ç»„(arrays)ã€‚ä»Šå¤©æˆ‘ä»¬ç»§ç»­ç ”ç©¶å¦‚ä½•å¯¹å¯é€‰ç±»å‹(Optionals)ä»¥åŠå¾ˆå¤šå…¶ä»–ç±»å‹ä½¿ç”¨<code>map</code>å’Œ<code>flatMap</code>ã€‚</p>]]>
    
    </summary>
    
      <category term="Crunchy Development" scheme="http://swiftggteam.github.io/tags/Crunchy-Development/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[é›†åˆè§†å›¾é‡æ’æ•™ç¨‹]]></title>
    <link href="http://swiftggteam.github.io/2015/10/21/reordering-collection-view-cells-tutorial/"/>
    <id>http://swiftggteam.github.io/2015/10/21/reordering-collection-view-cells-tutorial/</id>
    <published>2015-10-21T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šioscreatorï¼Œ<a href="http://www.ioscreator.com/tutorials/reordering-collection-view-cells-tutorial" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-17<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="external">pmst</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.dianqk.org/" target="_blank" rel="external">é›é’K</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="external">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>iOS 9 ä»‹ç»äº† Collection View å•å…ƒæ ¼çš„é‡æ–°æ’åºæ–°ç‰¹æ€§ã€‚è¯¥ç‰¹æ€§é»˜è®¤å¼€å¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡é•¿æŒ‰å•å…ƒæ ¼çš„è¿›è¡Œé‡æ–°æ’åºï¼Œè°ƒæ•´å…¶åœ¨è§†å›¾ä¸­çš„ä½ç½®ã€‚è€Œæˆ‘ä»¬è¦åšçš„ä»…ä»…åªæ˜¯æ›´æ–°æ•°æ®æºæ¨¡å‹ã€‚æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸€äº›åŒ…å«å­—æ¯çš„å•å…ƒæ ¼å¹¶å¯¹å…¶è¿›è¡Œé‡æ–°æ’åºã€‚æœ¬æ•™ç¨‹éƒ¨ç½²äº iOS 9 å’Œ Xcode 7ã€‚</p>
<a id="more"></a>
<p>æ‰“å¼€ Xcode å¹¶åˆ›å»ºä¸€ä¸ª<strong>Single View Application</strong> ï¼›Product Name ä¸º <strong>IOS9ReorderingCollectionViewTutorial</strong> ï¼›ç´§æ¥ç€åœ¨ Organization Name å’Œ Organization Identidier ä¸¤ä¸ªè¾“å…¥æ¡†ä¸­å¡«å†™ä½ æƒ¯ç”¨çš„ä¿¡æ¯ï¼›å¼€å‘è¯­è¨€é€‰ <strong>Swift</strong> åŒæ—¶ç¡®ä¿è®¾å¤‡ä¸º <strong>iPhone</strong> ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=1500w1445389581.348031" alt=""></p>
<p>é€‰ä¸­ Main.StoryBoard æ–‡ä»¶ï¼Œåˆ é™¤å·²æœ‰çš„è§†å›¾æ§åˆ¶å™¨ï¼›ä»å¯¹è±¡åº“ä¸­ï¼ˆè¯‘è€…æ³¨ï¼šObject Library ï¼Œå¿«æ·é”® control+option+command+3 ï¼‰æ‹–æ‹½ä¸€ä¸ª CollectionView Controller åˆ° Storyboard ä¸­ï¼›é€‰ä¸­æ‹–å…¥çš„è§†å›¾æ§åˆ¶å™¨ï¼Œåœ¨ Xcode ä¸Šæ–¹èœå•æ ä¾æ¬¡é€‰æ‹©<code>Editor -&gt; Embed in -&gt; Navagation Controller</code>æ’å…¥ä¸€ä¸ª Navigation Controller ï¼›ç¡®ä¿é€‰ä¸­æ–°æ’å…¥çš„å¯¼èˆªæ§åˆ¶å™¨åï¼Œæ‰“å¼€å±æ€§è®¾ç½®é¢æ¿ï¼ˆè¯‘è€…æ³¨ï¼šAttribute Inspector ,å¿«æ·é”® option+command+4 ï¼‰ï¼Œå‹¾é€‰ View Controller éƒ¨åˆ†ä¸­çš„<code>is Initial View Controller</code>å¤é€‰æ¡†ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389582.5906994" alt=""></p>
<p>åŒå‡» Collection View Controller ä¸­çš„å¯¼èˆªæ ï¼Œå°†æ ‡é¢˜æ”¹ä¸ºâ€œAlphabetâ€ã€‚é€‰ä¸­ Collection View åæ‰“å¼€å°ºå¯¸è®¾ç½®é¢æ¿ä¸­ï¼ˆè¯‘è€…ï¼šSize Inspector ï¼Œå¿«æ·é”® option+command+5 ï¼‰ã€‚å°† Collection View éƒ¨åˆ†ä¸­çš„å®½é«˜è®¾ç½®ä¸º 100 ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389583.365586" alt=""></p>
<p>é€‰ä¸­ Collection View Controller ä¸­çš„å•å…ƒæ ¼ï¼Œå‰å¾€å±æ€§è®¾ç½®é¢æ¿ï¼ˆè¯‘è€…æ³¨ï¼šAttributes inspector ï¼Œå¿«æ·é”® option+command+4 ï¼‰ï¼Œå°†å•å…ƒæ ¼çš„èƒŒæ™¯è‰²è®¾ä¸ºç»¿è‰²ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389583.9036288" alt=""></p>
<p>å‰å¾€å±æ€§è®¾ç½®é¢æ¿ï¼Œå°† Collection Reusable View éƒ¨åˆ†ä¸­çš„ Identifier è®¾ä¸ºâ€œCellâ€</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389584.315881" alt=""></p>
<p>ä»å¯¹è±¡åº“ä¸­æ‹–æ‹½ä¸€ä¸ª Label æ”¾ç½®åˆ°å•å…ƒæ ¼ä¸­ã€‚åŒå‡»è¯¥ Label ï¼Œè¾“å…¥å­—æ¯â€œAâ€ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œstoryboard å†…å®¹å¦‚ä¸‹:</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/CellSize.pngformat=2500w1445389584.655853" alt=""></p>
<p>æ—¢ç„¶æˆ‘ä»¬å·²ç»å°†è§†å›¾æ§åˆ¶å™¨ä» Storyboard ä¸­ç§»é™¤äº†ï¼Œé‚£ä¹ˆ ViewController.swift æ–‡ä»¶ä¸€å¹¶åˆ é™¤äº†å§ã€‚æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶åˆ°é¡¹ç›®ä¸­ï¼Œé€‰æ‹© File -&gt; New File -&gt; iOS -&gt; Source -&gt; Cocoa Touch Class ç‚¹å‡» Next è·³è½¬ä¸‹ä¸€æ­¥ï¼Œä¸ºè¿™ä¸ªç±»å‘½å<strong>AlphabetViewController</strong> ï¼Œè®¾ä¸º UICollectionViewController çš„å­ç±»ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=1500w1445389586.0430875" alt=""></p>
<p>æ¥ä¸‹æ¥ï¼Œä¸º Collection View Cell åˆ›å»ºä¸€ä¸ªç±»ã€‚æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶åˆ°é¡¹ç›®ä¸­ï¼Œé€‰æ‹© File -&gt; New File -&gt; iOS -&gt; Source -&gt; Cocoa Touch Class ç‚¹å‡» Next è·³è½¬ä¸‹ä¸€æ­¥ï¼Œä¸ºè¿™ä¸ªç±»å‘½å <strong>AlphabetCell</strong> ï¼Œè®¾ä¸º UICollectionViewCell çš„å­ç±»ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=1500w1445389586.6271925" alt=""></p>
<p>è¿™äº›æ–°åˆ›å»ºçš„ç±»éœ€è¦å’Œ storyboard ä¸­çš„å¯¹è±¡å…³è”èµ·æ¥ã€‚ä¸ºæ­¤ï¼Œè¯·é€‰ä¸­ Storyboard ä¸­çš„ Collection View Controller ï¼Œåˆ‡æ¢åˆ° Identity Inspector é¢æ¿ï¼ˆè¯‘è€…æ³¨ï¼šå¿«æ·é”® option+command+3 ï¼‰ï¼Œæ›´æ”¹è‡ªå®šä¹‰ç±»ä¸º AlphabetViewController ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389587.3706524" alt=""></p>
<p>ä¾è‘«èŠ¦ç”»ç“¢ï¼Œé€‰ä¸­ Storyboard ä¸­çš„ Collection View Cell å¹¶è½¬åˆ° Identity Inspector é¢æ¿ï¼Œæ›´æ”¹è‡ªå®šä¹‰ç±»ä¸º AlphabetCell ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389587.6798098" alt=""></p>
<p>ç‚¹å‡» Assistant Editor æŒ‰é’®ï¼ˆè¯‘è€…æ³¨ï¼šå¿«æ·é”® option+command+enter ï¼‰ï¼Œç¡®ä¿ <strong>AlphabetCell.swift</strong> æ–‡ä»¶å‘ˆç°åœ¨å³ä¾§é¢æ¿ã€‚é€‰ä¸­å•å…ƒ Cell ä¸­çš„ Label ,æŒ‰ä½ Ctrl é”®æ‹–çº¿è‡³ <strong>AlphabetCell</strong> ç±»ä¸­åˆ›å»ºä»¥ä¸‹ Outlet æ¥å£:</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=750w1445389588.152526" alt=""></p>
<p>å‰å¾€ <strong>AlphabetViewController.swift</strong> æ–‡ä»¶ï¼Œåœ¨ viewDidLoad æ–¹æ³•ä¸­ï¼Œåˆ é™¤ä»¥ä¸‹è¡Œ:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.collectionView!.registerClass(<span class="type">UICollectionViewCell</span>.<span class="keyword">self</span>, forCellWithReuseIdentifier: reuseIdentifier)</span><br></pre></td></tr></table></figure>
<p>ç”±äºæ—©å‰å·²åœ¨è§†å›¾æ„å»ºå™¨ä¸­è®¾ç½®äº†é‡ç”¨æ ‡è¯†ç¬¦ï¼Œå› æ­¤è¿™é‡Œä¸å†éœ€è¦ã€‚æ­¤å¤–æ–°å¢ä¸€ä¸ªå±æ€§å˜é‡ç”¨äºå­˜å‚¨å­—æ¯è¡¨ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> characterArray = [<span class="type">String</span>]()</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<strong>viewDidLoad</strong>æ–¹æ³•ä¸­çš„å†…å®¹:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> str:<span class="type">String</span> = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="comment">//åŸæ–‡æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯X ä¸çŸ¥é“æ˜¯ä¸æ˜¯ä½œè€…ç¬”è¯¯</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str.characters&#123;</span><br><span class="line">        characterArray.append(<span class="type">String</span>(i))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æ–¹æ³•ä¸­å°†å­—æ¯è¡¨ä¸­çš„æ¯ä¸ªå•è¯éƒ½åˆ†é…åˆ° characterArray æ•°ç»„å½“ä¸­ã€‚æ¥ç€ï¼Œæ›´æ”¹ä»¥ä¸‹ä¸‰ä¸ªé¢„å®šä¹‰çš„ Collection View ä»£ç†æ–¹æ³•ä¸­çš„å†…å®¹:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">numberOfSectionsInCollectionView</span><span class="params">(collectionView: UICollectionView)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">      <span class="comment">// 1</span></span><br><span class="line">      <span class="comment">// Return the number of sections</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(collectionView: UICollectionView, numberOfItemsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">      <span class="comment">// 2 Return the number of items in the section</span></span><br><span class="line">      <span class="keyword">return</span> characterArray.<span class="built_in">count</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UICollectionViewCell</span> &#123;</span><br><span class="line">      <span class="comment">// 3</span></span><br><span class="line">      <span class="keyword">let</span> cell = collectionView.dequeueReusableCellWithReuseIdentifier(<span class="string">"Cell"</span>, forIndexPath: indexPath) <span class="keyword">as</span>! <span class="type">AlphabetCell</span></span><br><span class="line">  </span><br><span class="line">      <span class="comment">// Configure the cell</span></span><br><span class="line">      cell.alphabetLabel.text = characterArray[indexPath.row]</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">return</span> cell</span><br><span class="line">  &#125;</span><br><span class="line">```   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. <span class="type">Collection</span> <span class="type">View</span> ä»…åŒ…å«ä¸€ä¸ª section</span><br><span class="line"><span class="number">2</span>. <span class="type">Collection</span> <span class="type">View</span> ä¸­çš„æ¯ä¸ª section åŒ…å« <span class="number">26</span> ä¸ª item</span><br><span class="line"><span class="number">3</span>. æ¯ä¸€ä¸ª <span class="type">Cell</span> å•å…ƒæ ¼çš„å†…å®¹ä¸ºå­—æ¯è¡¨ä¸­çš„ä¸€ä¸ªå­—æ¯ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å½“é‡æ–°è°ƒæ•´å•å…ƒæ ¼ä½ç½®æ—¶ï¼Œå†…å®¹ä¹Ÿè¦éšä¹‹è€Œæ”¹å˜ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ **<span class="type">CollectionView</span>:moveItemAtIndexPath:toIndexPath** æ–¹æ³•ä¸­å®ç°ã€‚</span><br><span class="line"></span><br><span class="line">```swift</span><br><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(collectionView: UICollectionView, moveItemAtIndexPath sourceIndexPath: NSIndexPath,toIndexPath destinationIndexPath: NSIndexPath)</span></span> &#123;</span><br><span class="line">        <span class="comment">// swap values if sorce and destination</span></span><br><span class="line">        <span class="keyword">let</span> temp = characterArray[sourceIndexPath.row]</span><br><span class="line">        characterArray[sourceIndexPath.row] = characterArray[destinationIndexPath.row]</span><br><span class="line">        characterArray[destinationIndexPath.row] = temp</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ ¡å¯¹æ³¨ï¼šè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ƒç»„çš„ç‰¹æ€§å®Œæˆå€¼çš„äº¤æ¢<code>(characterArray[sourceIndexPath.row], characterArray[destinationIndexPath.row]) = (characterArray[destinationIndexPath.row], characterArray[sourceIndexPath.row])</code></p>
</blockquote>
<p>æ„å»ºå¹¶è¿è¡Œé¡¹ç›®ï¼Œé•¿æŒ‰æŸä¸ªå•å…ƒæ ¼åæ‹–åŠ¨è°ƒæ•´å®ƒçš„ä½ç½®ã€‚</p>
<p><img src="/img/articles/reordering-collection-view-cells-tutorial/format=1500w1445389588.5267599" alt=""></p>
<p>ä½ å¯ä»¥ä»<a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">github</a>ä¸Šä¸‹è½½ IOS9ReorderingCollectionViewTutorial çš„æºä»£ç ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šioscreatorï¼Œ<a href="http://www.ioscreator.com/tutorials/reordering-collection-view-cells-tutorial">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-17<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles">pmst</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.dianqk.org/">é›é’K</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>iOS 9 ä»‹ç»äº† Collection View å•å…ƒæ ¼çš„é‡æ–°æ’åºæ–°ç‰¹æ€§ã€‚è¯¥ç‰¹æ€§é»˜è®¤å¼€å¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡é•¿æŒ‰å•å…ƒæ ¼çš„è¿›è¡Œé‡æ–°æ’åºï¼Œè°ƒæ•´å…¶åœ¨è§†å›¾ä¸­çš„ä½ç½®ã€‚è€Œæˆ‘ä»¬è¦åšçš„ä»…ä»…åªæ˜¯æ›´æ–°æ•°æ®æºæ¨¡å‹ã€‚æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸€äº›åŒ…å«å­—æ¯çš„å•å…ƒæ ¼å¹¶å¯¹å…¶è¿›è¡Œé‡æ–°æ’åºã€‚æœ¬æ•™ç¨‹éƒ¨ç½²äº iOS 9 å’Œ Xcode 7ã€‚</p>]]>
    
    </summary>
    
      <category term="ioscreator" scheme="http://swiftggteam.github.io/tags/ioscreator/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Swiftç¼–ç¨‹æ€æƒ³ç¬¬ä¸‰éƒ¨åˆ†ï¼šç»“æ„ä½“å’Œç±»]]></title>
    <link href="http://swiftggteam.github.io/2015/10/20/thinking-in-swift-3/"/>
    <id>http://swiftggteam.github.io/2015/10/20/thinking-in-swift-3/</id>
    <published>2015-10-20T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/10/03/thinking-in-swift-3/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-03<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/97c49dfd1f9f/latest_articles" target="_blank" rel="external">ray16897188</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="external">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
</blockquote>
<p>ç³»åˆ—æ–‡ç« åœ°å€ï¼š</p>
<ul>
<li><a href="http://swift.gg/2015/09/29/thinking-in-swift-1/" target="_blank" rel="external">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬ä¸€éƒ¨åˆ†ï¼šæ‹¯æ•‘å°é©¬</a></li>
<li><a href="http://swift.gg/2015/10/09/thinking-in-swift-2/" target="_blank" rel="external">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼šæ•°ç»„çš„ Map æ–¹æ³•</a></li>
</ul>
<p>ç»§ç»­è¯´å’±çš„â€Swiftç¼–ç¨‹æ€æƒ³ç³»åˆ—â€ï¼Œä»Šå¤©æˆ‘ä»¬å°†ä¼šåšä¸€äº›å°å°çš„æ”¹åŠ¨ï¼Œä½¿ç”¨ <code>structï¼ˆç»“æ„ä½“ï¼‰</code> æ¥ä½¿ä»£ç å¾—åˆ°è¿›ä¸€æ­¥çš„ç®€åŒ–ã€‚</p>
<a id="more"></a>
<h3 id="å‰é¢çš„å†…å®¹">å‰é¢çš„å†…å®¹</h3><p>åœ¨<a href="http://alisoftware.github.io/swift/2015/09/20/thinking-in-swift-2/" target="_blank" rel="external">è¿™ä¸ªç³»åˆ—ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« é‡Œ</a>æˆ‘ä»¬å­¦åˆ°äº†å¯¹æ•°ç»„(arrays)ä½¿ç”¨ <code>map</code> å’Œ <code>flatMap</code>ï¼Œæ¶ˆé™¤äº†ä¸­é—´å˜é‡(intermediate variables)å½¢å¼çš„çŠ¶æ€æ€§(statefulness)ï¼Œå¹¶ä½¿ç”¨äº†ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹<sup>1<sup>ã€‚</sup></sup></p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬ä¹‹å‰æ”¶å·¥æ—¶çš„ä»£ç ï¼Œè´´åœ¨è¿™é‡Œå›é¡¾ä¸€ä¸‹ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> icon: <span class="type">UIImage</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">var</span> url: <span class="type">NSURL</span>!</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="func"><span class="keyword">func</span> <span class="title">listItemsFromJSONData</span><span class="params">(jsonData: NSData?)</span></span> -&gt; [<span class="type">ListItem</span>] &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> nonNilJsonData = jsonData,</span><br><span class="line">            <span class="keyword">let</span> json = <span class="keyword">try</span>? <span class="type">NSJSONSerialization</span>.<span class="type">JSONObjectWithData</span>(nonNilJsonData, options: []),</span><br><span class="line">            <span class="keyword">let</span> jsonItems = json <span class="keyword">as</span>? <span class="type">Array</span>&lt;<span class="type">NSDictionary</span>&gt;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> []</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> jsonItems.flatMap &#123; (itemDesc: <span class="type">NSDictionary</span>) -&gt; <span class="type">ListItem</span>? <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> title = itemDesc[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">                <span class="keyword">let</span> urlString = itemDesc[<span class="string">"url"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">                <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: urlString)</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">            <span class="keyword">let</span> li = <span class="type">ListItem</span>()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> icon = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">                li.icon = <span class="type">UIImage</span>(named: icon)</span><br><span class="line">            &#125;</span><br><span class="line">            li.title = title</span><br><span class="line">            li.url = url</span><br><span class="line">            <span class="keyword">return</span> li</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä»Šå¤©æˆ‘ä»¬å°†å¯¹ä¾‹å­è¿›è¡Œç›¸å½“ç®€å•çš„æ”¹åŠ¨ï¼Œä½¿å¾—ä»£ç æ›´åŠ ç²¾ç®€ä»¥åŠæ˜¾å¾—â€é›¨ç‡•é£â€(Swift-er)ã€‚</p>
<h3 id="Structç›¸æ¯”Class">Structç›¸æ¯”Class</h3><p>æ­£å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œé¦–å…ˆè€ƒè™‘ä½¿ç”¨ç±»(<code>class</code>)æ˜¯Swiftåˆå­¦è€…ç»å¸¸çŠ¯çš„ä¸€ä¸ªé”™è¯¯ã€‚ä¸è¿‡è¿™å¯ä»¥ç†è§£ï¼Œå› ä¸ºåœ¨ObjCä¸­æˆ‘ä»¬æ»¡ä¸–ç•Œçš„ç”¨classã€‚</p>
<p>ä½¿ç”¨<code>class</code>ä¸æ˜¯ä»€ä¹ˆåŸåˆ™æ€§é”™è¯¯ã€‚åœ¨Swiftä¸­å½“ç„¶ä¹Ÿå¯ä»¥ç»§ç»­ç”¨ã€‚ä½†æ˜¯<code>Swift</code>çš„ç»“æ„ä½“(<code>struct</code>)æ¯”å®ƒ C å‰èº«çš„ç»“æ„ä½“è¦å¼ºå¤§å¾ˆå¤šï¼šå®ƒä»¬ä¸å†åªæ˜¯å­˜å‚¨ä¸€ç³»åˆ—çš„å€¼ã€‚</p>
<p>Swiftçš„ç»“æ„ä½“(<code>structs</code>)å’Œç±»(<code>Class</code>)å…·æœ‰ç›¸åŒçš„åŠŸèƒ½ - é™¤äº†ç»§æ‰¿ - ç»“æ„ä½“æ˜¯<strong>å€¼ç±»å‹(value-types)</strong> (æ‰€ä»¥æ¯ä¸€æ¬¡å˜é‡èµ‹å€¼éƒ½æ˜¯é€šè¿‡å€¼æ‹·è´çš„å½¢å¼ï¼Œä¸<code>Int</code>ç±»å‹å¾ˆç›¸åƒ)ï¼Œè€Œç±»å±äº<strong>å¼•ç”¨ç±»å‹(reference-types)</strong>ï¼Œä»¥å¼•ç”¨æ–¹å¼ä¼ é€’è€Œéå€¼æ‹·è´ï¼Œè¿™å’ŒObjective-C(ä»¥åŠOCä¸­æ— å¤„ä¸åœ¨çš„éš¾çœ‹çš„<code>*</code>ï¼Œä¹Ÿä»£è¡¨ç€å¼•ç”¨)ä¸­ä¸€æ ·ã€‚</p>
<p>æˆ‘ä¸ä¼šåœ¨è¿™é‡Œå±•å¼€é•¿ç¯‡è®ºè¿°ï¼Œè®¨è®ºç»“æ„ä½“ã€å€¼ç±»å‹å’Œç±»ã€å¼•ç”¨ç±»å‹ç›¸æ¯”è¾ƒå­°èƒœå­°åŠ£ï¼šæˆ‘è¿˜æ˜¯ç›´æ¥å¼ºçƒˆå»ºè®®ä½ çœ‹ä¸€ä¸‹<a href="https://realm.io/news/andy-matuschak-controlling-complexity/" target="_blank" rel="external">Andy Matuschakå¯¹æ­¤è¯é¢˜çš„ç²¾å½©è®ºè¿°</a>ã€‚æˆ‘ä¸éœ€è¦è‡ªå·±å†è§£é‡Šäº†ï¼ŒAndyè¯´çš„æ¯”æˆ‘å¥½ã€‚</p>
<h3 id="æŠŠæˆ‘ä»¬çš„classè½¬æ¢æˆstruct">æŠŠæˆ‘ä»¬çš„classè½¬æ¢æˆstruct</h3><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“çœ‹èµ·æ¥æ›´ä¸ºåˆé€‚ï¼Œå› ä¸ºå®ƒä¿å­˜äº†ä¸€äº›å€¼ï¼Œå¹¶ä¸”å¹¶ä¸ä¼šè¦å¯¹å®ƒä»¬åšä»€ä¹ˆæ”¹å˜(æ›´é€‚åˆæ‹·è´è€Œéå¼•ç”¨)ã€‚æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æŠŠå®ƒç”¨ä½œä¸€ä¸ªèœå•æ çš„æ•°æ®æºï¼Œä¸€æ—¦åˆ›å»ºå°±ä¸å†å¯¹å…¶æ›´æ”¹ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä½¿ç”¨ç»“æ„ä½“æ›´ä¸ºåˆç†çš„ä¸€ä¸ªåœºæ™¯ã€‚</p>
<p>è¿˜æœ‰ï¼Œè¿™é‡ŒæŠŠ<code>class</code>è¿ç§»æˆ<code>struct</code>çš„å¦ä¸€ä¸ªä¼˜åŠ¿æ˜¯ï¼Œå¦‚æœ<code>struct</code>æ²¡æœ‰å®šä¹‰é€‚åˆä¸€ä¸ªæ„é€ å™¨ï¼Œåˆ™å®ƒä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„éšå¼æ„é€ å™¨ï¼šæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éå¸¸å®¹æ˜“çš„ç”¨é»˜è®¤æ„é€ å™¨<code>ListItem(icon: â€¦, title: â€¦, url: â€¦)</code>å»åˆ›å»ºä¸€ä¸ª<code>ListItem</code>ã€‚</p>
<p>æœ€åä¸€é¡¹è¦ç‚¹æ˜¯ï¼Œç”±äºåœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æˆ‘ä»¬æ¶ˆé™¤äº†æ•°æ®æŸåçš„é—®é¢˜ï¼Œæœ‰é—®é¢˜çš„<code>ListItem</code>å°±ä¸ä¼šè¢«åˆ›å»ºå‡ºæ¥äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ<code>title</code>çš„é»˜è®¤å€¼<code>&quot;&quot;</code>æ¶ˆé™¤æ‰ï¼Œä½†æ›´é‡è¦çš„æ˜¯æˆ‘ä»¬å°±èƒ½æŠŠ<code>NSURL!</code>è½¬æ¢æˆ<code>NSURL!</code>å»<strong><a href="http://alisoftware.github.io/swift/2015/09/06/thinking-in-swift-1/" target="_blank" rel="external">æ‹¯æ•‘æœ€åä¸€åŒ¹å°é©¬</a></strong>ğŸ´<sup>2<sup>ã€‚</sup></sup></p>
<p>è½¬æ¢ä¹‹åçš„ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> icon: <span class="type">UIImage</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> url: <span class="type">NSURL</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="func"><span class="keyword">func</span> <span class="title">listItemsFromJSONData</span><span class="params">(jsonData: NSData?)</span></span> -&gt; [<span class="type">ListItem</span>] &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> nonNilJsonData = jsonData,</span><br><span class="line">            <span class="keyword">let</span> json = <span class="keyword">try</span>? <span class="type">NSJSONSerialization</span>.<span class="type">JSONObjectWithData</span>(nonNilJsonData, options: []),</span><br><span class="line">            <span class="keyword">let</span> jsonItems = json <span class="keyword">as</span>? <span class="type">Array</span>&lt;<span class="type">NSDictionary</span>&gt; <span class="keyword">else</span> &#123; <span class="keyword">return</span> [] &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> jsonItems.flatMap &#123; (itemDesc: <span class="type">NSDictionary</span>) -&gt; <span class="type">ListItem</span>? <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> title = itemDesc[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">                <span class="keyword">let</span> urlString = itemDesc[<span class="string">"url"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">                <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: urlString)</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">            <span class="keyword">let</span> iconName = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line">            <span class="keyword">let</span> icon = <span class="type">UIImage</span>(named: iconName ?? <span class="string">""</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="type">ListItem</span>(icon: icon, title: title, url: url)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç°åœ¨å½“ä¸€åˆ‡éƒ½å°±ç»ªä¹‹åï¼Œæˆ‘ä»¬åªåœ¨æœ€åä¸€æ­¥åˆ›å»ºæ‰åˆ›å»ºå‡º<code>ListItem</code>å®ä¾‹ï¼Œå¦‚æœä½ ä¸æä¾›ä»»ä½•<code>init</code>æ–¹æ³•çš„è¯<code>struct</code>ä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„<code>init</code>æ–¹æ³•ä¸ºå®ƒè‡ªå·±çš„å‚æ•°æ®µä¼ å€¼ã€‚ç”¨<code>class</code>çš„ç‰ˆæœ¬å¯ä»¥åšç›¸åŒçš„äº‹ï¼Œä½†æ˜¯ç”¨<code>class</code>çš„è¯æˆ‘ä»¬å¾—è‡ªå·±å£°æ˜<code>init</code>ã€‚</p>
<h3 id="è”åˆæ“ä½œç¬¦(Coalescing_operator)">è”åˆæ“ä½œç¬¦(Coalescing operator)</h3><p>ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘è¿˜ç”¨äº†ä¸€ä¸ªæ–°çš„å°æŠ€å·§ï¼Œä½¿ç”¨<code>??</code>æ“ä½œç¬¦è®©<code>iconName</code>åœ¨æ˜¯<code>nil</code>çš„æ—¶å€™ç»™å‡ºä¸€ä¸ªé»˜è®¤å€¼ã€‚</p>
<p><code>??</code>æ“ä½œç¬¦å’ŒObjCçš„<code>opt ?: val</code>è¡¨è¾¾å¼å¾ˆåƒï¼Œäº†è§£å®ƒçš„äººéƒ½çŸ¥é“ï¼š<code>opt ?? val</code>å¦‚æœåœ¨<code>opt</code>éç©ºçš„æ—¶å€™è¿”å›å®ƒçš„å€¼ï¼Œå¦‚æœæ˜¯<code>nil</code>çš„è¯ä¼šè¿”å›<code>val</code>ã€‚è¿™æ„å‘³ç€å¦‚æœ<code>opt</code>æ˜¯<code>T?</code>ç±»å‹ï¼Œ<code>val</code>åˆ™å¿…é¡»æ˜¯<code>T</code>ç±»å‹ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœä¹Ÿä¼šæ˜¯<code>T</code>ç±»å‹ã€‚</p>
<p>é‚£ä¹ˆè¿™é‡Œçš„<code>iconName ?? &quot;&quot;</code>ä¼šå…è®¸æˆ‘ä»¬åœ¨<code>iconName</code>ä¸º<code>nil</code>çš„æ—¶å€™ä½¿ç”¨ä¸€ä¸ªç©ºå­—ç¬¦<code>&quot;&quot;</code>çš„å›¾ç‰‡åç§°ï¼Œäºæ˜¯è¿™é‡Œä¼šæœ‰ä¸€ä¸ª<code>nil</code>çš„<code>UIImage</code>ï¼Œå¹¶ä¸”<code>icon</code>ä¹Ÿä¼šæ˜¯<code>nil</code>ã€‚</p>
<p>âš ï¸æ³¨æ„âš ï¸ï¼šå°†ä¸€ä¸ªä¸º<code>nil</code>çš„<code>iconName</code>å’Œä¸€ä¸ª<code>nil</code>çš„<code>UIImage</code>ä½œä¸ºç»“æœæ¥å¤„ç†ï¼Œè¿™å¹¶<strong>ä¸æ˜¯</strong>æœ€ä½³çš„ã€æœ€ç®€æ´çš„åšæ³•ã€‚å®é™…ä¸Šä½¿ç”¨ä¸€ä¸ªå‡çš„<code>&quot;&quot;</code>åå­—æ¥è·å¾—ä¸€ä¸ªç©ºå›¾ç‰‡çœ‹èµ·æ¥æœ‰ç‚¹å„¿éš¾çœ‹ï¼Œè¿˜æœ‰ç‚¹å„¿æ¬ºéª—çš„æ„å‘³ã€‚ä½†æ˜¯è¿™æ˜¯ç»™ä½ å±•ç¤º<code>??</code>æ“ä½œç¬¦å­˜åœ¨æ„Ÿçš„ä¸€ä¸ªåœºåˆâ€¦å˜¿ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸ºæœ¬ç³»åˆ—æ–‡ç« çš„ä¸‹ä¸€ç¯‡ä¿ç•™ä¸€äº›å¥½ä¸œè¥¿å§(å‰§é€ï¼šåˆæ¶‰åŠåˆ°äº†<code>flatMap</code>)ã€‚</p>
<h3 id="ç»“è®º">ç»“è®º</h3><p>ä»Šå¤©å°±åˆ°è¿™é‡Œäº†ã€‚</p>
<p>åœ¨ç¬¬3éƒ¨åˆ†ä¸­æˆ‘ä»¬æ²¡åšå¤ªå¤šäº‹æƒ…ï¼Œä»…ä»…å°±æ˜¯æŠŠ<code>class</code>æ¢æˆäº†<code>struct</code>ã€‚æˆ‘ç”šè‡³æ²¡è®²å“ªæ€•ä¸€ç‚¹å„¿å…³äºä¸¤è€…ä¹‹é—´çš„åŒºåˆ«(ç„¶è€Œå³ä½¿æˆ‘æœ€è¿‘ç‰¹åˆ«å¿™ï¼Œæœ‰æ®µæ—¶é—´æ²¡åœ¨blogä¸Šå‘ä¸œè¥¿äº†ï¼Œæˆ‘è¿˜æ˜¯ä¸æƒ³ä½ ä¸ºæ–°æ–‡ç« ç­‰å¾…å¤ªä¹…)ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆä¸¢å¼ƒæ‰<code>NSURL!</code>ï¼Œå°†æœ€åä¸€åŒ¹å°é©¬æ‹¯æ•‘ğŸ‰ã€‚åœ¨æˆ‘ä¸‹ä¸€ç¯‡æ–‡ç« å‘å¸ƒå‡ºæ¥å‰ï¼Œçœ‹ä¸€ä¸‹<a href="https://realm.io/news/andy-matuschak-controlling-complexity/" target="_blank" rel="external">Andyå…³äºã€Šå’Œå€¼ç±»å‹äº¤æœ‹å‹ã€‹çš„è¶…æ£’è®¨è®º</a>ï¼Œä½ è¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿è¦å»å­¦çš„ã€‚</p>
<p>æˆ‘æ‰¿è¯ºåœ¨å‘å¸ƒç¬¬4éƒ¨åˆ†ä¹‹å‰ä¸ä¼šè®©ä½ ç­‰å¤ªä¹…ï¼Œç¬¬4éƒ¨åˆ†åˆæ¶‰åŠåˆ°<code>map</code>å’Œ<code>flatMap</code>ï¼Œä½†è¿™ä¸€æ¬¡æ˜¯åŸºäº<code>Optionals</code>ã€‚</p>
<hr>
<ol>
<li><p>æ²¡é”™ï¼Œä¸Šç¯‡æ–‡ç« ä¸­ä½ ç¡®å®åšäº†ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹â€¦ä½ è‡ªå·±å¯èƒ½ç”šè‡³éƒ½æ²¡æœ‰æ„è¯†åˆ°ã€‚</p>
</li>
<li><p><code>NSURL!</code>ä¸€ç›´çº ç¼ æˆ‘åˆ°ç°åœ¨å·²ç»æœ‰æ®µæ—¶é—´äº†ï¼Œå…¶å®æˆ‘å°±æ˜¯å¤ªæ‡’äº†ï¼Œæ²¡å»ä¸º<code>ListItem</code>ç±»å†™ä¸€ä¸ªæ­£ç¡®çš„<code>init</code>æ–¹æ³•ã€‚å› ä¸ºçŸ¥é“æˆ‘è¿Ÿæ—©ä¼šæŠŠå®ƒå¼„æ‰ï¼Œæ‰€ä»¥å¤„ç†å®ƒä¹‹å‰æˆ‘æ²¡æƒ³æ”¶æ‹¾é‚£æ®µä»£ç æ ·æœ¬ã€‚æˆ‘ä»¬æ‹¯æ•‘æœ€åä¸€åŒ¹å°é©¬ä»…ä»…æ˜¯æ—¶é—´é—®é¢˜ã€‚</p>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/10/03/thinking-in-swift-3/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-10-03<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/97c49dfd1f9f/latest_articles">ray16897188</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
</blockquote>
<p>ç³»åˆ—æ–‡ç« åœ°å€ï¼š</p>
<ul>
<li><a href="http://swift.gg/2015/09/29/thinking-in-swift-1/">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬ä¸€éƒ¨åˆ†ï¼šæ‹¯æ•‘å°é©¬</a></li>
<li><a href="http://swift.gg/2015/10/09/thinking-in-swift-2/">Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼šæ•°ç»„çš„ Map æ–¹æ³•</a></li>
</ul>
<p>ç»§ç»­è¯´å’±çš„â€Swiftç¼–ç¨‹æ€æƒ³ç³»åˆ—â€ï¼Œä»Šå¤©æˆ‘ä»¬å°†ä¼šåšä¸€äº›å°å°çš„æ”¹åŠ¨ï¼Œä½¿ç”¨ <code>structï¼ˆç»“æ„ä½“ï¼‰</code> æ¥ä½¿ä»£ç å¾—åˆ°è¿›ä¸€æ­¥çš„ç®€åŒ–ã€‚</p>]]>
    
    </summary>
    
      <category term="Crunchy Development" scheme="http://swiftggteam.github.io/tags/Crunchy-Development/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Friday Q&A 2015-09-04:è®©æˆ‘ä»¬æ¥è‡ªå®šä¹‰ dispatch_queue]]></title>
    <link href="http://swiftggteam.github.io/2015/10/19/friday-qa-2015-09-04-lets-build-dispatch_queue/"/>
    <id>http://swiftggteam.github.io/2015/10/19/friday-qa-2015-09-04-lets-build-dispatch_queue/</id>
    <published>2015-10-19T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šMike Ashï¼Œ<a href="https://www.mikeash.com/pyblog/friday-qa-2015-09-04-lets-build-dispatch_queue.html" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-04<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/yake_099" target="_blank" rel="external">Yake</a>ï¼›æ ¡å¯¹ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
<p>è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« çš„ä»£ç æ˜¯ç”¨ Objective-C å®Œæˆçš„ï¼Œä¸è¿‡ä¸å¦¨ç¢å¤§å®¶å­¦ä¹ å¤šçº¿ç¨‹ç¼–ç çš„çŸ¥è¯†ã€‚</p>
</blockquote>
<p><code>Grand Central Dispatch</code> æ˜¯è¿‡å»å‡ å¹´ä¸­è‹¹æœæ¨å‡ºè¿‡çš„è®¸å¤šå¾ˆæ£’çš„ API ä¸­çš„ä¸€å‘˜ã€‚åœ¨æœ€æ–°ä¸€æœŸçš„ â€œLetâ€™s Buildâ€ ç³»åˆ—ä¸­ï¼Œæˆ‘å‡†å¤‡å»æ¢ç´¢ dispatch_queue ä¸€äº›æœ€åŸºæœ¬ç‰¹æ€§çš„é‡æ–°å®ç°ï¼Œè¿™ä¸ªä¸»é¢˜çš„å»ºè®®æ¥è‡ª Rob Rixã€‚<br><a id="more"></a></p>
<h1 id="æ¦‚è¿°">æ¦‚è¿°</h1><p>ä¸€ä¸ªè°ƒåº¦é˜Ÿåˆ—ï¼ˆDispatch Queueï¼‰æ˜¯å­˜å‚¨åœ¨å…¨å±€çº¿ç¨‹æ± ä¸­çš„é˜Ÿåˆ—ä»»åŠ¡ã€‚é€šå¸¸ï¼Œæäº¤åˆ°é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ä¼šåœ¨åå°çº¿ç¨‹ä¸­å¼‚æ­¥åœ°æ‰§è¡Œã€‚æ‰€æœ‰çš„çº¿ç¨‹å…±ç”¨ä¸€ä¸ªåå°çº¿ç¨‹æ± ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿæ›´åŠ åœ°é«˜æ•ˆã€‚</p>
<p>æˆ‘å°†é‡æ–°å®ç° GCD ä¸­é‚£äº›å¿…è¦çš„ APIã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä¼šå¿½ç•¥æ‰ GCD æä¾›çš„è®¸å¤šæœ‰è¶£çš„ç‰¹æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå…¨å±€çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡éšç€éœ€è¦å¤„ç†çš„ä»»åŠ¡çš„æ•°é‡å¢å¤§æˆ–è€…å‡å°‘ï¼Œè¿™æ ·å¯ä»¥æé«˜ CPU çš„ä½¿ç”¨æ•ˆç‡ã€‚å¦‚æœä½ æœ‰ä¸€å †ä»»åŠ¡è®© CPU è´Ÿè½½å¾ˆé«˜ï¼Œè€Œä½ åˆæäº¤äº†å¦å¤–ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™æ—¶ GCD å°†ä¸ä¼šä¸ºè¿™ä¸ªä»»åŠ¡å†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚å› ä¸º CPU å·²ç»æ»¡è½½è¿è¡Œäº†ï¼Œæ›´å¤šçš„çº¿ç¨‹åªä¼šè®©æ€§èƒ½ä¸‹é™ã€‚æˆ‘ä¼šå¿½ç•¥è¿™äº›å®ç°å¹¶ä¸”ä½¿ç”¨ç¡¬ç¼–ç çš„å›ºå®šçº¿ç¨‹æ•°ã€‚æˆ‘ä¹Ÿä¼šè·³è¿‡å¦å¤–ä¸€äº›æœ‰è¶£çš„ç‰¹æ€§æ¯”å¦‚ç›®æ ‡é˜Ÿåˆ—ï¼ˆtarget queuesï¼‰ä»¥åŠå¹¶å‘é˜Ÿåˆ—ä¸­çš„å±éšœï¼ˆbarriers on concurrent queuesï¼‰ç­‰ç­‰ã€‚</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é‡å†™è°ƒåº¦é˜Ÿåˆ—çš„æ ¸å¿ƒç‰¹æ€§ï¼šä»–ä»¬å¯ä»¥æ˜¯ä¸²è¡Œçš„æˆ–è€…å¹¶å‘çš„ï¼Œä»–ä»¬å¯ä»¥åŒæ­¥åœ°æˆ–è€…å¼‚æ­¥åœ°è°ƒåº¦ä»»åŠ¡ï¼Œå¹¶ä¸”ä»–ä»¬ç”±ä¸€ä¸ªå…±äº«çš„å…¨å±€çº¿ç¨‹æ± æä¾›æ”¯æŒã€‚</p>
<h1 id="ä»£ç ">ä»£ç </h1><p>åƒå¾€å¸¸ä¸€æ ·ï¼Œè¿™ç¯‡æ–‡ç« ä¸­çš„ä»£ç å¯ä»¥åœ¨ Github ä¸Šè·å–ï¼š<a href="https://github.com/mikeash/MADispatchQueue" target="_blank" rel="external">ä»£ç </a></p>
<p>å¦‚æœä½ æƒ³è¾¹è¯»è¾¹è·Ÿè¿›ï¼Œæˆ–è€…æ˜¯è‡ªå·±è¿›è¡Œæ¢ç´¢ï¼Œä½ éƒ½å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä½ æƒ³è¦çš„ã€‚</p>
<h1 id="æ¥å£">æ¥å£</h1><p>GCD æ˜¯ä¸€ä¸ªåŸºäº C è¯­è¨€çš„ APIã€‚è™½ç„¶åœ¨æœ€è¿‘çš„ OS å‘å¸ƒç‰ˆæœ¬ä¸­ GCD å¯¹è±¡è¢«è½¬æ¢æˆäº† Objective-C å¯¹è±¡ï¼ŒAPI ä»ç„¶æ˜¯çº¯ C å®ç°çš„ï¼ˆåŠ ä¸Šè‹¹æœçš„ block æ‰©å±•ï¼‰ã€‚è¿™ç§å®ç°å¯¹äºä¸€ä¸ªåº•å±‚ API æ¥è¯´éå¸¸æ£’ï¼Œå¹¶ä¸” GCD å±•ç¤ºäº†ä¸€ç§éå¸¸ç®€æ´çš„æ¥å£ï¼Œä½†å¯¹æˆ‘çš„ç ”ç©¶æ¥è¯´ï¼Œæˆ‘æƒ³ç”¨ Objective-C é‡å†™è¿™äº›æ¥å£ã€‚</p>
<p>é‡æ–°å®ç°çš„ Objective-C ç±»å«åš â€œMADispatchQueueâ€ï¼Œå®ƒåªæœ‰å››ä¸ªæ–¹æ³•ï¼š</p>
<ol>
<li>è·å–ä¸€ä¸ªå…±äº«çš„å…¨å±€é˜Ÿåˆ—çš„æ–¹æ³•ã€‚GCD æœ‰è®¸å¤šä¸åŒä¼˜å…ˆçº§çš„å…¨å±€é˜Ÿåˆ—ï¼Œä½†æ˜¯ç®€å•èµ·è§æˆ‘ä»¬åªç”¨ä¸€ä¸ªã€‚</li>
<li>ä¸€ä¸ªå¯ä»¥åˆ›å»ºå¹¶å‘æˆ–è€…ä¸²è¡Œé˜Ÿåˆ—çš„åˆå§‹åŒ–æ–¹æ³•</li>
<li>å¼‚æ­¥è°ƒåº¦çš„æ–¹æ³•</li>
<li>åŒæ­¥è°ƒåº¦çš„æ–¹æ³•</li>
</ol>
<p>ä¸‹é¢æ˜¯æ¥å£å£°æ˜ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@interface MADispatchQueue : NSObject&#10;&#10;    + (MADispatchQueue *)globalQueue;&#10;&#10;    - (id)initSerial: (BOOL)serial;&#10;&#10;    - (void)dispatchAsync: (dispatch_block_t)block;&#10;    - (void)dispatchSync: (dispatch_block_t)block;&#10;&#10;    @end</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦å®ç°è¿™äº›æ–¹æ³•ã€‚</p>
<h1 id="çº¿ç¨‹æ± æ¥å£">çº¿ç¨‹æ± æ¥å£</h1><p>å­˜å‚¨é˜Ÿåˆ—çš„çº¿ç¨‹æ± æœ‰ä¸€ä¸ªå¾ˆç®€æ´çš„æ¥å£ã€‚è¿™ä¸ªæ¥å£çš„å®ç°èƒ½å¤Ÿå®é™…æ‰§è¡Œå·²ç»æäº¤çš„ä»»åŠ¡ã€‚é˜Ÿåˆ—åˆ™è´Ÿè´£åœ¨åˆé€‚çš„æ—¶é—´æŠŠé‚£äº›å·²ç»åœ¨é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æäº¤ç»™ CPU ã€‚</p>
<p>çº¿ç¨‹æ± åªæœ‰ä¸€é¡¹å·¥ä½œï¼šæäº¤å°†è¦è¢«è¿è¡Œçš„ä»»åŠ¡ã€‚å¯¹åº”çš„ï¼Œå®ƒçš„æ¥å£ä¹Ÿåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MAThreadPool</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">  - (<span class="keyword">void</span>)addBlock: (dispatch_block_t)block;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>æ—¢ç„¶è¿™ä¸ªæ˜¯æ ¸å¿ƒï¼Œè®©æˆ‘ä»¬é¦–å…ˆæ¥å®ç°å®ƒã€‚</p>
<h1 id="çº¿ç¨‹æ± çš„å®ç°">çº¿ç¨‹æ± çš„å®ç°</h1><p>é¦–å…ˆè®©æˆ‘ä»¬æ¥çœ‹å®ä¾‹å˜é‡ã€‚çº¿ç¨‹æ± å°†ä¼šè¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œä¸ç®¡æ˜¯å†…éƒ¨çš„è¿˜æ˜¯å¤–éƒ¨çš„ã€‚å› æ­¤å®ƒåº”è¯¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å°½ç®¡ GCD ä¸€ç›´ä½¿ç”¨çš„éƒ½æ˜¯è¾ƒä¸ºå¿«é€Ÿçš„åŸå­æ€§æ“ä½œï¼ˆatomic operationsï¼‰ï¼Œä½†æ˜¯æˆ‘å°†ä¼šåœ¨æˆ‘çš„é‡æ–°å®ç°ä¸­ä½¿ç”¨ä¸€ç§è¾ƒå¥½çš„è€å¼çš„é”ã€‚æˆ‘éœ€è¦è¿™ä¸ªé”ç­‰å¾…ï¼ˆwaitï¼‰ä»¥åŠå‘ä¿¡å·(signal)çš„åŠŸèƒ½ï¼Œè€Œä¸ä»…ä»…æ˜¯å¼ºåˆ¶äº’æ–¥çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä¼šä½¿ç”¨ <code>NSConditon</code>è€Œä¸æ˜¯ç®€å•çš„<code>NSLock</code>ã€‚ä½ å¯èƒ½å¯¹å®ƒä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œ<code>NSCondition</code> æ˜¯ä¸€ç§åŸºæœ¬é”ï¼Œå¹¶ä¸”åŒ…å«äº†ä¸€ä¸ªæ¡ä»¶å˜é‡ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSCondition</span> *_lock;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥å¯ç”¨æ–°çš„å·¥ä½œçº¿ç¨‹ï¼Œæˆ‘éœ€è¦çŸ¥é“å½“å‰çº¿ç¨‹æ± ä¸­æœ‰å¤šå°‘çº¿ç¨‹ï¼Œæœ‰å¤šå°‘çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨çš„æœ€å¤§çº¿ç¨‹æ•°ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSUInteger</span> _threadCount;</span><br><span class="line"><span class="built_in">NSUInteger</span> _activeThreadCount;</span><br><span class="line"><span class="built_in">NSUInteger</span> _threadCountLimit;</span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œè¿˜æœ‰ä¸€äº›è¦è¢«æ‰§è¡Œçš„ block ã€‚è¿™æ˜¯ä¸€ä¸ª <code>NSMutableArray</code>ï¼Œå®ƒè¢«å½“ä½œä¸€ä¸ªé˜Ÿåˆ—ï¼Œä½ å¯ä»¥ä»å®ƒçš„æœ«ä½æ·»åŠ  blockï¼Œä¹Ÿå¯ä»¥ä»å®ƒçš„å¼€å¤´ç§»é™¤ block:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableArray</span> *_blocks;</span><br></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–å¾ˆç®€å•ã€‚å…ˆåˆå§‹åŒ–é”ï¼Œæ¥ç€åˆå§‹åŒ– block æ•°ç»„ï¼Œç„¶åå°†çº¿ç¨‹æ•°çš„é™åˆ¶è®¾ç½®ä¸º 128ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)init &#123;</span><br><span class="line">      <span class="keyword">if</span>((<span class="keyword">self</span> = [<span class="keyword">super</span> init])) &#123;</span><br><span class="line">          _lock = [[<span class="built_in">NSCondition</span> alloc] init];</span><br><span class="line">          _blocks = [[<span class="built_in">NSMutableArray</span> alloc] init];</span><br><span class="line">          _threadCountLimit = <span class="number">128</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>å·¥ä½œçº¿ç¨‹æ˜¯ä¸€ä¸ªç®€å•çš„æ— é™å¾ªç¯ã€‚åªè¦ block æ•°ç»„ä¸ºç©ºï¼Œå®ƒå°±ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚ä¸€æ—¦æœ‰ä¸€ä¸ª block å¯ç”¨ï¼Œå®ƒå°±ä¼šè®© block ä»æ•°ç»„ä¸­å‡ºåˆ—å¹¶ä¸”æ‰§è¡Œ å®ƒã€‚å½“åšè¿™äº›äº‹çš„æ—¶å€™ï¼Œçº¿ç¨‹æ± ä¼šå¢åŠ æ´»è·ƒçº¿ç¨‹çš„æ•°é‡ï¼Œç­‰å®Œæˆä¹‹åä¼šå†è®©å…¶å‡å°‘ã€‚ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹å§ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)workerThreadLoop: (<span class="keyword">id</span>)ignore &#123;</span><br></pre></td></tr></table></figure>
<p>å®ƒåšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è·å–é”ã€‚æ³¨æ„è¿™ä¸ªåŠ¨ä½œåœ¨å¾ªç¯å¼€å§‹<em>ä¹‹å‰</em>ã€‚åœ¨å¾ªç¯ç»“æŸåæˆ‘ä¼šè§£é‡Šè¿™æ ·åšçš„åŸå› ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[_lock lock];</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥è¿›å…¥ä¸€ä¸ªæ­»å¾ªç¯ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œè®©é”è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>([_blocks count] == <span class="number">0</span>) &#123;</span><br><span class="line">	[_lock wait];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œä½¿ç”¨äº†å¾ªç¯æ¥å¤„ç†çš„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç®€å•çš„ <code>if</code> è¯­å¥ã€‚è¿™æ ·åšçš„åŸå› æ˜¯ä¸ºäº†é˜²æ­¢<a href="https://en.wikipedia.org/wiki/Spurious_wakeup" target="_blank" rel="external">è™šå‡å”¤é†’</a>ã€‚ç®€å•æ¥è¯´ï¼Œå³ä½¿æ²¡æœ‰ä¿¡å·å‘å‡ºï¼Œwait å‡½æ•°ä¹Ÿå¯èƒ½ä¼šè¿”å›ï¼Œä¸ºäº†ä¿è¯æ­£ç¡®æ€§ï¼Œå½“ wait è¿”å›æ—¶ï¼Œéœ€è¦å†æ¬¡å¯¹æ¡ä»¶è¿›è¡Œæ£€æŸ¥ã€‚</p>
<p>ä¸€æ—¦ block å¯ç”¨ï¼Œå°±è®©å®ƒå‡ºåˆ—ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dispatch_block_t block = [_blocks firstObject];</span><br><span class="line">[_blocks removeObjectAtIndex: <span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å¢åŠ æ´»è·ƒçº¿ç¨‹æ•°é‡æ¥æ ‡è¯†è¯¥çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä»»åŠ¡ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_activeThreadCount++;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æ˜¯æ—¶å€™æ‰§è¡Œ block äº†ï¼Œä½†æ˜¯æˆ‘ä»¬é¦–å…ˆéœ€è¦å°†é”é‡Šæ”¾ï¼Œå¦åˆ™æˆ‘ä»¬ä¸ä¼šè·å¾—ä»»ä½•å¹¶å‘æ€§ï¼Œè€Œä¸”ä¼šäº§ç”Ÿå„ç§å„æ ·çš„æ­»é”ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[_lock unlock];</span><br></pre></td></tr></table></figure>
<p>å½“é”è¢«å®‰å…¨é‡Šæ”¾ä¹‹åï¼Œå°±å¯ä»¥æ‰§è¡Œ block äº†:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">block();</span><br></pre></td></tr></table></figure>
<p>block æ‰§è¡Œå®Œä¹‹åï¼Œéœ€è¦å‡å°‘æ´»è·ƒçº¿ç¨‹æ•°çš„æ•°é‡ã€‚è¿™ä¸ªæ“ä½œéœ€è¦åœ¨åŠ é”çš„æƒ…å†µä¸‹è¿›è¡Œï¼Œé˜²æ­¢ç«äº‰æ¡ä»¶çš„äº§ç”Ÿï¼Œè¿™é‡Œå°±æ˜¯å¾ªç¯çš„ç»“å°¾äº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  [_lock lock];</span><br><span class="line">  _activeThreadCount--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å·²ç»çœ‹åˆ°äº†ä¸ºä»€ä¹ˆè¿›å…¥å¾ªç¯ä¹‹å‰éœ€è¦åŠ é”ã€‚å¾ªç¯ä¸­çš„æœ€åä¸€æ­¥æ˜¯å‡å°‘æ´»è·ƒçº¿ç¨‹æ•°é‡ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬åœ¨è¿™æ—¶å°±æŒæœ‰é”ã€‚è¿›å…¥å¾ªç¯çš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦æ£€æŸ¥ block é˜Ÿåˆ—ã€‚é€šè¿‡åœ¨å¾ªç¯çš„å¤–éƒ¨è¿è¡Œäº†ç¬¬ä¸€æŠŠé”ï¼Œåç»­çš„å¾ªç¯å°±å¯ä»¥é’ˆå¯¹æ‰€æœ‰çš„æ“ä½œä½¿ç”¨è¿™æŠŠé”ï¼Œè€Œä¸éœ€è¦åŠ é”ï¼Œè§£é”ï¼Œç„¶åçªç„¶åˆåŠ é”äº†ã€‚</p>
<p>ç°åœ¨æ¥çœ‹ <code>addBlock</code> :</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)addBlock: (dispatch_block_t)block &#123;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ‰€åšçš„æ‰€æœ‰äº‹æƒ…éƒ½éœ€è¦å…ˆåŠ é”ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[_lock lock];</span><br></pre></td></tr></table></figure>
<p>é¦–è¦çš„ä»»åŠ¡æ˜¯è¦æŠŠæ–°çš„ block æ·»åŠ åˆ° block é˜Ÿåˆ—ä¸­ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[_blocks addObject: block];</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ­£å¥½æœ‰ä¸€ä¸ªç©ºé—²çš„å·¥ä½œçº¿ç¨‹å‡†å¤‡æ¥æ‰‹è¿™ä¸ª blockï¼Œå°±æ²¡æœ‰ä»€ä¹ˆå¯åšçš„ã€‚ä½†æ˜¯å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²å·¥ä½œçº¿ç¨‹æ¥å¤„ç†è¿™ä¸ª blockï¼Œå¹¶ä¸”å·¥ä½œçº¿ç¨‹çš„æ•°é‡è¿˜æ²¡æœ‰è¾¾åˆ°é™åˆ¶ï¼Œé‚£ä¹ˆå°±åº”è¯¥å†åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSUInteger</span> idleThreads = _threadCount - _activeThreadCount;</span><br><span class="line"><span class="keyword">if</span>([_blocks count] &gt; idleThreads &amp;&amp; _threadCount &lt; _threadCountLimit) &#123;</span><br><span class="line">    [<span class="built_in">NSThread</span> detachNewThreadSelector: <span class="keyword">@selector</span>(workerThreadLoop:)</span><br><span class="line">                             toTarget: <span class="keyword">self</span></span><br><span class="line">                           withObject: <span class="literal">nil</span>];</span><br><span class="line">    _threadCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œçº¿ç¨‹å¯ä»¥å¼€å§‹æ‰§è¡Œ block äº†ã€‚ä¸ºäº†é˜²æ­¢å®ƒä»¬éƒ½åœ¨ä¼‘çœ ï¼Œå”¤é†’ä¸€ä¸ªï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[_lock signal];</span><br></pre></td></tr></table></figure>
<p>ç„¶åè§£é”å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    [_lock unlock];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè¿™ä¸ªçº¿ç¨‹æ± å¯ä»¥å¤§é‡ç”Ÿäº§çº¿ç¨‹è‡³é¢„è®¾çš„æ•°é‡é™åˆ¶ï¼Œç„¶ååœ¨ block è¿›å…¥çš„æ—¶å€™æ‰§è¡Œ blockã€‚ç°åœ¨ä»¥è¿™ä¸ªä¸ºåŸºç¡€æ¥å®ç°é˜Ÿåˆ—ã€‚</p>
<h1 id="é˜Ÿåˆ—å®ç°">é˜Ÿåˆ—å®ç°</h1><p>ä¸çº¿ç¨‹æ± ä¸€æ ·ï¼Œé˜Ÿåˆ—éœ€è¦ä¸€æŠŠé”ä¿æŠ¤é‡Œé¢çš„å†…å®¹ã€‚ä½†ä¸çº¿ç¨‹æ± ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œå®ƒä¸éœ€è¦ä»»ä½•ç­‰å¾…å’Œä¿¡å·ï¼Œåªæ˜¯åŸºæœ¬çš„äº’æ–¥é”ï¼Œæ‰€ä»¥å®ƒä½¿ç”¨<code>NSLock</code>ç±»å°±è¡Œäº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSLock</span> *_lock;</span><br></pre></td></tr></table></figure>
<p>ä¸çº¿ç¨‹æ± ä¸€æ ·ï¼Œè¿™é‡Œä½¿ç”¨äº†<code>NSMutableArray</code>æ¥ç»´æŠ¤ä¸€ä¸ªå¾…åˆ†é… block çš„é˜Ÿåˆ—ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableArray</span> *_pendingBlocks;</span><br></pre></td></tr></table></figure>
<p>é˜Ÿåˆ—éœ€è¦çŸ¥é“ä»»åŠ¡æ˜¯ä¸²è¡Œçš„è¿˜æ˜¯å¹¶è¡Œçš„ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> _serial;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯ä¸²è¡Œçš„ï¼Œå®ƒåŒæ—¶éœ€è¦è®°å½•ç°åœ¨æ˜¯å¦æœ‰ block æ­£åœ¨çº¿ç¨‹æ± ä¸­è¢«æ‰§è¡Œï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> _serialRunning;</span><br></pre></td></tr></table></figure>
<p>è€Œå¹¶å‘é˜Ÿåˆ—æ— è®ºæ˜¯å¦æœ‰ block åœ¨æ‰§è¡Œå®ƒçš„è¡Œä¸ºéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å®ƒä»¬ä¸éœ€è¦è®°å½•è¿™äº›ã€‚<br>å…¨å±€é˜Ÿåˆ—è¢«å­˜å‚¨åœ¨ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ï¼Œå°±åƒä¸‹é¢çš„å…±äº«çº¿ç¨‹æ± é‚£æ ·ã€‚ä»–ä»¬éƒ½æ˜¯åœ¨<code>+initialize:</code>ä¸­åˆ›å»ºçš„ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> MADispatchQueue *gGlobalQueue;</span><br><span class="line"><span class="keyword">static</span> MAThreadPool *gThreadPool;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)initialize &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">self</span> == [MADispatchQueue class]) &#123;</span><br><span class="line">        gGlobalQueue = [[MADispatchQueue alloc] initSerial: <span class="literal">NO</span>];</span><br><span class="line">        gThreadPool = [[MAThreadPool alloc] init];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶ <code>+initialize</code> å·²ç»ä¿è¯åˆ›å»ºäº† <code>gGlobalQueue</code>ï¼Œ<code>+globalQueue</code> æ–¹æ³•åªéœ€è¦ç›´æ¥è¿”å›è¿™ä¸ªå˜é‡å³å¯ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ (MADispatchQueue *)globalQueue &#123;</span><br><span class="line">    <span class="keyword">return</span> gGlobalQueue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ä¸è°ƒç”¨ <code>dispatch_once</code> ç±»ä¼¼ï¼Œä½†æ˜¯å¦‚æœåœ¨æˆ‘å®ç° GCD API çš„æ—¶å€™åˆä½¿ç”¨äº†å¦ä¸€ä¸ª GCD çš„ APIï¼Œè¿™ä¼šè®©äººæ„Ÿè§‰æ˜¯åœ¨ä½œå¼Šï¼Œå³ä½¿è¿™ä¸¤ä¸ª API å¹¶ä¸æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>åˆå§‹åŒ–é˜Ÿåˆ—åŒ…å«äº†åˆ›å»ºé”å’Œå¾…åˆ†é… block é˜Ÿåˆ—ï¼Œè¿˜éœ€è¦è®¾ç½®<code>_serial</code>å˜é‡ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)initSerial: (<span class="built_in">BOOL</span>)serial &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">self</span> = [<span class="keyword">super</span> init])) &#123;</span><br><span class="line">        _lock = [[<span class="built_in">NSLock</span> alloc] init];</span><br><span class="line">        _pendingBlocks = [[<span class="built_in">NSMutableArray</span> alloc] init];</span><br><span class="line">        _serial = serial;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æˆ‘ä»¬ç€æ‰‹å®ç°å…¶å®ƒçš„å…¬å…± API ä¹‹å‰ï¼Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„æ–¹æ³•éœ€è¦è¢«å®ç°ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨çº¿ç¨‹æ± ä¸­è°ƒåº¦ä¸€ä¸ª blockï¼Œç„¶åå†éšå¼åœ°è°ƒç”¨è‡ªèº«å»æ‰§è¡Œå¦å¤–ä¸€ä¸ª blockï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)dispatchOneBlock &#123;</span><br></pre></td></tr></table></figure>
<p>å®ƒå­˜åœ¨çš„æ‰€æœ‰çš„ç›®çš„éƒ½æ˜¯ä¸ºäº†è¿è¡Œçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡ï¼Œæ‰€ä»¥å®ƒå°±è¦åœ¨è¿™é‡Œè¿›è¡Œè°ƒåº¦ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[gThreadPool addBlock: ^&#123;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å®ƒè·å–åˆ°äº†é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ª blockã€‚å½“ç„¶ï¼Œè¿™éœ€è¦åœ¨åŠ é”çš„æƒ…å†µä¸‹æ‰§è¡Œä»¥é¿å…ç¾éš¾æ€§çš„å´©æºƒï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[_lock lock];</span><br><span class="line">dispatch_block_t block = [_pendingBlocks firstObject];</span><br><span class="line">[_pendingBlocks removeObjectAtIndex: <span class="number">0</span>];</span><br><span class="line">[_lock unlock];</span><br></pre></td></tr></table></figure>
<p>åœ¨è·å–åˆ°äº† block å¹¶ä¸”é”ä¹Ÿé‡Šæ”¾çš„æ—¶å€™ï¼Œblock å°±å¯ä»¥å®‰å…¨åœ°åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œäº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">block();</span><br></pre></td></tr></table></figure>
<p>å¦‚æœé˜Ÿåˆ—æ˜¯å¹¶å‘é˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å®ƒæ‰€æœ‰éœ€è¦å¤„ç†çš„æ‰€æœ‰å†…å®¹ã€‚å¦‚æœæ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼Œè¿˜è¦å†è¿›è¡Œä¸€äº›æ“ä½œï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(_serial) &#123;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ä¸­ï¼Œæ·»åŠ çš„ block ä¼šè¢«åˆ›å»ºï¼Œä½†æ˜¯å¾—ç­‰åˆ°æ­£åœ¨å¤„ç†çš„ block å®Œæˆæ‰ä¼šè¢«æ¿€æ´»ã€‚å½“ä¸€ä¸ª block æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œ<code>dispatchOneBlock</code> å°†ä¼šæ£€æŸ¥æ˜¯å¦è¿˜æœ‰ block åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å¦‚æœæœ‰ï¼Œå®ƒä¼šè°ƒç”¨è‡ªå·±æ‰§è¡Œä¸‹ä¸€ä¸ª blockã€‚å¦‚æœæ²¡æœ‰ï¼Œå®ƒä¼šæŠŠé˜Ÿåˆ—çš„è¿è¡ŒçŠ¶æ€ç½®ä¸º<code>NO</code>:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">            [_lock lock];</span><br><span class="line">            <span class="keyword">if</span>([_pendingBlocks count] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                [<span class="keyword">self</span> dispatchOneBlock];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                _serialRunning = <span class="literal">NO</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            [_lock unlock];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™ä¸ªæ–¹æ³•ï¼Œæƒ³è¦å®ç°<code>dispatchAsync:</code>å°±ç›¸å¯¹ç®€å•äº†ã€‚å°† block æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ä½œä¸ºç­‰å¾…ä»»åŠ¡ï¼Œç„¶åè®¾ç½®çŠ¶æ€å¹¶åœ¨åˆé€‚çš„æ—¶å€™æ¿€æ´»<code>dispatchOneBlock</code>ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)dispatchAsync: (dispatch_block_t)block &#123;</span><br><span class="line">    [_lock lock];</span><br><span class="line">    [_pendingBlocks addObject: block];</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—æ˜¯<em>ç©ºé—²</em>çš„ï¼ŒæŠŠå®ƒçš„çŠ¶æ€è®¾ç½®ä¸ºæ­£åœ¨è¿è¡Œå¹¶è°ƒç”¨<code>dispatchOneBlock</code>ä½¿ä¸€åˆ‡å¼€å§‹è¿è½¬ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(_serial &amp;&amp; !_serialRunning) &#123;</span><br><span class="line">    _serialRunning = <span class="literal">YES</span>;</span><br><span class="line">    [<span class="keyword">self</span> dispatchOneBlock];</span><br></pre></td></tr></table></figure>
<p>å¦‚æœé˜Ÿåˆ—æ˜¯å¹¶å‘çš„ï¼Œé‚£ä¹ˆæ— æ¡ä»¶åœ°è°ƒç”¨<code>dispatchOneBlock</code>ã€‚å³ä½¿å¦å¤–ä¸€ä¸ª block æ­£åœ¨è¿è¡Œï¼Œæ–°çš„ block ä¹Ÿå¯ä»¥è¢«é©¬ä¸Šæ‰§è¡Œï¼Œå› ä¸ºå¤šä¸ª block è¢«å…è®¸å¹¶å‘åœ°æ‰§è¡Œï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!_serial) &#123;</span><br><span class="line">    [<span class="keyword">self</span> dispatchOneBlock];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—å·²ç»åœ¨è¿è¡Œäº†ï¼Œé‚£ä¹ˆæ²¡æœ‰åˆ«çš„ä»€ä¹ˆéœ€è¦å»å¤„ç†äº†ã€‚å·²ç»åœ¨æ‰§è¡Œçš„ <code>dispatchOneBlock</code> ç»ˆå°†ä¼šæ‰§è¡Œåˆ°åˆšåˆšè¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­çš„çš„ blockã€‚ç°åœ¨é‡Šæ”¾é”ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    [_lock unlock];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯ <code>dispatchSync</code> äº†ã€‚é’ˆå¯¹è¿™ä¸ªï¼ŒGCD æ˜¯ç›¸å½“æ™ºèƒ½çš„ï¼Œå®ƒå¯ä»¥åœ¨è°ƒç”¨çº¿ç¨‹ä¸­ç›´æ¥æ‰§è¡Œ block ï¼Œè€Œè®©é˜Ÿåˆ—ä¸­çš„å…¶ä»– block åœæ­¢æ‰§è¡Œï¼ˆå¦‚æœæ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸ç”¨å®ç°åˆ°å¦‚æ­¤æ™ºèƒ½ã€‚æˆ‘ä»¬åªéœ€è¦å¯¹<code>dispatchAsync:</code> è¿›è¡ŒåŒ…è£…ï¼Œè®©å®ƒç­‰ä¸€ä¸ªä»»åŠ¡å®Œæˆä¹‹åæ‰å¼€å§‹æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</p>
<p>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªå±€éƒ¨çš„ <code>NSCondition</code> å¯¹è±¡ï¼ŒåŠ ä¸Šä¸€ä¸ª<code>done</code>å˜é‡æ¥è¡¨ç¤º block ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå®Œæ¯•ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)dispatchSync: (dispatch_block_t)block &#123;</span><br><span class="line">    <span class="built_in">NSCondition</span> *condition = [[<span class="built_in">NSCondition</span> alloc] init];</span><br><span class="line">    __block <span class="built_in">BOOL</span> done = <span class="literal">NO</span>;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå®ƒå°±å¼‚æ­¥çš„è°ƒåº¦ä¸€ä¸ª blockã€‚è¿™ä¸ª block è°ƒç”¨äº†è¢«ä¼ å…¥çš„é‚£ä¸ª blockï¼Œç„¶åè®¾ç½® done å˜é‡å¹¶ç”¨ condition å‘å‡ºä¿¡å·ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span> dispatchAsync: ^&#123;</span><br><span class="line">    block();</span><br><span class="line">    [condition lock];</span><br><span class="line">    done = <span class="literal">YES</span>;</span><br><span class="line">    [condition signal];</span><br><span class="line">    [condition unlock];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>è€Œåœ¨å¤–é¢çš„åŸå§‹çš„è°ƒç”¨çº¿ç¨‹ä¸­ï¼Œå®ƒé€šè¿‡ <code>condition</code> åœ¨ç­‰å¾… <code>done</code> å˜é‡è¢«è®¾ç½®ï¼Œç„¶åè¿”å›ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    [condition lock];</span><br><span class="line">    <span class="keyword">while</span> (!done) &#123;</span><br><span class="line">        [condition wait];</span><br><span class="line">    &#125;</span><br><span class="line">    [condition unlock];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œï¼Œblock çš„æ‰§è¡Œå·²ç»å®Œæˆäº†ã€‚å¤§åŠŸå‘Šæˆï¼é‚£å°±æ˜¯<code>MADispatchQueue</code> API ä¸­çš„æ‰€éœ€è¦çš„æœ€åä¸€ç‚¹å„¿å†…å®¹ã€‚</p>
<h1 id="ç»“è®º">ç»“è®º</h1><p>ä¸€ä¸ªå…¨å±€çº¿ç¨‹æ± å¯ä»¥é€šè¿‡ä¸€ä¸ªæ‹¥æœ‰ä»»åŠ¡ block ä»¥åŠèƒ½å¤§é‡ç”Ÿäº§çº¿ç¨‹çš„é˜Ÿåˆ—æ¥å®ç°ã€‚ä½¿ç”¨ä¸€ä¸ªå…±äº«çš„çº¿ç¨‹æ± ï¼Œä¸€ä¸ªåŸºæœ¬çš„è°ƒåº¦é˜Ÿåˆ—çš„ API å°±å¯ä»¥è¢«åˆ›å»ºï¼Œå®ƒæä¾›äº†åŸºæœ¬çš„ä¸²è¡Œ/å¹¶è¡Œé˜Ÿåˆ—ä¸‹åŒæ­¥/å¼‚æ­¥ä»»åŠ¡çš„è°ƒåº¦ã€‚è¿™æ¬¡çš„é‡æ–°å®ç°ç¼ºå°‘äº† GCD ä¸­è®¸å¤šä¼˜ç§€çš„ç‰¹å¾ï¼Œå¹¶ä¸”è‚¯å®šæ²¡æœ‰ GCD é‚£ä¹ˆé«˜æ•ˆï¼Œä½†å³ä¾¿å¦‚æ­¤å®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°åƒè¿™æ ·ä¸€ç§æœºåˆ¶çš„å†…éƒ¨åŸç†æ˜¯æ€æ ·çš„ï¼Œå¹¶ä¸”è®©æˆ‘ä»¬çœ‹åˆ°é‚£å¹¶ä¸æ˜¯ä»€ä¹ˆé­”æ³•ï¼ˆé™¤äº†<code>dispatch_once</code>ï¼Œé‚£æ˜¯ç»å¯¹çš„é­”æ³•ï¼ï¼‰ã€‚</p>
<p>è¿™å°±æ˜¯ä»Šå¤©çš„å†…å®¹ã€‚ä¸‹æ¬¡å›æ¥çœ‹æ›´å¤šæœ‰è¶£çš„å†…å®¹ã€‚â€Friday Q&amp;Aâ€æ˜¯ç”±ç”¨æˆ·çš„æƒ³æ³•é©±åŠ¨çš„ï¼Œæ‰€ä»¥å¦‚æœä½ å¸Œæœ›ä¸‹æ¬¡æˆ–è€…å°†æ¥æˆ‘å¯ä»¥åœ¨è¿™é‡Œè®¨è®ºæŸäº›å†…å®¹ï¼Œè¯·<a href="mailto:mike@mikeash.com" target="_blank" rel="external">å‘Šè¯‰æˆ‘</a>ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šMike Ashï¼Œ<a href="https://www.mikeash.com/pyblog/friday-qa-2015-09-04-lets-build-dispatch_queue.html">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-04<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/yake_099">Yake</a>ï¼›æ ¡å¯¹ï¼š<a href="http://codebuild.me/">shanks</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
<p>è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« çš„ä»£ç æ˜¯ç”¨ Objective-C å®Œæˆçš„ï¼Œä¸è¿‡ä¸å¦¨ç¢å¤§å®¶å­¦ä¹ å¤šçº¿ç¨‹ç¼–ç çš„çŸ¥è¯†ã€‚</p>
</blockquote>
<p><code>Grand Central Dispatch</code> æ˜¯è¿‡å»å‡ å¹´ä¸­è‹¹æœæ¨å‡ºè¿‡çš„è®¸å¤šå¾ˆæ£’çš„ API ä¸­çš„ä¸€å‘˜ã€‚åœ¨æœ€æ–°ä¸€æœŸçš„ â€œLetâ€™s Buildâ€ ç³»åˆ—ä¸­ï¼Œæˆ‘å‡†å¤‡å»æ¢ç´¢ dispatch_queue ä¸€äº›æœ€åŸºæœ¬ç‰¹æ€§çš„é‡æ–°å®ç°ï¼Œè¿™ä¸ªä¸»é¢˜çš„å»ºè®®æ¥è‡ª Rob Rixã€‚<br>]]>
    
    </summary>
    
      <category term="Mike Ash" scheme="http://swiftggteam.github.io/tags/Mike-Ash/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Swiftä¸­çš„æ¨¡å¼åŒ¹é…]]></title>
    <link href="http://swiftggteam.github.io/2015/10/16/swift-pattern-matching/"/>
    <id>http://swiftggteam.github.io/2015/10/16/swift-pattern-matching/</id>
    <published>2015-10-16T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="http://oleb.net/blog/2015/09/swift-pattern-matching/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-18<br>è¯‘è€…ï¼š<a href="undefined">lfb-CD</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="external">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="external">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<h1 id="Swiftä¸­çš„æ¨¡å¼åŒ¹é…">Swiftä¸­çš„æ¨¡å¼åŒ¹é…</h1><p>æ›´æ–°:<br>2015.9.19: æ·»åŠ äº†ä¸€äº›å…³äºSwiftè¯­æ³•é—®é¢˜çš„ç¬”è®°ã€‚æŠŠè‡ªå®šä¹‰æ“ä½œç¬¦çš„ç¬¦å·æ”¹ä¸ºäº†ä¸€ä¸ªæˆ‘è®¤ä¸ºæ›´åŠ é€‚åˆçš„ã€‚åœ¨æ€»ç»“ä¸­æ·»åŠ äº†ä¸€äº›å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„æƒ³æ³•ã€‚<br>2015.9.25: æ·»åŠ äº†å…³äºæ ‡å‡†åº“ä¸­å·²ç»å­˜åœ¨çš„<code>~&gt;</code>æ“ä½œç¬¦çš„ç¬”è®°<br><a id="more"></a><br>è¿™ä¸ªç³»åˆ—çš„å…¶ä»–æ–‡ç« ï¼š<br>(1)Custom Pattern Matching (å°±æ˜¯è¿™ç¯‡)<br>(2)<a href="http://oleb.net/blog/2015/09/swift-ranges-and-intervals/" target="_blank" rel="external">Ranges and Intervals</a><br>(3)<a href="http://oleb.net/blog/2015/09/more-pattern-matching-examples/" target="_blank" rel="external">More Pattern Matching Examples</a></p>
<blockquote>
<p><a href="http://oleb.net/media/swift-pattern-matching.playground.zip" target="_blank" rel="external">Download this article as a playground</a> for Xcode 7.</p>
</blockquote>
<p>Swiftæœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œä½ å¯ä»¥å¯¹æ¨¡å¼åŒ¹é…ç³»ç»Ÿè¿›è¡Œæ‰©å±•ã€‚<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Patterns.html" target="_blank" rel="external">Patterns(æ¨¡å¼)</a>æ˜¯è§„åˆ™å€¼åœ¨switchè¯­å¥ä¸­çš„ä¸€ä¸ªcaseé€‰é¡¹ï¼Œ<code>do-catch</code>è¯­å¥ä¸­çš„ä¸€ä¸ª<em><code>catch</code></em>åˆ†å¥ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ª<em><code>if</code></em>ï¼Œ<em><code>while</code></em>ï¼Œ<em><code>guard</code></em>ï¼Œ<em><code>for-in</code></em>è¯­å¥ä¸­çš„ä¸€ä¸ªé€‰é¡¹ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æƒ³åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦å¤§äº,å°äºæˆ–ç­‰äºé›¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>if-else</code>çš„ç»“æ„ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºè¿™æ®µä»£ç å¹¶ä¸æ¼‚äº®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> x &lt; <span class="number">0</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡‡ç”¨<code>switch</code>è¯­å¥çš„è¯ä¼šæ›´åŠ å¥½ï¼Œæˆ‘æ›´åŠ å–œæ¬¢è¿™æ ·å†™ä»£ç :</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç  </span></span><br><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> &lt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ä½¿ç”¨ä¸ç­‰å¼æ¡ä»¶çš„åŒ¹é…æ¨¡å¼ï¼Œ<code>switch</code>è¯­å¥ä¸­é»˜è®¤æ˜¯ä¸æ”¯æŒçš„(æ³¨:å³ä¸æ”¯æŒ<code>case &gt;0</code>è¿™ç§å†™æ³•)ã€‚çœ‹çœ‹å’±ä»¬æ˜¯å¦å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¸ºäº†æ–¹ä¾¿ä¹‹åçš„ç†è§£ï¼Œæˆ‘å°†ä½¿ç”¨<code>case greaterThen(0):print(&quot;positive&quot;)</code>çš„åŒ¹é…å†™æ³•æ›¿æ¢ä¹‹å‰çš„<code>case &gt; 0</code>åœ¨å†…çš„æ‰€æœ‰æ¡ä»¶ã€‚ä¸è¿‡ï¼Œæˆ‘å°†ç¨åå›è¿‡å¤´æ¥è‡ªå®šä¹‰è¿™ä¸ªæ“ä½œç¬¦ã€‚</p>
<h2 id="æ‰©å±•æ¨¡å¼åŒ¹é…">æ‰©å±•æ¨¡å¼åŒ¹é…</h2><p>Swiftä¸­çš„æ¨¡å¼åŒ¹é…æ˜¯åŸºäº<code>~=</code>æ“ä½œç¬¦ã€‚å¦‚æœè¡¨è¾¾æ¨¡å¼<code>~=</code>è¿”å›å€¼ä¸º<code>true</code>åˆ™åŒ¹é…æˆåŠŸã€‚</p>
<p><a href="http://swiftdoc.org/operator/tildeeq/" target="_blank" rel="external">æ ‡å‡†åº“ä¸­å¯¹<code>~=</code>æœ‰å››ä¸ªé‡è½½</a>ï¼šä¸€ä¸ªæ˜¯<code>Equatable</code>ç±»å‹ï¼Œä¸€ä¸ªæ˜¯<code>optionals</code>ï¼Œä¸€ä¸ªæ˜¯<code>range</code>ï¼Œæœ€åä¸€ä¸ªæ˜¯<code>interval</code>ã€‚è™½ç„¶<code>range</code>å’Œ<code>interval</code>æŒºæ¥è¿‘çš„ï¼Œä½†åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬ä¸ç”¨ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­äº†è§£ä¸‹<a href="http://oleb.net/blog/2015/09/swift-ranges-and-intervals/" target="_blank" rel="external">Ranges and Intervals</a>ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å®ç°å±äºæˆ‘ä»¬è‡ªå·±çš„<code>~=</code>ï¼Œå‡½æ•°çš„å½¢å¼æ˜¯è¿™æ ·:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> ~=<span class="params">(pattern: ???, value: ???)</span></span> -&gt; <span class="type">Bool</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çŸ¥é“å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå¸ƒå°”ç±»å‹(<code>Bool</code>)çš„ç»“æœå€¼ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å‘ŠçŸ¥ä¼ å…¥å€¼æ˜¯å¦æ»¡è¶³æ¨¡å¼åŒ¹é…æ¡ä»¶ã€‚æ¥ä¸‹æ¥è¿˜ç•™æœ‰ä¸€ä¸ªé—®é¢˜:å‡½æ•°çš„ä¼ å…¥å‚æ•°ç±»å‹æ˜¯ä»€ä¹ˆ?</p>
<p>å¯¹äº<em>value</em>(ä¼ å…¥å€¼)æ¥è®²ï¼Œæˆ‘ä»¬åªéœ€ä½¿ç”¨<code>Int</code>ç±»å‹å³å¯æ»¡è¶³ä¸Šæ–‡ä¾‹ç¨‹ä¸­çš„éœ€æ±‚ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ³›å‹ï¼Œä½¿å…¶èƒ½æ¥å—ä»»ä½•ç±»å‹çš„æ•°æ®ã€‚<code>pattern</code>åœ¨å®ä¾‹ä¸­å°†ä»¥<code>greaterThan(0)</code>æˆ–è€…æ˜¯<code>lessThan(0)</code>çš„å½¢å¼å‡ºç°ã€‚ä¸€èˆ¬æ¥è®²ï¼Œ<code>pattern</code>åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°†<em>value</em>åšä¸ºå‚æ•°ä¼ å…¥ï¼Œå¦‚æœåŒ¹é…æˆåŠŸåˆ™è¿”å›trueï¼Œå…¶ä»–åˆ™è¿”å›falseã€‚<em>value</em>çš„ç±»å‹ä¸ºTï¼Œæ‰€ä»¥patternçš„ç±»å‹ä¹Ÿåº”è¯¥ä¸º<code>T -&gt; Bool</code>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> ~=<span class="generics">&lt;T&gt;</span><span class="params">(pattern: T -&gt; Bool, value: T)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> pattern(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦å®šä¹‰<code>greaterThan</code>å’Œ<code>lessThan</code>å‡½æ•°ï¼Œç”¨äºè¿”å›åŒ¹é…ç»“æœã€‚æ³¨æ„:ä¸è¦å°†<code>greaterThan(0)</code>ä¸­çš„<code>0</code>å€¼å’Œä¼ å…¥è¿›è¡Œæ¯”è¾ƒçš„å€¼valueæ··æ·†äº†ã€‚greaterThançš„å‚æ•°æ˜¯<code>pattern</code>çš„ä¸€éƒ¨åˆ†ï¼Œåº”ç”¨äºç­‰ä¼šç¬¬äºŒæ­¥è¦ç”¨åˆ°çš„å€¼ã€‚æ¯”å¦‚ï¼Œ<code>greaterThan(0) ~= x</code>å’Œ<code>greaterThan(0)(x)</code>æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“<code>greaterThen(0)</code>å‡½æ•°å¿…é¡»ç”Ÿæˆä¸€ä¸ªç±»å‹<code>T-&gt;Bool</code>å‡½æ•°ä½œä¸ºç»“æœå€¼è¿”å›ã€‚æ‰€ä»¥åä¹‹ï¼Œ<code>greaterThen</code>å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°éœ€è¦å¦ä¸€ä¸ªå€¼å¹¶è¿”å›ç¬¬ä¸€ä¸ªå‡½æ•°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œæ¡ä»¶çº¦æŸ:å¿…é¡»éµå¾ª<code>Comparable</code>åè®®ï¼Œè¿™æ ·å°±èƒ½ä½¿ç”¨<code>Swift</code>ä¸­çš„<code>&gt; å’Œ &lt;</code>æ“ä½œç¬¦ç¬¦äº†ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">greaterThan</span><span class="generics">&lt;T : Comparable&gt;</span><span class="params">(a: T)</span></span> -&gt; (<span class="type">T</span> -&gt; <span class="type">Bool</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; (b: <span class="type">T</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span> b &gt; a &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºè¿™ç±»æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”åˆè¿”å›ä¸€ä¸ªå¯ä»¥æ¥å—ä½™ä¸‹å‚æ•°çš„å‡½æ•°(ä»¥æ­¤ç±»æ¨)å«åš<a href="https://en.wikipedia.org/wiki/Currying" target="_blank" rel="external">curried functions(æŸ¯é‡ŒåŒ–å‡½æ•°)</a>ã€‚(è¿™æ˜¯æˆ‘å»å¹´å†™çš„å…³äºæŸ¯é‡ŒåŒ–å‡½æ•°çš„æ–‡ç« :<a href="http://oleb.net/blog/2014/07/swift-instance-methods-curried-functions/" target="_blank" rel="external">instance methods in Swift are a form of (partially) curried functions</a>)ã€‚Swiftä¸ºå£°æ˜æŸ¯é‡ŒåŒ–å‡½æ•°æä¾›äº†<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Declarations.html#//apple_ref/doc/uid/TP40014097-CH34-ID363" target="_blank" rel="external">ç‰¹æ®Šçš„è¯­æ³•</a>ã€‚ä½¿ç”¨è¿™æ ·çš„è¯­å¥ï¼Œæˆ‘ä»¬çš„å‡½æ•°å°±ä¼šåƒè¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">greaterThan</span><span class="generics">&lt;T : Comparable&gt;</span><span class="params">(a: T)</span></span>(<span class="number">_</span> b: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> b &gt; a</span><br><span class="line">&#125;</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">lessThan</span><span class="generics">&lt;T : Comparable&gt;</span><span class="params">(a: T)</span></span>(<span class="number">_</span> b: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> b &lt; a</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯åœ¨æˆ‘ä»¬ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„switchè¯­å¥ä¸­éœ€è¦å†™çš„:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> greaterThan(<span class="number">0</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> lessThan(<span class="number">0</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"Should be unreachable"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å½“ä¸é”™å§ï¼Œé™¤äº†<code>default</code>é‚£é¡¹è¯­å¥è¿˜ä¸å®Œç¾ã€‚å¦‚æœè®©ç¼–è¯‘å™¨æ£€æŸ¥å®Œæ‰€æœ‰çš„æƒ…å†µæ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥ï¼Œç¼–è¯‘å™¨æ€»æ˜¯ä¼šè®©æˆ‘ä»¬æä¾›ä¸€ä¸ª<code>default</code>çš„æƒ…å†µã€‚å½“ç„¶ï¼Œå¦‚æœä½ ç¡®å®šä½ çš„é€‰é¡¹èƒ½è¦†ç›–æ‰€æœ‰çš„å¯èƒ½ï¼ŒæŠŠfatalError()è°ƒç”¨åœ¨<code>default</code>æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå¯ä»¥ç”¨æ¥è®°å½•ä½ é¢„æ–™çš„è¿™æ®µä¸ä¼šè¢«æ‰§è¡Œçš„ä»£ç ã€‚</p>
<h2 id="è‡ªå®šä¹‰æ“ä½œç¬¦">è‡ªå®šä¹‰æ“ä½œç¬¦</h2><p>æ»‘åŠ¨åˆ°é¡¶éƒ¨ï¼Œçœ‹ä¸€ä¼šå„¿æˆ‘ä»¬ä¹‹å‰çš„ä¼ªä»£ç ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³æŠŠ<code>greaterThan(0)</code>å’Œ<code>lessThan(0)</code>åˆ†åˆ«æ¢æˆ<code>&gt; 0</code>å’Œ<code>&lt; 0</code>ã€‚</p>
<p>è‡ªå®šä¹‰æ“ä½œç¬¦æ˜¯ä¸€ä¸ªæœ‰äº‰è®®çš„è¯é¢˜ï¼Œå€˜è‹¥è¯»è€…ä¸ç†Ÿæ‚‰æŸä¸ªç‰¹å®šçš„æ“ä½œç¬¦æ—¶ï¼Œå¤§å¤§é™ä½äº†å¯è¯»æ€§ã€‚å›åˆ°æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç±»ä¼¼äº<code>greaterThan(0)</code>è¿™æ ·çš„è¯­å¥å¯è¯»æ€§æ˜¯éå¸¸å¥½çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œè‡ªå®šä¹‰æ“ä½œç¬¦æ˜¯ä¸éœ€è¦çš„ã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“<code>&gt; 0</code>æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ç€è‡ªå®šä¹‰ä¸€ä¸ªç±»ä¼¼äºè¿™æ ·çš„æ“ä½œç¬¦ã€‚æ­£å¦‚æˆ‘ä»¬å°†ä¼šçœ‹åˆ°çš„ï¼Œå®ƒä¸ä¼šæ˜¯å®Œç¾çš„ã€‚</p>
<p>æˆ‘ä»¬è‡ªå®šä¹‰çš„è¿ç®—ç¬¦æ˜¯ä¸€å…ƒçš„ â€” å®ƒä»¬ä»…æœ‰ä¸€ä¸ªæ“ä½œæ•°ï¼Œå¹¶ä¸”æ˜¯å‰ç¼€è¿ç®—ç¬¦(ä¸ä¹‹ç›¸å¯¹çš„æ˜¯åç¼€è¿ç®—ç¬¦ï¼Œç´§è·Ÿæ“ä½œæ•°ä¹‹å)ã€‚ä¸€å…ƒæ“ä½œç¬¦ä¸å…¶æ“ä½œæ•°ä¸­é—´æ˜¯æ²¡æœ‰ç©ºæ ¼çš„ï¼ŒåŸå› åœ¨äºSwiftç”¨ç©ºæ ¼æ¥æ¶ˆé™¤ä¸€å…ƒè¿ç®—ç¬¦å’ŒäºŒå…ƒè¿ç®—ç¬¦ä¹‹é—´çš„æ­§ä¹‰ã€‚æ­¤å¤–ï¼Œ<code>&lt;</code><a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/LexicalStructure.html#//apple_ref/doc/uid/TP40014097-CH30-ID418" target="_blank" rel="external">ä¸å…è®¸ä½œä¸ºå‰ç¼€è¿ç®—ä½œç¬¦</a>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é€€è€Œæ±‚å…¶æ¬¡ç”¨å…¶ä»–ç¬¦å·æ›¿ä»£ä¹‹ã€‚(<code>&gt;</code>å…è®¸ä½œä¸ºå‰ç¼€è¿ç®—ç¬¦ï¼Œä½†æ˜¯ä¸èƒ½ä½œä¸ºåç¼€è¿ç®—ç¬¦ã€‚)</p>
<p>æˆ‘å»ºè®®ä½¿ç”¨<code>~&gt;</code>å’Œ<code>~&lt;</code>ã€‚è™½ç„¶ä¸å¤ªç†æƒ³ï¼Œ<code>~&gt;</code>çœ‹èµ·æ¥å¾ˆåƒä¸€ä¸ªç®­å¤´ï¼Œä½†æ˜¯æ³¢æµªå·å½¢è±¡åœ°è¡¨ç¤ºäº†çº¦ç­‰äº(<code>~=</code>)è¿™æ ·çš„å…³ç³»ã€‚å¦å¤–ï¼Œæˆ‘èƒ½æƒ³åˆ°çš„å…¶ä»–æ“ä½œç¬¦(<code>&gt;&gt;</code>å’Œ<code>&lt;&lt;</code>)ä¸ç§»ä½æ“ä½œç¬¦å¾ˆå®¹æ˜“æ··æ·†åœ¨ä¸€èµ·ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨è¿™ä¸¤ä¸ªã€‚</p>
<blockquote>
<p><strong>æ›´æ–°9.25.2015</strong>ï¼šæˆ‘ä»<a href="http://natecook.com/blog/2014/11/swifts-elusive-tilde-gt-operator/" target="_blank" rel="external">Nate Cookçš„è¿™ç¯‡æ–‡ç« ä¸­å¾—çŸ¥</a>æ“ä½œç¬¦<code>~&gt;</code>å·²ç»å­˜åœ¨äº<a href="http://swiftdoc.org/swift-2/operator/tildegt/" target="_blank" rel="external">æ ‡å‡†åº“</a>ä¸­äº†ã€‚å®ƒå¹¶æ²¡æœ‰ä»»ä½•å…¬å¼€çš„å®ç°ï¼Œä½†æ˜¯Nateå‘ç°å®ƒæ˜¯ç”¨æ¥å¢åŠ é›†åˆçš„ç´¢å¼•å€¼çš„ã€‚é‰´äºæœ‰è¿™ç§ç”¨æ³•ï¼Œå®Œæˆä¸åŒçš„ç›®çš„å´ä½¿ç”¨ç›¸åŒçš„æ“ä½œç¬¦ä¼¼ä¹ä¸å¤ªåˆé€‚ã€‚æˆ‘æ„Ÿè§‰å¯ä»¥éšæ„ç”¨å…¶ä»–ç¬¦å·æ›¿ä»£ã€‚</p>
</blockquote>
<p>å®ç°èµ·æ¥ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ã€‚æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å£°æ˜è¿ç®—ç¬¦ä»¥åŠå…·ä½“å‡½æ•°çš„å®ç°ï¼Œè¿™é‡Œä»…ä»…åªæ˜¯å§”æ‰˜å…ˆå‰å®šä¹‰çš„<code>greaterThan</code>å’Œ<code>lessThan</code>å‡½æ•°æ¥å®Œæˆè¿ç®—ç¬¦çš„å®ç°ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">prefix</span> <span class="keyword">operator</span> ~&gt; &#123; &#125;</span><br><span class="line"><span class="keyword">prefix</span> <span class="keyword">operator</span> ~&lt; &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">prefix</span> <span class="func"><span class="keyword">func</span> ~&gt; <span class="generics">&lt;T : Comparable&gt;</span><span class="params">(a: T)</span></span>(<span class="number">_</span> b: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> greaterThan(a)(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">prefix</span> <span class="func"><span class="keyword">func</span> ~<span class="generics">&lt; &lt;T : Comparable&gt;</span><span class="params">(a: T)</span></span>(<span class="number">_</span> b: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> lessThan(a)(b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬çš„<code>switch</code>è¯­å¥å°±å˜æˆäº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> ~&gt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> ~&lt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"Should be unreachable"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æé†’ï¼Œæ³¨æ„è¿ç®—ç¬¦å’Œæ“ä½œæ•°ä¹‹é—´æ˜¯æ²¡æœ‰ç©ºæ ¼çš„ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬èƒ½å†™å¾—æœ€å¥½çš„äº†ï¼Œéå¸¸æ¥è¿‘æˆ‘ä»¬ä¹‹å‰æƒ³è¦å®ç°çš„äº†ï¼Œä½†è¿™æ®µä»£ç ä¹Ÿå¹¶ä¸æ˜¯å®Œç¾çš„äº†ã€‚</p>
<blockquote>
<p><strong>2015.9.19æ›´æ–°</strong>ï¼š<a href="https://twitter.com/jl_hfl/status/644992487346581504" target="_blank" rel="external">Joseph Lord</a>æé†’æˆ‘ï¼ŒSwiftå·²ç»æœ‰ç±»ä¼¼è¯­æ³•ç”¨äºå®ç°å…ˆå‰çš„çš„åŒ¹é…æ¨¡å¼ï¼š</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">_</span> <span class="keyword">where</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"positive"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">_</span> <span class="keyword">where</span> x &lt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"negative"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"zero"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"Should be unreachable"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>(<em><code>default</code>é€‰é¡¹ä»ç„¶æ˜¯ç”¨æ¥ç¡®ä¿ç¼–è¯‘å™¨èƒ½å®‰å…¨å·¥ä½œï¼Œæˆ‘å·²ç»æäº¤äº†è¿™ä¸ªbugï¼Œrdar://22765436</em>)</p>
<p><em>è¿™ç§è¯­æ³•ï¼Œå°½ç®¡æ²¡æœ‰æˆ‘ä»¬è‡ªå®šä¹‰è§£å†³æ–¹æ¡ˆæ˜¾å¾—ç®€æ˜ï¼Œä½†æ˜¯å®ƒå´ä¸éœ€è¦é¢å¤–è‡ªå®šä¹‰ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œçœ‹èµ·æ¥è¿˜æ˜¯ä¸é”™çš„ã€‚ä¸ç®¡æ€æ ·ï¼Œè¯¥è®¾è®¡æ–¹å¼éå¸¸é€šç”¨ï¼Œåº”ç”¨èŒƒå›´å¹¿ã€‚è¯·ç»§ç»­é˜…è¯»ã€‚</em></p>
<h2 id="å…¶ä»–æ–¹é¢çš„åº”ç”¨">å…¶ä»–æ–¹é¢çš„åº”ç”¨</h2><p>é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™é‡Œæå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯éå¸¸é€šç”¨çš„ã€‚æˆ‘ä»¬é‡è½½çš„æ“ä½œç¬¦<code>~=</code>é€‚ç”¨äºä»»ä½•ç±»å‹çš„<code>T</code>å’Œä»»ä½•æ¥å—ä¸€ä¸ªå‚æ•°<code>T</code>å¹¶ä¸”è¿”å›ä¸€ä¸ª<code>Bool</code>ç±»å‹çš„å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´,æˆ‘ä»¬ä½¿<code>pattern(value)</code>å˜æˆäº†<code>pattern ~=</code>è¿™æ ·çš„è¯­æ³•ç³–ã€‚åŒæ—¶ï¼Œé€šè¿‡æ‰©å±•ï¼ŒæŠŠ<code>if pattern(value) { ... }</code>å˜æˆäº†<code>switch value { case pattern: ... }</code>è¿™æ ·çš„è¯­æ³•ç³–ã€‚</p>
<h2 id="æ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¶æ•°è¿˜æ˜¯å¥‡æ•°">æ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¶æ•°è¿˜æ˜¯å¥‡æ•°</h2><p>ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨èŒƒä¾‹ã€‚ç¬¬ä¸€ä¸ªç®€å•ç¤ºä¾‹ç”¨äºè¯´æ˜çŸ¥è¯†ç‚¹ï¼Œä½†å®é™…åº”ç”¨æ„ä¹‰ä¸å¤§ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ª<code>isEven</code>å‡½æ•°ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯å¶æ•°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">isEven</span><span class="generics">&lt;T : IntegerType&gt;</span><span class="params">(a: T)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a % <span class="number">2</span> == <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è¿™æ ·:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> isEven(x) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="literal">true</span>: <span class="built_in">print</span>(<span class="string">"even"</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="literal">false</span>: <span class="built_in">print</span>(<span class="string">"odd"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å†™æˆè¿™æ ·:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> isEven: <span class="built_in">print</span>(<span class="string">"even"</span>)</span><br><span class="line"><span class="keyword">default</span>: <span class="built_in">print</span>(<span class="string">"odd"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æ³¨æ„<code>default</code>é€‰é¡¹ã€‚ä»¥ä¸‹ä»£ç æ— æ³•æ­£å¸¸å·¥ä½œï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> x &#123;</span><br><span class="line"><span class="keyword">case</span> isEven: <span class="built_in">print</span>(<span class="string">"even"</span>)</span><br><span class="line"><span class="keyword">case</span> isOdd: <span class="built_in">print</span>(<span class="string">"odd"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error: Switch must be exhaustive, consider adding a default clause</span></span><br></pre></td></tr></table></figure>
<h1 id="å­—ç¬¦ä¸²åŒ¹é…">å­—ç¬¦ä¸²åŒ¹é…</h1><p>è¿™å„¿æœ‰ä¸€ä¸ªæ›´å®é™…çš„ä¾‹å­ï¼Œå‡è®¾ä½ æƒ³æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«å‰ç¼€æˆ–è€…æ˜¯åç¼€ã€‚æˆ‘ä»¬å…ˆå†™ä¸¤ä¸ªå‡½æ•°ï¼Œ<code>hasPrefix</code>å’Œ<code>hasSuffix</code>ï¼Œå°†ä¸¤ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå®ƒä»¬çš„å‚æ•°ï¼Œæ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯ç¬¬äºŒä¸ªå‚æ•°çš„å‰ç¼€æˆ–è€…åç¼€ã€‚è¿™äº›åªæ˜¯æ”¹å˜äº†ä¸€ä¸‹æ ‡å‡†åº“ä¸­å·²ç»å­˜åœ¨çš„<a href="https://developer.apple.com/library/ios/documentation/Swift/Reference/Swift_String_Structure/index.html#//apple_ref/swift/structm/String/s:FSS9hasPrefixFSSFSSSb" target="_blank" rel="external"><code>String.hasPrefix</code></a>å’Œ<a href="https://developer.apple.com/library/ios/documentation/Swift/Reference/Swift_String_Structure/index.html#//apple_ref/swift/structm/String/s:FSS9hasSuffixFSSFSSSb" target="_blank" rel="external"><code>String.hasSuffix</code></a>æ–¹æ³•â€”â€”æŠŠå‚æ•°æ’äº†ä¸‹é¡ºåºï¼ˆå‰ç¼€/åç¼€ä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå…¨å­—ç¬¦ä¸²ä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼‰ã€‚å¦‚æœä½ ä½¿ç”¨<code>Partial Applied Function</code>ï¼ˆååº”ç”¨å‡½æ•°ï¼Œå¯ä»¥ç¼ºå°‘éƒ¨åˆ†å‚æ•°çš„å‡½æ•°ï¼‰ä¼ é€’ç»™å…¶ä»–çš„å‡½æ•°çš„æƒ…å†µå¾ˆå¤šï¼Œä½ ä¼šå‘ç°ä½ ç»å¸¸å¾—å»é€‚é…è¢«è°ƒç”¨çš„æ¥å£ã€‚è¿™å¯èƒ½è®©äººè§‰å¾—å¾ˆçƒ¦ï¼Œä½†è¿™ä¹Ÿä¸ä¼šå¾ˆéš¾ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">hasPrefix</span><span class="params">(<span class="keyword">prefix</span>: String)</span></span>(value: <span class="type">String</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> value.hasPrefix(<span class="keyword">prefix</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">hasSuffix</span><span class="params">(suffix: String)</span></span>(value: <span class="type">String</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> value.hasSuffix(suffix)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æˆ‘çœ‹æ¥ï¼Œä»¥ä¸‹å®ç°æ–¹å¼å¤§å¤§æé«˜äº†ä»£ç å¯è¯»æ€§:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span><br><span class="line"><span class="keyword">switch</span> str &#123;</span><br><span class="line"><span class="keyword">case</span> hasPrefix(<span class="string">"B"</span>), hasPrefix(<span class="string">"C"</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Starts with B or C"</span>)</span><br><span class="line"><span class="keyword">case</span> hasPrefix(<span class="string">"D"</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Starts with D"</span>)</span><br><span class="line"><span class="keyword">case</span> hasSuffix(<span class="string">"Z"</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Ends with Z"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Something else"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“">æ€»ç»“</h2><p>é’ˆå¯¹æˆ‘ä»¬æœ€åˆé—®é¢˜çš„ä¸€ä¸ªé€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬æå‡ºäº†å¯ä»¥åº”ç”¨äºå¾ˆå¤šä¸åŒçš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘å‘ç°è¿™ç§æƒ…å†µå¾ˆæ™®éï¼šå½“ä½ å°†å‡½æ•°ä½œä¸ºå€¼æ—¶å¯ä»¥åˆ°å¤„ä¼ é€’å¹¶ä¸”é€šå¸¸ç”¨äºä½ ä¸æƒ³ä½¿ç”¨å®ƒä»¬çš„åœ°æ–¹ã€‚å‡½æ•°å¼ç¼–ç¨‹æé«˜äº†ä»£ç çš„å¯ç»„åˆæ€§ï¼Œè¿™æ˜¯åœ¨å‚æ•°ä½¿ç”¨çš„ä¸€ä¸ªæ ¸å¿ƒç†å¿µã€‚</p>
<p>åœ¨å†…ç½®çš„æ•°æ®ç±»å‹æˆ–è€…æ˜¯ä½ è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥ç»™Swiftçš„æ¨¡å¼åŒ¹é…ç³»ç»Ÿæ‰©å±•å‡ºå¯ä»¥éå¸¸å¼ºå¤§çš„æ–°åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œè¯·ä¸è¦è¿‡åº¦åœ°å»æ‰©å±•ã€‚è™½ç„¶å®ƒçœ‹èµ·æ¥æ¯”åŸå§‹çš„è§£å†³æ–¹æ¡ˆæ›´åŠ æ¸…æ™°ï¼Œä½†æ˜¯å¯¹é‚£äº›ä¸ç†Ÿæ‚‰å®ƒçš„äººæ¥è¯´ï¼Œè‡ªå®šä¹‰çš„è¯­æ³•ä¼šä½¿ä½ çš„ä»£ç å¯è¯»æ€§å˜å·®ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="http://oleb.net/blog/2015/09/swift-pattern-matching/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-18<br>è¯‘è€…ï¼š<a href="undefined">lfb-CD</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao">åƒå¶çŸ¥é£</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<h1 id="Swiftä¸­çš„æ¨¡å¼åŒ¹é…">Swiftä¸­çš„æ¨¡å¼åŒ¹é…</h1><p>æ›´æ–°:<br>2015.9.19: æ·»åŠ äº†ä¸€äº›å…³äºSwiftè¯­æ³•é—®é¢˜çš„ç¬”è®°ã€‚æŠŠè‡ªå®šä¹‰æ“ä½œç¬¦çš„ç¬¦å·æ”¹ä¸ºäº†ä¸€ä¸ªæˆ‘è®¤ä¸ºæ›´åŠ é€‚åˆçš„ã€‚åœ¨æ€»ç»“ä¸­æ·»åŠ äº†ä¸€äº›å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„æƒ³æ³•ã€‚<br>2015.9.25: æ·»åŠ äº†å…³äºæ ‡å‡†åº“ä¸­å·²ç»å­˜åœ¨çš„<code>~&gt;</code>æ“ä½œç¬¦çš„ç¬”è®°<br>]]>
    
    </summary>
    
      <category term="Ole Begemann" scheme="http://swiftggteam.github.io/tags/Ole-Begemann/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[WatchOS 2: Hello, World]]></title>
    <link href="http://swiftggteam.github.io/2015/10/15/watchos-2-hello-world/"/>
    <id>http://swiftggteam.github.io/2015/10/15/watchos-2-hello-world/</id>
    <published>2015-10-15T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="http://natashatherobot.com/watchos-2-hello-world/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-21<br>è¯‘è€…ï¼š<a href="http://daizi.me" target="_blank" rel="external">å°è¢‹å­</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>æ¬¢è¿å­¦ä¹ æˆ‘çš„<code>WatchOS 2</code>ç³»åˆ—æ•™ç¨‹ã€‚æˆ‘ä¼šä»æœ€ç®€å•çš„éƒ¨åˆ†å¼€å§‹å¸¦ä½ å­¦ä¹ <code>WatchOS 2</code>ã€‚ä¸€ä¸ª â€œHello,Worldâ€ appï¼Œæ²¡é”™ï¼Œè¿™ä¸ªç¨‹åºè™½ç„¶éå¸¸ç®€å•ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p>
<a id="more"></a>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„<code>Single View Application</code>ã€‚æˆ‘å°†å‡è®¾ä½ å·²ç»çŸ¥é“å¦‚ä½•åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„<code>Xcode</code>é¡¹ç›®ã€‚ç°åœ¨è¿›å…¥æœ‰è¶£çš„éƒ¨åˆ†ï¼š</p>
<ol>
<li>åœ¨ <code>Xcode</code> ä¸­, æ‰“å¼€ <code>File -&gt; New -&gt; Target</code></li>
</ol>
<p><img src="/img/articles/watchos-2-hello-world/Screen_Shot_2015-09-21_at_7_23_42_AM.png1444874958.106001" alt=""></p>
<ol>
<li>é€‰æ‹©<code>watchOS -&gt; Application</code>ã€‚æ³¨æ„åœ¨<code>iOS</code>èœå•ä¸‹é¢æœ‰ä¸€ä¸ª<code>Apple Watch</code>é€‰é¡¹ã€‚ä¸è¦é€‰æ‹©è¿™ä¸ªé€‰é¡¹ï¼å› ä¸ºæˆ‘æ›¾ç»åšè¿‡ <code>WatchKit apps</code>ï¼Œæ‰€ä»¥ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©äº†è¿™ä¸ªé”™è¯¯çš„é€‰é¡¹ :( ã€‚</li>
</ol>
<p><img src="/img/articles/watchos-2-hello-world/ItsAWatchWorld_xcodeproj.png1444874960.646429" alt=""></p>
<ol>
<li>é€‰æ‹©<code>WatchKit App</code> ç„¶åç‚¹å‡»<code>Next</code>ã€‚æ³¨æ„<strong>ä½ çš„ Watch App é¡¹ç›®åç§°ä¸èƒ½å’Œ iOS åç§°ç›¸åŒ</strong> - å› ä¸ºè¿™ä¼šåˆ›å»ºä¸¤ä¸ªåå­—ç›¸åŒçš„<code>target</code>ï¼ä½ å¯ä»¥éšæ—¶åœ¨<code>Info.plist</code>ä¸­ä¿®æ”¹<code>Bundle Display Name</code>ã€‚åŒæ—¶è¿˜è¦æ³¨æ„ï¼Œä¸è¦å‹¾é€‰<code>Include Complication</code>é€‰é¡¹ :) ã€‚</li>
</ol>
<p><img src="/img/articles/watchos-2-hello-world/Screenshot_9_21_15__7_35_AM.png1444874962.648526" alt=""></p>
<ol>
<li>ç‚¹å‡»<code>Finish</code>ã€‚å°±é…±ï¼æ¥çœ‹ä¸€ä¸‹ä½ çš„æ–° <code>App</code> å’Œ <code>Extension</code> å§ã€‚è·Ÿ <code>WatchKit</code> ä¸€æ ·ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç”¨äº Watch çš„ <code>target</code>ï¼Œå¹¶ä¸”é™„å¸¦äº†ä¸€ä¸ª <code>Storyboard</code>ï¼Œä»¥åŠç”¨äºç¼–å†™ç¨‹åºé€»è¾‘çš„ <code>Extension</code>ã€‚</li>
</ol>
<p><img src="/img/articles/watchos-2-hello-world/Menubar_and_ItsAWatchWorld_xcodeproj_and_MyPlayground_6_36_06_PM_playground.png1444874964.5578082" alt=""></p>
<p>å¼€å¿ƒåœ°ç¼–ç¨‹å§ï¼ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="http://natashatherobot.com/watchos-2-hello-world/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-21<br>è¯‘è€…ï¼š<a href="http://daizi.me">å°è¢‹å­</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.swiftyper.com/">å°é”…</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>æ¬¢è¿å­¦ä¹ æˆ‘çš„<code>WatchOS 2</code>ç³»åˆ—æ•™ç¨‹ã€‚æˆ‘ä¼šä»æœ€ç®€å•çš„éƒ¨åˆ†å¼€å§‹å¸¦ä½ å­¦ä¹ <code>WatchOS 2</code>ã€‚ä¸€ä¸ª â€œHello,Worldâ€ appï¼Œæ²¡é”™ï¼Œè¿™ä¸ªç¨‹åºè™½ç„¶éå¸¸ç®€å•ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p>]]>
    
    </summary>
    
      <category term="Natasha the Robot" scheme="http://swiftggteam.github.io/tags/Natasha-the-Robot/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Xcode6 ä¸­æ¨¡ç‰ˆçš„ä»‹ç»]]></title>
    <link href="http://swiftggteam.github.io/2015/10/14/templates-in-xcode-6/"/>
    <id>http://swiftggteam.github.io/2015/10/14/templates-in-xcode-6/</id>
    <published>2015-10-14T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šThomas Hanningï¼Œ<a href="http://www.thomashanning.com/templates-in-xcode-6/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-08-27<br>è¯‘è€…ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a>ï¼›æ ¡å¯¹ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
</blockquote>
<p><code>Xcode</code> ä¸ºæˆ‘ä»¬æä¾›ä¸€æ•´å¥—çš„é¡¹ç›®æ¨¡æ¿ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹è¿™äº›æ¨¡ç‰ˆè¿›è¡Œè®¨è®ºã€‚</p>
<a id="more"></a>
<h3 id="ä¸»-ä»è§†å›¾åº”ç”¨ç¨‹åº(Master-Detail_Application)">ä¸»-ä»è§†å›¾åº”ç”¨ç¨‹åº(Master-Detail Application)</h3><blockquote>
<p>è¿™ç§æ¨¡ç‰ˆæä¾›äº†ä¸»-ä»è§†å›¾åº”ç”¨ç¨‹åºçš„å…¥å£ã€‚å®ƒæä¾›ä¸€ä¸ªç”±å¯¼èˆªæ§åˆ¶å™¨æ§åˆ¶çš„ç”¨æˆ·ç•Œé¢ï¼Œç”¨äºæ˜¾ç¤ºä¸€ç»„é¡¹ç›®ï¼Œåœ¨ iPad ä¸­ï¼Œåˆ™æ˜¾ç¤ºä¸ºåˆ†å‰²è§†å›¾ï¼ˆsplit viewï¼‰ã€‚</p>
<p>-Apple</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªå¯¹å­¦ä¹ åˆ†å‰²è§†å›¾æ§åˆ¶å™¨(<code>split view controllers</code>)å’Œåˆ—è¡¨è§†å›¾æ§åˆ¶å™¨(<code>table view controllers</code>)åŸºç¡€çŸ¥è¯†å¾ˆæœ‰å¸®åŠ©çš„æ¨¡ç‰ˆã€‚å¦‚æœä½ åªåœ¨ <code>iPhone</code> è®¾å¤‡ä¸­ä½¿ç”¨ï¼Œè¯¥æ¨¡ç‰ˆä¸­çš„åˆ†å‰²è§†å›¾æ§åˆ¶å™¨å°†ä¸èµ·ä½œç”¨ï¼Œåªèƒ½ä½¿ç”¨å¯¼èˆªæ§åˆ¶å™¨æ¥å¯¼èˆªçš„ä¸»-ä»è§†å›¾æ§åˆ¶å™¨ã€‚è¿™ç§è§†å›¾å¯¹äºæ–°æ‰‹å¼€å‘è€…æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ã€‚</p>
<p><img src="/img/articles/templates-in-xcode-6/Bildschirmfoto-2015-08-25-um-18.28.35.png1444784411.7165086" alt="icon"></p>
<h3 id="Page_Based_åº”ç”¨ç¨‹åº">Page Based åº”ç”¨ç¨‹åº</h3><blockquote>
<p>è¿™ç§æ¨¡æ¿æä¾›äº†ä¸€ä¸ª page-based åº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œè¯¥æ¨¡ç‰ˆä½¿ç”¨ä¸€ä¸ªé¡µé¢è§†å›¾æ§åˆ¶å™¨ï¼ˆ<code>page base viewcontroller</code>ï¼‰</p>
<p>-Apple</p>
</blockquote>
<p>è¿™ä¸ªæ¨¡ç‰ˆæœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæœ‰12ä¸ªé¡µé¢çš„é¡µé¢è§†å›¾æ§åˆ¶å™¨ã€‚åŒæ ·çš„ï¼Œè¿™ç§æ¨¡æ¿å¯¹äºå­¦ä¹ åŸºæœ¬çš„ iOS å¼€å‘ä¹Ÿæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚</p>
<p><img src="/img/articles/templates-in-xcode-6/Bildschirmfoto-2015-08-25-um-18.40.16.png1444784413.1235225" alt="icon"></p>
<h3 id="å•è§†å›¾åº”ç”¨ç¨‹åºï¼ˆSingle_View_Applicationï¼‰">å•è§†å›¾åº”ç”¨ç¨‹åºï¼ˆSingle View Applicationï¼‰</h3><p>è¿™æ˜¯æœ€åŸºç¡€çš„æ¨¡ç‰ˆã€‚</p>
<blockquote>
<p>è¿™ä¸ªæ¨¡ç‰ˆæä¾›äº†ä½¿ç”¨å•è§†å›¾åº”ç”¨çš„å…¥å£ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨å»ç®¡ç†è§†å›¾å’ŒåŒ…å«è¿™ä¸ªè§†å›¾çš„ storyboard æˆ– nibã€‚</p>
<p>-Apple</p>
</blockquote>
<p>å®ƒä¸ä»…ä»…æ˜¯åªç”¨åœ¨å•è§†å›¾åº”ç”¨ç¨‹åºï¼Œè€Œä¸”è¿˜æ˜¯å¤æ‚åº”ç”¨ç¨‹åºæœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æœä½ æƒ³ä¸€åˆ‡å°½åœ¨ä½ çš„æŒæ¡ä¸­ï¼Œè¿™ç§æ¨¡æ¿æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ å¾ˆå¤šåº”ç”¨ç¨‹åºéƒ½ä¼šé€‰æ‹©è¿™ç§æ¨¡ç‰ˆã€‚</p>
<h1 id="Tabbed_åº”ç”¨ç¨‹åº">Tabbed åº”ç”¨ç¨‹åº</h1><blockquote>
<p>è¿™ç§æ¨¡ç‰ˆæä¾›é€‰é¡¹å¡(tab bar)åº”ç”¨ç¨‹åºçš„å…¥å£ã€‚å®ƒæä¾›äº†ç”¨æˆ·ç•Œé¢ï¼Œç”¨æ¥é…ç½®é€‰é¡¹å¡æ§åˆ¶å™¨å’Œå¯¹åº”é¡¹çš„è§†å›¾æ§åˆ¶å™¨ã€‚</p>
</blockquote>
<p>è¿™æ˜¯éå¸¸åŸºç¡€çš„æ¨¡ç‰ˆï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªå«æœ‰ä¸¤ä¸ªè§†å›¾æ§åˆ¶å™¨çš„é€‰é¡¹å¡(<code>tab bar</code>)æ§åˆ¶å™¨ã€‚</p>
<p><img src="/img/articles/templates-in-xcode-6/Bildschirmfoto-2015-08-25-um-18.42.57.png1444784413.9353302" alt="icon"></p>
<h1 id="Game">Game</h1><blockquote>
<p>è¿™ç§æ¨¡ç‰ˆæä¾›äº†æ¸¸æˆå¼€å‘çš„å…¥å£ã€‚</p>
<p>-Apple</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„æ¨¡ç‰ˆã€‚ä½ å¯ä»¥é€‰æ‹© <code>SceneKit</code>, <code>SpriteKit</code>, <code>Open GL ES</code> æˆ– <code>Metal</code> çš„æ¨¡ç‰ˆã€‚å¦‚æœä½ æƒ³äº†è§£æ¸¸æˆå¼€å‘ï¼Œè¿™ç§æ¨¡ç‰ˆå¯ä»¥è®©ä½ æœ‰ä¸€ä¸ªå¥½çš„å¼€å§‹ã€‚</p>
<p><img src="/img/articles/templates-in-xcode-6/Bildschirmfoto-2015-08-25-um-18.45.48.png1444784414.774583" alt="icon"></p>
<h1 id="æ€»ç»“">æ€»ç»“</h1><p>æ¨¡ç‰ˆæ˜¯å­¦ä¹ å…³äº iOS å¼€å‘åŸºç¡€çŸ¥è¯†æœ€å¥½çš„ä¸€ç§æ–¹å¼ã€‚ç„¶è€Œå¯¹äºå®é™…çš„é¡¹ç›®ä½ åº”è¯¥æ›´å¤šçš„ä½¿ç”¨ â€œå•è§†å›¾åº”ç”¨ç¨‹åº(<code>Single View Application</code>)â€ æ¨¡ç‰ˆï¼Œå› ä¸ºä½¿ç”¨è¿™ç§æ¨¡ç‰ˆæœ€å®¹æ˜“æ­å»ºä½ çš„é¡¹ç›®æ¶æ„ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šThomas Hanningï¼Œ<a href="http://www.thomashanning.com/templates-in-xcode-6/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-08-27<br>è¯‘è€…ï¼š<a href="https://github.com/chenmingbiao">CMB</a>ï¼›æ ¡å¯¹ï¼š<a href="http://codebuild.me/">shanks</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
</blockquote>
<p><code>Xcode</code> ä¸ºæˆ‘ä»¬æä¾›ä¸€æ•´å¥—çš„é¡¹ç›®æ¨¡æ¿ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹è¿™äº›æ¨¡ç‰ˆè¿›è¡Œè®¨è®ºã€‚</p>]]>
    
    </summary>
    
      <category term="Thomas Hanning" scheme="http://swiftggteam.github.io/tags/Thomas-Hanning/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[try? çš„æ›¿ä»£å®ç°]]></title>
    <link href="http://swiftggteam.github.io/2015/10/13/alternatives-to-try-swiftlang/"/>
    <id>http://swiftggteam.github.io/2015/10/13/alternatives-to-try-swiftlang/</id>
    <published>2015-10-13T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šErica Sadunï¼Œ<a href="http://ericasadun.com/2015/09/03/alternatives-to-try-swiftlang/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-03<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/nsnirvana" target="_blank" rel="external">æˆ‘åç¬‘</a>ï¼›æ ¡å¯¹ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="external">åƒå¶çŸ¥é£</a></p>
</blockquote>
<p><code>tryï¼Ÿ</code> è¯­æ³•çš„ä¼˜ç‚¹åœ¨äºä½ ä¸å¿…æŠŠå¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯çš„å‡½æ•°å†™åœ¨ä¸€ä¸ª <code>do-catch</code> ä»£ç å—å½“ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨äº† <code>try?</code>ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼å°±ä¼šæ˜¯ä¸€ä¸ªå¯é€‰ç±»å‹ï¼šæˆåŠŸè¿”å› <code>.Some</code>ï¼Œå¤±è´¥åˆ™è¿”å› <code>.None</code>ã€‚ä½ å¯ä»¥é…åˆç€ <code>if-let</code> æˆ–è€… <code>guard</code> è¯­å¥æ¥ä½¿ç”¨ <code>try?</code> è¯­æ³•ã€‚<br><a id="more"></a><br><code>try?</code> è¯­æ³•çš„ä¸è¶³åˆ™åœ¨äºå®ƒå¯¹é”™è¯¯çš„ç®€åŒ–ï¼Œè®©ä½ éš¾ä»¥äº†è§£åˆ°é”™è¯¯æ˜¯ä»€ä¹ˆä»¥åŠé”™è¯¯å‘ç”Ÿçš„æ—¶é—´ã€‚è¿™å¯ä¸æ˜¯ä»¶å¥½äº‹ã€‚</p>
<p>ä½†ä½ å¯ä»¥è¯•ç€è‡ªå·±å†™å‡º <code>try?</code> çš„æ›¿ä»£æ–¹æ³•ã€‚æ¯”å¦‚å®ç°ä¸€ä¸ªç®€å•çš„æšä¸¾<code>Result</code>ï¼š</p>
<pre><code><span class="class"><span class="keyword">enum</span> <span class="title">Result</span>&lt;<span class="title">T</span>&gt; {</span>
    <span class="keyword">case</span> <span class="constant">Value</span>(<span class="constant">T</span>)
    <span class="keyword">case</span> <span class="constant">Error</span>(<span class="constant">ErrorType</span>)
}
</code></pre><p>å°±åƒä¸Šé¢çš„ä»£ç å†™çš„é‚£æ ·ï¼Œæˆ‘å–œæ¬¢åˆ†æˆ <code>Value</code> å’Œ <code>Error</code> è€Œä¸æ˜¯ <code>err</code> å’Œ <code>ok</code> ï¼Œæšä¸¾çš„ä¸åŒçŠ¶æ€å¯ä»¥æŒ‰ä½ è‡ªå·±çš„å–œå¥½æ¥å‘½åã€‚</p>
<p>ç„¶åä½ å¯ä»¥å†™ä¸ªå‡½æ•°æ¥æ‰§è¡Œ <code>do-catch</code> è¯­å¥ï¼Œç„¶åæŠŠæ‰§è¡Œç»“æœåŒ…å«åœ¨ä¸Šé¢å®šä¹‰çš„æšä¸¾ä¸­è¿”å›ã€‚</p>
<pre><code><span class="func"><span class="keyword">func</span> <span class="title">tryit</span><span class="generics">&lt;T&gt;</span><span class="params">(block: <span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span>) -&gt; <span class="type">Result</span>&lt;<span class="type">T</span>&gt; {
    <span class="keyword">do</span> {
        <span class="keyword">let</span> value = <span class="keyword">try</span> block()
        <span class="keyword">return</span> <span class="type">Result</span>.<span class="type">Value</span>(value)
    } <span class="keyword">catch</span> {<span class="keyword">return</span> <span class="type">Result</span>.<span class="type">Error</span>(error)}
}
</code></pre><p>å®é™…ä¸Šæˆ‘ä¹Ÿä¸å¤ªå–œæ¬¢ tryit è¿™ä¸ªåå­—ï¼Œä½ å¯ä»¥ä½ å–œæ¬¢çš„åå­—ä»£æ›¿ã€‚</p>
<p>è¿™ä¸ªå‡½æ•°çš„è°ƒç”¨æœ‰ç‚¹å•°å—¦ã€‚åŸæ¥çš„å†™æ³•æ˜¯ï¼š</p>
<pre><code><span class="keyword">let</span> <span class="literal">result</span> = <span class="keyword">try</span> myFailableCoinToss()
</code></pre><p>æ–°çš„å†™æ³•æ˜¯ï¼š</p>
<p><del><code>let result = tryit{try myFailableCoinToss()}</code></del> <em>æ„Ÿè°¢bigonotetakeræŒ‡å‡ºé”™è¯¯</em><br><code>let result = tryit(myFailableCoinToss)</code></p>
<p>è¯»è€…glessardæä¾›ç»™æˆ‘ä¸€ä¸ªå¾ˆæ£’çš„æ›¿ä»£æ–¹å¼ï¼Œå»ºè®®æˆ‘ç»™<code>Result</code>æ·»åŠ ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•è€Œä¸æ˜¯ç”¨ tryitï¼š</p>
<pre><code><span class="class"><span class="keyword">enum</span> <span class="title">Result</span>&lt;<span class="title">T</span>&gt; {</span>
    <span class="keyword">case</span> <span class="constant">Value</span>(<span class="constant">T</span>)
    <span class="keyword">case</span> <span class="constant">Error</span>(<span class="constant">ErrorType</span>)

    init(_ <span class="symbol">block:</span> () throws -&gt; <span class="constant">T</span>) {
        <span class="keyword">do</span> {
            let value = try block()
            <span class="keyword">self</span> = <span class="constant">Result</span>.<span class="constant">Value</span>(value)
        } catch {
            <span class="keyword">self</span> = <span class="constant">Result</span>.<span class="constant">Error</span>(error)
        }
    }
}
</code></pre><p>ç„¶åä½ ç›´æ¥è¿™ä¹ˆè°ƒç”¨å°±è¡Œäº†ï¼š</p>
<pre><code><span class="keyword">let</span> <span class="literal">result</span> = <span class="type">Result</span>(myFailableCoinToss)
</code></pre><p>ä½ éœ€è¦ç”¨ <code>if-let</code> å’Œ <code>guard</code> ä¹‹å¤–çš„è¯­å¥æ¥æ‹†åŒ…ä½ çš„è¿”å›å€¼ï¼Œå¯ä»¥ç”¨ <code>switch</code>ï¼š</p>
<p><del><code>let result = tryit{try myFailableCoinToss()}</code></del><br>    let result = tryit(myFailableCoinToss)<br>    switch result {<br>    case .Value(let value): print(â€œSuccess:â€, value)<br>    case .Error(let error): print(â€œFailure:â€, error)<br>    }</p>
<p>æˆ–è€…ç›´æ¥ç”¨æ¨¡å¼åŒ¹é…ï¼š</p>
<pre><code><span class="keyword">if</span> <span class="keyword">case</span> .<span class="type">Value</span>(<span class="keyword">let</span> value) = <span class="literal">result</span> {
    print(<span class="string">"Success:"</span>, value)
} <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">case</span> .<span class="type">Error</span>(<span class="keyword">let</span> error) = <span class="literal">result</span> {
    print(<span class="string">"Failure:"</span>, error)
}
</code></pre><p>ä½ ä¹Ÿå¯ä»¥æ·»åŠ ä¸€äº›é€€å‡ºä½œç”¨åŸŸçš„ä»£ç æ¥æ¨¡ä»¿ <code>guard</code>ï¼Œè¿™çš„ç¡®å¯è¡Œï¼Œä½†æ˜¯ä»£ç å¤ªéš¾çœ‹äº†ã€‚</p>
<pre><code><span class="class"><span class="keyword">enum</span> <span class="title">Result</span>&lt;<span class="title">T</span>&gt; </span>{
    <span class="keyword">case</span> <span class="type">Value</span>(<span class="type">T</span>)
    <span class="keyword">case</span> <span class="type">Error</span>(<span class="type">ErrorType</span>)

    <span class="func"><span class="keyword">func</span> <span class="title">unwrap</span><span class="params">()</span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span> {
        <span class="keyword">if</span> <span class="keyword">case</span> .<span class="type">Value</span>(<span class="keyword">let</span> value) = <span class="keyword">self</span> {<span class="keyword">return</span> value}
        <span class="keyword">throw</span> <span class="string">"Unable to unwrap result"</span>
    }

    <span class="func"><span class="keyword">func</span> <span class="title">handleError</span><span class="params">(errorHandler: ErrorType -&gt; Void)</span></span> -&gt; <span class="type">Bool</span> {
        <span class="keyword">if</span> <span class="keyword">case</span> .<span class="type">Error</span>(<span class="keyword">let</span> error) = <span class="keyword">self</span> {
            errorHandler(error)
            <span class="keyword">return</span> <span class="literal">true</span>
        }
        <span class="keyword">return</span> <span class="literal">false</span>
    }
}

<span class="func"><span class="keyword">func</span> <span class="title">tryit</span><span class="generics">&lt;T&gt;</span><span class="params">(block: <span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span>) -&gt; <span class="type">Result</span>&lt;<span class="type">T</span>&gt; {
    <span class="keyword">do</span> {
        <span class="keyword">let</span> value = <span class="keyword">try</span> block()
        <span class="keyword">return</span> <span class="type">Result</span>.<span class="type">Value</span>(value)
    } <span class="keyword">catch</span> {<span class="keyword">return</span> <span class="type">Result</span>.<span class="type">Error</span>(error)}
}
</code></pre><p><del><code>let result = tryit{try myFailableCoinToss()}</code></del><br>    let result = tryit(myFailableCoinToss)</p>
<pre><code>// guard error
<span class="keyword">if</span> <span class="literal">result</span>.handleError({
    error <span class="keyword">in</span>
    print(<span class="string">"Error is \(error)"</span>)
}) {fatalError()} // leave scope on <span class="literal">true</span>

// force <span class="keyword">try</span> <span class="keyword">for</span> success <span class="keyword">case</span>
<span class="keyword">let</span> unwrappedResult = <span class="keyword">try</span>! <span class="literal">result</span>.unwrap()

// <span class="literal">result</span> <span class="keyword">is</span> now usable at top level scope
print(<span class="string">"Result is \(unwrappedResult)"</span>)
</code></pre><p>è¿™è¿˜æœ‰å¦å¤–ä¸€ç§æ›´åƒ <code>try?</code> çš„æ–¹å¼ï¼Œä½†æ˜¯éœ€è¦æ‰“å°äº†æ‰€æœ‰äº§ç”Ÿçš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<pre><code><span class="func"><span class="keyword">func</span> <span class="title">tryit</span><span class="generics">&lt;T&gt;</span><span class="params">(block: <span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span>) -&gt; <span class="type">Optional</span>&lt;<span class="type">T</span>&gt;{
    <span class="keyword">do</span> {
        <span class="keyword">return</span> <span class="keyword">try</span> block()
    } <span class="keyword">catch</span> {
        <span class="built_in">print</span>(error)
        <span class="keyword">return</span> <span class="literal">nil</span>
    }
}
</code></pre><p>è¿™ç§æ›¿ä»£ <code>try?</code> çš„æ–¹æ³•ä¸ä»…æ‹¥æœ‰äº† <code>if-let</code> å’Œ <code>guard</code> çš„è¯­å¥ç‰¹æ€§ï¼Œè¿˜èƒ½è¿”å›é”™è¯¯ã€‚ä½ å¯ä»¥ç”¨ä¹‹å‰<code>Result</code>è°ƒç”¨çš„æ–¹å¼ä½¿ç”¨å®ƒï¼š</p>
<p><del><code>let result = tryit{try myFailableCoinToss()}</code></del><br><code>let result = tryit(myFailableCoinToss)</code></p>
<p>ä½ ä»ç„¶ä¸èƒ½åŸºäºé”™è¯¯ç±»å‹å’Œé”™è¯¯ç»†èŠ‚æ¥åˆ¶å®šé”™è¯¯å¤„ç†ç­–ç•¥ï¼Œä½†æ˜¯è¿™ç§å®ç°æ–¹å¼ä¹Ÿä¸åƒ <code>try?</code> é‚£æ ·æŠŠé”™è¯¯ä¿¡æ¯å®Œå…¨ä¸¢å¼ƒæ‰äº†ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ä¿®æ”¹<code>tryit</code>å‡½æ•°ï¼Œè®©å®ƒä¹Ÿèƒ½æ¥å—åšé”™è¯¯å¤„ç†çš„<code>block</code>ï¼Œä½†å› ä¸ºä¼šæœ‰ä¸¤ä¸ªé—­åŒ…ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šå˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚æˆ‘å°è¯•è¿‡å‡ ç§ä¸åŒçš„å®ç°æ–¹å¼ï¼Œä½†éƒ½åšçš„ä¸å¤ªå¥½ï¼Œå°±ä¸åœ¨è¿™åˆ†äº«å‡ºæ¥äº†ã€‚æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œå°±ç®—ä½ æŠŠåšé”™è¯¯å¤„ç†çš„<code>block</code>ä¼ ç»™<code>tryit</code>äº†ï¼Œä½ ä¹Ÿä¸èƒ½åƒ <code>guard</code>è¯­å¥é‚£æ ·é€€å‡ºä½œç”¨åŸŸï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è¿™æ ·çš„<code>guard</code>çš„æ›¿ä»£å½¢å¼èƒ½æ¥å—<code>try?</code>çš„é”™è¯¯æ¥ä½œé€€å‡ºä½œç”¨åŸŸ<code>block</code>çš„å‚æ•°ã€‚</p>
<p>æˆ‘è§‰å¾—æˆ‘æœ€åå®ç°çš„åº”è¯¥ç±»ä¼¼äºä¸‹é¢çš„è¿™ç§å½¢å¼ï¼Œåœ¨é¡¶å±‚ä½œç”¨åŸŸä¸­æ‰§è¡Œæ¡ä»¶èµ‹å€¼ï¼Œå¹¶é‡‡ç”¨  <code>guard</code> è¯­å¥çš„æ–¹å¼æ¥æ›¿ä»£æ™®é€šçš„ <code>try</code>ï¼š</p>
<pre><code>guard <span class="keyword">let</span> <span class="literal">result</span> = <span class="keyword">try</span>!! myFailableCoinToss() <span class="keyword">else</span> {error <span class="keyword">in</span> ...}
</code></pre><p>ä¹‹æ‰€ä»¥è¿™ä¹ˆåšæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³çŸ¥é“æˆ‘ä»¬çš„ç¨‹åºåˆ°åº•ä¼šä¸ä¼šå‡ºé”™ï¼Œå¦‚æœä¸å‡ºé”™çš„è¯ï¼Œç›´æ¥å°±èƒ½å¾—åˆ°è¿”å›å€¼äº†ã€‚</p>
<pre><code><span class="keyword">let</span> <span class="literal">result</span> = <span class="keyword">try</span> myFailableCoinToss()
</code></pre><p>åœ¨å½“å‰çš„çŠ¶æ€ä¸‹ï¼Œå¦‚æœè¦ç”¨ <code>try</code> ï¼ˆè€Œä¸”åˆéœ€è¦è¿›è¡Œé”™è¯¯å¤„ç†çš„è¯ï¼‰ï¼Œä½ å°±å¿…é¡»å¾—ç”¨ <code>do-catch</code> æˆ–è€…åƒ<code>Result</code>æšä¸¾ä¹‹ç±»çš„å˜é€šæ–¹æ³•ã€‚</p>
<p>éå¸¸æ„Ÿè°¢<a href="http://mikeash.com/" target="_blank" rel="external">Mike Ash</a>çš„å¸®å¿™ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šErica Sadunï¼Œ<a href="http://ericasadun.com/2015/09/03/alternatives-to-try-swiftlang/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-03<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/nsnirvana">æˆ‘åç¬‘</a>ï¼›æ ¡å¯¹ï¼š<a href="http://codebuild.me/">shanks</a>ï¼›å®šç¨¿ï¼š<a href="http://weibo.com/xiaoxxiao">åƒå¶çŸ¥é£</a></p>
</blockquote>
<p><code>tryï¼Ÿ</code> è¯­æ³•çš„ä¼˜ç‚¹åœ¨äºä½ ä¸å¿…æŠŠå¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯çš„å‡½æ•°å†™åœ¨ä¸€ä¸ª <code>do-catch</code> ä»£ç å—å½“ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨äº† <code>try?</code>ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼å°±ä¼šæ˜¯ä¸€ä¸ªå¯é€‰ç±»å‹ï¼šæˆåŠŸè¿”å› <code>.Some</code>ï¼Œå¤±è´¥åˆ™è¿”å› <code>.None</code>ã€‚ä½ å¯ä»¥é…åˆç€ <code>if-let</code> æˆ–è€… <code>guard</code> è¯­å¥æ¥ä½¿ç”¨ <code>try?</code> è¯­æ³•ã€‚<br>]]>
    
    </summary>
    
      <category term="Erica Sadun" scheme="http://swiftggteam.github.io/tags/Erica-Sadun/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¦‚ä½•åœ¨ Swift ä¸­æµ‹è¯• UIAlertController]]></title>
    <link href="http://swiftggteam.github.io/2015/10/12/how-to-test-uialertcontroller-in-swift/"/>
    <id>http://swiftggteam.github.io/2015/10/12/how-to-test-uialertcontroller-in-swift/</id>
    <published>2015-10-12T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šdomï¼Œ<a href="http://swiftandpainless.com/how-to-test-uialertcontroller-in-swift/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-18<br>è¯‘è€…ï¼š<a href="undefined">DianQK</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/linusling" target="_blank" rel="external">å°é“åŒ Linus</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
</blockquote>
<p>æœ€è¿‘æˆ‘è¯»äº†ä¸€ç¯‡åœ¨ Objective-C ä¸­ä½¿ç”¨ control swizzling æµ‹è¯•<code>UIAlertController</code>çš„<a href="http://qualitycoding.org/testing-uialertcontrollers/" target="_blank" rel="external">æ–‡ç« </a>ã€‚è¿™æ ·çš„æ–‡ç« æ€»æ˜¯ä¿ƒä½¿æˆ‘å¯»æ‰¾ä¸€ç§ä¸ä½¿ç”¨ control swizzling ä¹Ÿå¯ä»¥æµ‹è¯•åŒæ ·ä¸œè¥¿çš„æ–¹æ³•ã€‚è™½ç„¶ï¼Œæˆ‘çŸ¥é“ swizzling æ˜¯å¼€å‘è€…çš„ä¸€ä¸ªéå¸¸æœ‰åŠ›çš„å·¥å…·ï¼Œä½†æˆ‘ä¸ªäººæ˜¯å°½å¯èƒ½å»é¿å…å»ä½¿ç”¨å®ƒçš„ã€‚äº‹å®ä¸Šï¼Œåœ¨æœ€è¿‘çš„å…­å¹´æ—¶é—´é‡Œï¼Œæˆ‘åªåœ¨ä¸€ä¸ªåº”ç”¨ä¸Šç”¨äº† swizzlingã€‚æ‰€ä»¥æˆ‘ç›¸ä¿¡æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸ä½¿ç”¨ swizzling æ¥å®ç°æµ‹è¯•ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åœ¨ Swift ä¸­ä¸ä½¿ç”¨ swizzling æ¥å¯¹<code>UIAlertController</code> è¿›è¡Œæµ‹è¯•ï¼Ÿ</p>
<a id="more"></a>
<p>æˆ‘ä»¬å…ˆä»æˆ‘ä»¬è¦æµ‹è¯•çš„ä»£ç å¼€å§‹å§ã€‚æˆ‘å·²ç»æ·»åŠ ä¸€ä¸ªæŒ‰é’®åˆ° Storyboard ä¸­ã€‚ï¼ˆæˆ‘ä¹‹æ‰€ä»¥ä½¿ç”¨ Storyboard ä¸ºäº†è®©é‚£äº›ä¸æƒ³ç”¨ä»£ç å†™ç•Œé¢çš„å°ä¼™ä¼´æœ‰ä¸ªæ›´ç›´è§‚çš„æ„Ÿå—ï¼‰å½“æŒ‰ä¸‹è¿™ä¸ªæŒ‰é’®å°±ä¼šå‡ºç°ä¸€ä¸ªå¼¹çª—(alert)ï¼Œå®ƒæœ‰æ ‡é¢˜ã€æ¶ˆæ¯å†…å®¹ï¼Œè¿˜æœ‰ä¸¤ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«æ˜¯ OK å’Œå–æ¶ˆ(Cancel)ã€‚ä¸‹é¢æ˜¯è¿™æ®µä»£ç ï¼š   </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> actionString: <span class="type">String</span>?</span><br><span class="line">  </span><br><span class="line">  <span class="preprocessor">@IBAction</span> <span class="func"><span class="keyword">func</span> <span class="title">showAlert</span><span class="params">(sender: UIButton)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> alertViewController = <span class="type">UIAlertController</span>(title: <span class="string">"Test Title"</span>, message: <span class="string">"Message"</span>, preferredStyle: .<span class="type">Alert</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> okAction = <span class="type">UIAlertAction</span>(title: <span class="string">"OK"</span>, style: .<span class="type">Default</span>) &#123; (action) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span>.actionString = <span class="string">"OK"</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> cancelAction = <span class="type">UIAlertAction</span>(title: <span class="string">"Cancel"</span>, style: .<span class="type">Cancel</span>) &#123; (action) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span>.actionString = <span class="string">"Cancel"</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    alertViewController.addAction(cancelAction)</span><br><span class="line">    alertViewController.addAction(okAction)</span><br><span class="line">    </span><br><span class="line">    presentViewController(alertViewController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­å¼¹çª—åŠ¨ä½œæ²¡æœ‰åšä»€ä¹ˆå…·ä½“çš„æ“ä½œï¼Œä»–ä»¬åªè¡¨ç¤ºèƒ½éªŒè¯å•å…ƒæµ‹è¯•ã€‚</p>
<p>è®©æˆ‘ä»¬å¼€å§‹ä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼šæµ‹è¯•è¿™ä¸ªå¼¹çª—æ§åˆ¶å™¨çš„æ ‡é¢˜å’Œæ¶ˆæ¯å†…å®¹ã€‚</p>
<p>æµ‹è¯•çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> XCTest</span><br><span class="line"><span class="preprocessor">@testable</span> <span class="keyword">import</span> TestingAlertExperiment</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestingAlertExperimentTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> sut: <span class="type">ViewController</span>!</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">setUp</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.setUp()</span><br><span class="line">  </span><br><span class="line">    sut = <span class="type">UIStoryboard</span>(name: <span class="string">"Main"</span>, bundle: <span class="literal">nil</span>).instantiateInitialViewController() <span class="keyword">as</span>! <span class="type">ViewController</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">UIApplication</span>.sharedApplication().keyWindow?.rootViewController = sut</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">tearDown</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// Put teardown code here. This method is called after the invocation of each test method in the class.</span></span><br><span class="line">    <span class="keyword">super</span>.tearDown()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦è®¾ç½® sut ä¸ºæ ¹è§†å›¾æ§åˆ¶å™¨ï¼Œå¦åˆ™è§†å›¾æ§åˆ¶å™¨ä¸èƒ½å¼¹å‡ºè¿™ä¸ªå¼¹çª—è§†å›¾æ§åˆ¶å™¨ã€‚</p>
<p>æ·»åŠ  UIAlertController æµ‹è¯•æ ‡é¢˜çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">testAlert_HasTitle</span><span class="params">()</span></span> &#123;</span><br><span class="line">  sut.showAlert(<span class="type">UIButton</span>())</span><br><span class="line">    </span><br><span class="line">  <span class="type">XCTAssertTrue</span>(sut.presentedViewController <span class="keyword">is</span> <span class="type">UIAlertController</span>)</span><br><span class="line">  <span class="type">XCTAssertEqual</span>(sut.presentedViewController?.title, <span class="string">"Test Title"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å¾ˆç®€å•ã€‚ç°åœ¨è®©æˆ‘ä»¬æµ‹è¯• UIAlertController çš„å–æ¶ˆæŒ‰é’®ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šæ— æ³•è·å–å¼¹çª—åŠ¨ä½œçš„é—­åŒ…ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿå¼¹çª—åŠ¨ä½œï¼Œä¸ºäº†å­˜å‚¨è¿™ä¸ª handler å¹¶åœ¨æµ‹è¯•ä¸­è°ƒç”¨å®ƒï¼Œçœ‹å¼¹çª—åŠ¨ä½œæ˜¯å¦å’Œæˆ‘ä»¬é¢„æœŸçš„ä¸€æ ·ã€‚åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­æ·»åŠ è¿™æ ·ä¸€ä¸ªç±»ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MockAlertAction</span> : <span class="title">UIAlertAction</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">Handler</span> = ((<span class="type">UIAlertAction</span>) -&gt; <span class="type">Void</span>)</span><br><span class="line">  <span class="keyword">var</span> handler: <span class="type">Handler</span>?</span><br><span class="line">  <span class="keyword">var</span> mockTitle: <span class="type">String</span>?</span><br><span class="line">  <span class="keyword">var</span> mockStyle: <span class="type">UIAlertActionStyle</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">convenience</span> <span class="keyword">init</span>(title: <span class="type">String</span>?, style: <span class="type">UIAlertActionStyle</span>, handler: ((<span class="type">UIAlertAction</span>) -&gt; <span class="type">Void</span>)?) &#123;</span><br><span class="line">    <span class="keyword">self</span>.<span class="keyword">init</span>()</span><br><span class="line">    </span><br><span class="line">    mockTitle = title</span><br><span class="line">    mockStyle = style</span><br><span class="line">    <span class="keyword">self</span>.handler = handler</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">    mockStyle = .<span class="type">Default</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ¨¡æ‹Ÿç±»çš„ä¸»è¦å·¥ä½œæ˜¯æ•è· handler å—ï¼Œä»¥å¤‡åç”¨ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªæ¨¡æ‹Ÿçš„ç±»æ’å…¥åˆ°å®ç°ä»£ç ä¸­ã€‚å°†è§†å›¾æ§åˆ¶å™¨ä¸­çš„ä»£ç æ¢æˆä¸‹é¢è¿™ä¸ªï¼š   </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> <span class="type">Action</span> = <span class="type">UIAlertAction</span>.<span class="keyword">self</span></span><br><span class="line">  <span class="keyword">var</span> actionString: <span class="type">String</span>?</span><br><span class="line">  </span><br><span class="line">  <span class="preprocessor">@IBAction</span> <span class="func"><span class="keyword">func</span> <span class="title">showAlert</span><span class="params">(sender: UIButton)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> alertViewController = <span class="type">UIAlertController</span>(title: <span class="string">"Test Title"</span>, message: <span class="string">"Message"</span>, preferredStyle: .<span class="type">Alert</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> okAction = <span class="type">Action</span>.<span class="keyword">init</span>(title: <span class="string">"OK"</span>, style: .<span class="type">Default</span>) &#123; (action) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span>.actionString = <span class="string">"OK"</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> cancelAction = <span class="type">Action</span>.<span class="keyword">init</span>(title: <span class="string">"Cancel"</span>, style: .<span class="type">Cancel</span>) &#123; (action) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span>.actionString = <span class="string">"Cancel"</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    alertViewController.addAction(cancelAction)</span><br><span class="line">    alertViewController.addAction(okAction)</span><br><span class="line">    </span><br><span class="line">    presentViewController(alertViewController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªç±»å˜é‡<code>Action</code>ï¼Œå¹¶è®¾ç½®ä¸º<code>UIAlertAction.self</code>ã€‚è¿™ä¸ªå˜é‡æˆ‘ä»¬ä¼šåœ¨åˆå§‹åŒ–å¼¹çª—åŠ¨ä½œæ—¶ä½¿ç”¨ã€‚è¿™å°±èƒ½è®©æˆ‘ä»¬åœ¨æµ‹è¯•æ—¶å¯ä»¥é‡å†™å®ƒã€‚åƒè¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">testAlert_FirstActionStoresCancel</span><span class="params">()</span></span> &#123;</span><br><span class="line">  sut.<span class="type">Action</span> = <span class="type">MockAlertAction</span>.<span class="keyword">self</span></span><br><span class="line">  </span><br><span class="line">  sut.showAlert(<span class="type">UIButton</span>())</span><br><span class="line">  <span class="keyword">let</span> alertController = sut.presentedViewController <span class="keyword">as</span>! <span class="type">UIAlertController</span></span><br><span class="line">  <span class="keyword">let</span> action = alertController.actions.first <span class="keyword">as</span>! <span class="type">MockAlertAction</span></span><br><span class="line">  action.handler!(action)</span><br><span class="line">  </span><br><span class="line">  <span class="type">XCTAssertEqual</span>(sut.actionString, <span class="string">"Cancel"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæˆ‘ä»¬æ’å…¥äº†è¿™ä¸ªå¼¹çª—åŠ¨ä½œã€‚ä¹‹åæˆ‘ä»¬è°ƒç”¨ä»£ç å¼¹å‡ºå¼¹çª—è§†å›¾æ§åˆ¶å™¨ã€‚æˆ‘ä»¬ä»å‘ˆç°çš„è§†å›¾æ§åˆ¶å™¨ä¸­è·å–äº†å–æ¶ˆåŠ¨ä½œï¼Œå¹¶ä¸”æˆåŠŸè°ƒç”¨äº†æ•è·çš„ handler å—ã€‚æœ€åä¸€æ­¥å°±æ˜¯å»æ–­è¨€å½“å‰çš„åŠ¨ä½œæ˜¯å¦å’Œæˆ‘ä»¬é¢„æœŸçš„ä¸€æ ·ã€‚</p>
<p>å°±æ˜¯è¿™æ ·ï¼Œä¸€ç§å¾ˆç®€å•çš„åˆä¸ä½¿ç”¨ swizzling æ¥æµ‹è¯• UIAlertViewController çš„æ–¹å¼ã€‚</p>
<p>æ–‡ç« ä¸­çš„ä»£ç å·²ç»æ”¾åˆ° <a href="https://github.com/dasdom/TestingAlertExperiment" target="_blank" rel="external">github</a> ã€‚ </p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šdomï¼Œ<a href="http://swiftandpainless.com/how-to-test-uialertcontroller-in-swift/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-18<br>è¯‘è€…ï¼š<a href="undefined">DianQK</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/linusling">å°é“åŒ Linus</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
</blockquote>
<p>æœ€è¿‘æˆ‘è¯»äº†ä¸€ç¯‡åœ¨ Objective-C ä¸­ä½¿ç”¨ control swizzling æµ‹è¯•<code>UIAlertController</code>çš„<a href="http://qualitycoding.org/testing-uialertcontrollers/">æ–‡ç« </a>ã€‚è¿™æ ·çš„æ–‡ç« æ€»æ˜¯ä¿ƒä½¿æˆ‘å¯»æ‰¾ä¸€ç§ä¸ä½¿ç”¨ control swizzling ä¹Ÿå¯ä»¥æµ‹è¯•åŒæ ·ä¸œè¥¿çš„æ–¹æ³•ã€‚è™½ç„¶ï¼Œæˆ‘çŸ¥é“ swizzling æ˜¯å¼€å‘è€…çš„ä¸€ä¸ªéå¸¸æœ‰åŠ›çš„å·¥å…·ï¼Œä½†æˆ‘ä¸ªäººæ˜¯å°½å¯èƒ½å»é¿å…å»ä½¿ç”¨å®ƒçš„ã€‚äº‹å®ä¸Šï¼Œåœ¨æœ€è¿‘çš„å…­å¹´æ—¶é—´é‡Œï¼Œæˆ‘åªåœ¨ä¸€ä¸ªåº”ç”¨ä¸Šç”¨äº† swizzlingã€‚æ‰€ä»¥æˆ‘ç›¸ä¿¡æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸ä½¿ç”¨ swizzling æ¥å®ç°æµ‹è¯•ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åœ¨ Swift ä¸­ä¸ä½¿ç”¨ swizzling æ¥å¯¹<code>UIAlertController</code> è¿›è¡Œæµ‹è¯•ï¼Ÿ</p>]]>
    
    </summary>
    
      <category term="dom" scheme="http://swiftggteam.github.io/tags/dom/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/Swift-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Swift å…ƒç»„é«˜çº§ç”¨æ³•å’Œæœ€ä½³å®è·µ]]></title>
    <link href="http://swiftggteam.github.io/2015/10/10/tuples-swift-advanced-usage-best-practices/"/>
    <id>http://swiftggteam.github.io/2015/10/10/tuples-swift-advanced-usage-best-practices/</id>
    <published>2015-10-10T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šterhechteï¼Œ<a href="http://appventure.me/2015/07/19/tuples-swift-advanced-usage-best-practices/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015/07/19<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/mmoaay" target="_blank" rel="external">mmoaay</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/lfbWb" target="_blank" rel="external">lfb_CD</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>ä½œä¸º Swift ä¸­æ¯”è¾ƒå°‘è§çš„è¯­æ³•ç‰¹æ€§ï¼Œå…ƒç»„åªæ˜¯å æ®äº†ç»“æ„ä½“å’Œæ•°ç»„ä¹‹é—´å¾ˆå°çš„ä¸€ä¸ªä½ç½®ã€‚æ­¤å¤–ï¼Œå®ƒåœ¨ Objective-Cï¼ˆæˆ–è€…å¾ˆå¤šå…¶ä»–è¯­è¨€ï¼‰ä¸­æ²¡æœ‰ç›¸åº”çš„ç»“æ„ã€‚æœ€åï¼Œæ ‡å‡†åº“ä»¥åŠ Apple ç¤ºä¾‹ä»£ç ä¸­å¯¹å…ƒç»„çš„ä½¿ç”¨ä¹Ÿéå¸¸å°‘ã€‚å¯èƒ½å®ƒåœ¨ Swift ä¸­ç»™äººçš„å°è±¡å°±æ˜¯ç”¨æ¥åšæ¨¡å¼åŒ¹é…ï¼Œä½†æˆ‘å¹¶ä¸è¿™ä¹ˆè®¤ä¸ºã€‚</p>
<p>å’Œå…ƒç»„ç›¸å…³çš„å¤§éƒ¨åˆ†æ•™ç¨‹éƒ½åªå…³æ³¨ä¸‰ç§ä½¿ç”¨åœºæ™¯ï¼ˆæ¨¡å¼åŒ¹é…ã€è¿”å›å€¼å’Œè§£æ„ï¼‰ï¼Œä¸”æµ…å°è¾„æ­¢ã€‚æœ¬æ–‡ä¼šè¯¦ç»†ä»‹ç»å…ƒç»„ï¼Œå¹¶è®²è§£å…ƒç»„ä½¿ç”¨çš„æœ€ä½³å®è·µï¼Œå‘Šè¯‰ä½ ä½•æ—¶è¯¥ç”¨å…ƒç»„ï¼Œä½•æ—¶ä¸è¯¥ç”¨å…ƒç»„ã€‚åŒæ—¶æˆ‘ä¹Ÿä¼šåˆ—å‡ºé‚£äº›ä½ ä¸èƒ½ç”¨å…ƒç»„åšçš„äº‹æƒ…ï¼Œå…å¾—ä½ è€æ˜¯å» StackOverflow æé—®ã€‚å¥½äº†ï¼Œè¿›å…¥æ­£é¢˜ã€‚</p>
<a id="more"></a>
<h1 id="ç»å¯¹åŸºç¡€">ç»å¯¹åŸºç¡€</h1><p>å› ä¸ºè¿™éƒ¨åˆ†å†…å®¹ä½ å¯èƒ½å·²ç»çŸ¥é“å¾—ä¸ƒä¸ƒå…«å…«äº†ï¼Œæ‰€ä»¥æˆ‘å°±ç®€å•ä»‹ç»ä¸‹ã€‚</p>
<p>å…ƒç»„å…è®¸ä½ æŠŠä¸åŒç±»å‹çš„æ•°æ®ç»“åˆåˆ°ä¸€èµ·ã€‚å®ƒæ˜¯å¯å˜çš„ï¼Œå°½ç®¡çœ‹èµ·æ¥åƒåºåˆ—ï¼Œä½†æ˜¯å®ƒä¸æ˜¯ï¼Œå› ä¸ºä¸èƒ½ç›´æ¥éå†æ‰€æœ‰å†…å®¹ã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡ä¸€ä¸ªç®€å•çš„å…¥é—¨ç¤ºä¾‹æ¥å­¦ä¹ å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨å…ƒç»„ã€‚</p>
<h1 id="åˆ›å»ºå’Œè®¿é—®å…ƒç»„">åˆ›å»ºå’Œè®¿é—®å…ƒç»„</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªç®€å•çš„å…ƒç»„</span></span><br><span class="line"><span class="keyword">let</span> tp1 = (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">let</span> tp2 = (<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªå‘½åå…ƒç»„</span></span><br><span class="line"><span class="keyword">let</span> tp3 = (x: <span class="number">5</span>, y: <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸åŒçš„ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> tp4 = (name: <span class="string">"Carl"</span>, age: <span class="number">78</span>, pets: [<span class="string">"Bonny"</span>, <span class="string">"Houdon"</span>, <span class="string">"Miki"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—®å…ƒç»„å…ƒç´ </span></span><br><span class="line"><span class="keyword">let</span> tp5 = (<span class="number">13</span>, <span class="number">21</span>)</span><br><span class="line">tp5.<span class="number">0</span> <span class="comment">// 13</span></span><br><span class="line">tp5.<span class="number">1</span> <span class="comment">// 21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tp6 = (x: <span class="number">21</span>, y: <span class="number">33</span>)</span><br><span class="line">tp6.x <span class="comment">// 21</span></span><br><span class="line">tp6.y <span class="comment">// 33</span></span><br></pre></td></tr></table></figure>
<h1 id="ä½¿ç”¨å…ƒç»„åšæ¨¡å¼åŒ¹é…">ä½¿ç”¨å…ƒç»„åšæ¨¡å¼åŒ¹é…</h1><p>å°±åƒä¹‹å‰æ‰€è¯´ï¼Œè¿™å¤§æ¦‚æ˜¯å…ƒç»„æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯ã€‚Swift çš„ <code>switch</code> è¯­å¥æä¾›äº†ä¸€ç§æå¼ºå¤§çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä¸æä¹±æºä»£ç çš„æƒ…å†µä¸‹ç®€å•çš„å®šä¹‰å¤æ‚æ¡ä»¶å¥ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä¸€ä¸ªè¯­å¥ä¸­åŒ¹é…ç±»å‹ã€å®ä¾‹ä»¥åŠå¤šä¸ªå˜é‡çš„å€¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‰¹æ„é€ å‡ºæ¥çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">// è¿™äº›æ˜¯å¤šä¸ªæ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="number">23</span></span><br><span class="line"><span class="keyword">let</span> job: <span class="type">String</span>? = <span class="string">"Operator"</span></span><br><span class="line"><span class="keyword">let</span> payload: <span class="type">AnyObject</span> = <span class="type">NSDictionary</span>()</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æƒ³è¦æ‰¾ä¸€ä¸ª 30 å²ä»¥ä¸‹çš„å·¥ä½œè€…å’Œä¸€ä¸ªå­—å…¸ <code>payload</code>ã€‚å‡è®¾è¿™ä¸ª <code>payload</code> æ˜¯ Objective-C ä¸–ç•Œä¸­çš„ä¸€äº›ä¸œè¥¿ï¼Œå®ƒå¯èƒ½æ˜¯å­—å…¸ã€æ•°ç»„æˆ–è€…æ•°å­—ã€‚ç°åœ¨ä½ ä¸å¾—ä¸å’Œä¸‹é¢è¿™æ®µåˆ«äººå¾ˆå¤šå¹´å‰å†™çš„çƒ‚ä»£ç æ‰“äº¤é“ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (age, job, payload) &#123;</span><br><span class="line">  <span class="keyword">case</span> (<span class="keyword">let</span> age, <span class="number">_</span>?, <span class="number">_</span> <span class="keyword">as</span> <span class="type">NSDictionary</span>) <span class="keyword">where</span> age &lt; <span class="number">30</span>:</span><br><span class="line">  <span class="built_in">print</span>(age)</span><br><span class="line">  <span class="keyword">default</span>: ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŠŠ <code>switch</code> çš„å‚æ•°æ„å»ºä¸ºå…ƒç»„ <code>(age, job, payload)</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ç²¾å¿ƒè®¾è®¡çš„çº¦æŸæ¡ä»¶æ¥ä¸€æ¬¡æ€§è®¿é—®å…ƒç»„ä¸­æ‰€æœ‰ç‰¹å®šæˆ–ä¸ç‰¹å®šçš„å±æ€§ã€‚</p>
<h1 id="æŠŠå…ƒç»„åšä¸ºè¿”å›ç±»å‹">æŠŠå…ƒç»„åšä¸ºè¿”å›ç±»å‹</h1><p>è¿™å¯èƒ½æ˜¯å…ƒç»„ç¬¬äºŒå¤šçš„åº”ç”¨åœºæ™¯ã€‚å› ä¸ºå…ƒç»„å¯ä»¥å³æ—¶æ„å»ºï¼Œå®ƒæˆäº†åœ¨æ–¹æ³•ä¸­è¿”å›å¤šä¸ªå€¼çš„ä¸€ç§ç®€å•æœ‰æ•ˆçš„æ–¹å¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">abc</span><span class="params">()</span></span> -&gt; (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">3</span>, <span class="number">5</span>, <span class="string">"Carl"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="å…ƒç»„è§£æ„">å…ƒç»„è§£æ„</h1><p>Swift ä»ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æ±²å–äº†å¾ˆå¤šçµæ„Ÿï¼Œè¿™ä¹Ÿæ˜¯ Python åšäº†å¾ˆå¤šå¹´çš„äº‹æƒ…ã€‚ä¹‹å‰çš„ä¾‹å­å¤§å¤šåªå±•ç¤ºäº†å¦‚ä½•æŠŠä¸œè¥¿å¡åˆ°å…ƒç»„ä¸­ï¼Œè§£æ„åˆ™æ˜¯ä¸€ç§è¿…é€ŸæŠŠä¸œè¥¿ä»å…ƒç»„ä¸­å–å‡ºçš„æ–¹å¼ï¼Œç»“åˆä¸Šé¢çš„ <code>abc</code> ä¾‹å­ï¼Œæˆ‘ä»¬å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> (a, b, <span class="built_in">c</span>) = abc()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ä¸€ä¸ªä¾‹å­æ˜¯æŠŠå¤šä¸ªæ–¹æ³•è°ƒç”¨å†™åœ¨ä¸€è¡Œä»£ç ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> (a, b, <span class="built_in">c</span>) = (a(), b(), <span class="built_in">c</span>())</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ï¼Œç®€å•çš„äº¤æ¢ä¸¤ä¸ªå€¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">4</span></span><br><span class="line">(b, a) = (a, b)</span><br></pre></td></tr></table></figure>
<h1 id="è¿›é˜¶">è¿›é˜¶</h1><h2 id="å…ƒç»„åšä¸ºåŒ¿åç»“æ„ä½“">å…ƒç»„åšä¸ºåŒ¿åç»“æ„ä½“</h2><p>å…ƒç»„å’Œç»“æ„ä½“ä¸€æ ·å…è®¸ä½ æŠŠä¸åŒçš„ç±»å‹ç»“åˆåˆ°ä¸€ä¸ªç±»å‹ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">let</span> age: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// vs.</span></span><br><span class="line"><span class="keyword">let</span> user = (name: <span class="string">"Carl"</span>, age: <span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸¤ä¸ªç±»å‹å¾ˆåƒï¼Œåªæ˜¯ç»“æ„ä½“é€šè¿‡ç»“æ„ä½“æè¿°å£°æ˜ï¼Œå£°æ˜ä¹‹åå°±å¯ä»¥ç”¨è¿™ä¸ªç»“æ„ä½“æ¥å®šä¹‰å®ä¾‹ï¼Œè€Œå…ƒç»„ä»…ä»…æ˜¯ä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœéœ€è¦åœ¨ä¸€ä¸ªæ–¹æ³•æˆ–è€…å‡½æ•°ä¸­å®šä¹‰ä¸´æ—¶ç»“æ„ä½“ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™ç§ç›¸ä¼¼æ€§ã€‚å°±åƒ Swift æ–‡æ¡£ä¸­æ‰€è¯´ï¼š</p>
<blockquote>
<p>â€œéœ€è¦ä¸´æ—¶ç»„åˆä¸€äº›ç›¸å…³å€¼çš„æ—¶å€™ï¼Œå…ƒç»„éå¸¸æœ‰ç”¨ã€‚ï¼ˆâ€¦ï¼‰å¦‚æœæ•°æ®ç»“æ„éœ€è¦åœ¨ä¸´æ—¶èŒƒå›´ä¹‹å¤–ä»ç„¶å­˜åœ¨ã€‚é‚£å°±æŠŠå®ƒæŠ½è±¡æˆç±»æˆ–è€…ç»“æ„ä½“ï¼ˆâ€¦ï¼‰â€</p>
</blockquote>
<p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼šéœ€è¦æ”¶é›†å¤šä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œå»é‡å¹¶æ’å…¥åˆ°æ•°æ®é›†ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">zipForUser</span><span class="params">(userid: String)</span></span> -&gt; <span class="type">String</span> &#123; <span class="keyword">return</span> <span class="string">"12124"</span> &#125;</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">streetForUser</span><span class="params">(userid: String)</span></span> -&gt; <span class="type">String</span> &#123; <span class="keyword">return</span> <span class="string">"Charles Street"</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»æ•°æ®é›†ä¸­æ‰¾å‡ºæ‰€æœ‰ä¸é‡å¤çš„è¡—é“</span></span><br><span class="line"><span class="keyword">var</span> streets: [<span class="type">String</span>: (<span class="built_in">zip</span>: <span class="type">String</span>, street: <span class="type">String</span>, <span class="built_in">count</span>: <span class="type">Int</span>)] = [:]</span><br><span class="line"><span class="keyword">for</span> userid <span class="keyword">in</span> users &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="built_in">zip</span> = zipForUser(userid)</span><br><span class="line">    <span class="keyword">let</span> street = streetForUser(userid)</span><br><span class="line">    <span class="keyword">let</span> key = <span class="string">"<span class="subst">\(<span class="built_in">zip</span>)</span>-<span class="subst">\(street)</span>"</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> (<span class="number">_</span>, <span class="number">_</span>, <span class="built_in">count</span>) = streets[key] &#123;</span><br><span class="line">	streets[key] = (<span class="built_in">zip</span>, street, <span class="built_in">count</span> + <span class="number">1</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	streets[key] = (<span class="built_in">zip</span>, street, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">drawStreetsOnMap(streets.values)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨çŸ­æš‚çš„ä¸´æ—¶åœºæ™¯ä¸­ä½¿ç”¨ç»“æ„ç®€å•çš„å…ƒç»„ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰ç»“æ„ä½“ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚</p>
<p>å†çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ï¼šåœ¨å¤„ç†ç®—æ³•æ•°æ®çš„ç±»ä¸­ï¼Œä½ éœ€è¦æŠŠæŸä¸ªæ–¹æ³•è¿”å›çš„ä¸´æ—¶ç»“æœä¼ å…¥åˆ°å¦å¤–ä¸€ä¸ªæ–¹æ³•ä¸­ã€‚å®šä¹‰ä¸€ä¸ªåªæœ‰ä¸¤ä¸‰ä¸ªæ–¹æ³•ä¼šç”¨çš„ç»“æ„ä½“æ˜¾ç„¶æ˜¯ä¸å¿…è¦çš„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¼–é€ ç®—æ³•</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">calculateInterim</span><span class="params">(values: [Int])</span></span> -&gt; (r: <span class="type">Int</span>, alpha: <span class="type">CGFloat</span>, chi: (<span class="type">CGFloat</span>, <span class="type">CGFLoat</span>)) &#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">expandInterim</span><span class="params">(interim: <span class="params">(r: Int, alpha: CGFloat, chi: <span class="params">(CGFloat, CGFLoat)</span></span></span></span>)) -&gt; <span class="type">CGFloat</span> &#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶ï¼Œè¿™è¡Œä»£ç éå¸¸ä¼˜é›…ã€‚å•ç‹¬ä¸ºä¸€ä¸ªå®ä¾‹å®šä¹‰ç»“æ„ä½“æœ‰æ—¶å€™è¿‡äºå¤æ‚ï¼Œè€Œå®šä¹‰åŒä¸€ä¸ªå…ƒç»„ 4 æ¬¡å´ä¸ä½¿ç”¨ç»“æ„ä½“ä¹ŸåŒæ ·ä¸å¯å–ã€‚æ‰€ä»¥é€‰æ‹©å“ªç§æ–¹å¼å–å†³äºå„ç§å„æ ·çš„å› ç´ ã€‚</p>
<h2 id="ç§æœ‰çŠ¶æ€">ç§æœ‰çŠ¶æ€</h2><p>é™¤äº†ä¹‹å‰çš„ä¾‹å­ï¼Œå…ƒç»„è¿˜æœ‰ä¸€ç§éå¸¸å®ç”¨çš„åœºæ™¯ï¼šåœ¨ä¸´æ—¶èŒƒå›´ä»¥å¤–ä½¿ç”¨ã€‚Rich Hickey è¯´è¿‡ï¼šâ€œå¦‚æœæ ‘æ—ä¸­æœ‰ä¸€æ£µæ ‘å€’äº†ï¼Œä¼šå‘å‡ºå£°éŸ³ä¹ˆï¼Ÿâ€œå› ä¸ºä½œç”¨åŸŸæ˜¯ç§æœ‰çš„ï¼Œå…ƒç»„åªåœ¨å½“å‰çš„å®ç°æ–¹æ³•ä¸­æœ‰æ•ˆã€‚ä½¿ç”¨å…ƒç»„å¯ä»¥å¾ˆå¥½çš„å­˜å‚¨å†…éƒ¨çŠ¶æ€ã€‚</p>
<p>æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šä¿å­˜ä¸€ä¸ªé™æ€çš„ <code>UITableView</code> ç»“æ„ï¼Œè¿™ä¸ªç»“æ„ç”¨æ¥å±•ç¤ºç”¨æˆ·ç®€ä»‹ä¸­çš„å„ç§ä¿¡æ¯ä»¥åŠä¿¡æ¯å¯¹åº”å€¼çš„ <code>keypath</code>ï¼ŒåŒæ—¶è¿˜ç”¨<code>editable</code>æ ‡è¯†è¡¨ç¤ºç‚¹å‡» <code>Cell</code> æ—¶æ˜¯å¦å¯ä»¥å¯¹è¿™äº›å€¼è¿›è¡Œç¼–è¾‘ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tableViewValues = [(title: <span class="string">"Age"</span>, value: <span class="string">"user.age"</span>, editable: <span class="literal">true</span>),</span><br><span class="line">(title: <span class="string">"Name"</span>, value: <span class="string">"user.name.combinedName"</span>, editable: <span class="literal">true</span>),</span><br><span class="line">(title: <span class="string">"Username"</span>, value: <span class="string">"user.name.username"</span>, editable: <span class="literal">false</span>),</span><br><span class="line">(title: <span class="string">"ProfilePicture"</span>, value: <span class="string">"user.pictures.thumbnail"</span>, editable: <span class="literal">false</span>)]</span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§é€‰æ‹©å°±æ˜¯å®šä¹‰ç»“æ„ä½“ï¼Œä½†æ˜¯å¦‚æœæ•°æ®çš„å®ç°ç»†èŠ‚æ˜¯çº¯ç§æœ‰çš„ï¼Œç”¨å…ƒç»„å°±å¤Ÿäº†ã€‚</p>
<p>æ›´é…·çš„ä¸€ä¸ªä¾‹å­æ˜¯ï¼šä½ å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”æƒ³ç»™è¿™ä¸ªå¯¹è±¡æ·»åŠ å¤šä¸ªå˜åŒ–ç›‘å¬å™¨ï¼Œæ¯ä¸ªç›‘å¬å™¨éƒ½åŒ…å«å®ƒçš„åå­—ä»¥åŠå‘ç”Ÿå˜åŒ–æ—¶è¢«è°ƒç”¨çš„é—­åŒ…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">addListener</span><span class="params">(name: String, action: <span class="params">(change: AnyObject?)</span></span></span> -&gt; ())</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">removeListener</span><span class="params">(name: String)</span></span></span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šå¦‚ä½•åœ¨å¯¹è±¡ä¸­ä¿å­˜è¿™äº›ç›‘å¬å™¨å‘¢ï¼Ÿæ˜¾è€Œæ˜“è§çš„è§£å†³æ–¹æ¡ˆæ˜¯å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ï¼Œä½†æ˜¯è¿™äº›ç›‘å¬å™¨åªèƒ½åœ¨ä¸‰ç§æƒ…å†µä¸‹ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬ä½¿ç”¨èŒƒå›´æå…¶æœ‰é™ï¼Œè€Œç»“æ„ä½“åªèƒ½å®šä¹‰ä¸º <code>internal</code> ï¼Œæ‰€ä»¥ï¼Œä½¿ç”¨å…ƒç»„å¯èƒ½ä¼šæ˜¯æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒçš„è§£æ„èƒ½åŠ›ä¼šè®©äº‹æƒ…å˜å¾—å¾ˆç®€å•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> listeners: [(<span class="type">String</span>, (<span class="type">AnyObject</span>?) -&gt; ())]</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">addListener</span><span class="params">(name: String, action: <span class="params">(change: AnyObject?)</span></span></span> -&gt; ()) &#123;</span><br><span class="line">   <span class="keyword">self</span>.listeners.append((name, action))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">removeListener</span><span class="params">(name: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> idx = listeners.indexOf(&#123; e <span class="keyword">in</span> <span class="keyword">return</span> e.<span class="number">0</span> == name &#125;) &#123;</span><br><span class="line">	listeners.removeAtIndex(idx)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">execute</span><span class="params">(change: Int)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="number">_</span>, listener) <span class="keyword">in</span> listeners &#123;</span><br><span class="line">	listener(change)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°±åƒä½ åœ¨ <code>execute</code> æ–¹æ³•ä¸­çœ‹åˆ°çš„ä¸€æ ·ï¼Œå…ƒç»„çš„è§£æ„èƒ½åŠ›è®©å®ƒåœ¨è¿™ç§æƒ…å†µä¸‹ç‰¹åˆ«å¥½ç”¨ï¼Œå› ä¸ºå†…å®¹éƒ½æ˜¯åœ¨å±€éƒ¨ä½œç”¨åŸŸä¸­ç›´æ¥è§£æ„ã€‚</p>
<h2 id="æŠŠå…ƒç»„ä½œä¸ºå›ºå®šå¤§å°çš„åºåˆ—">æŠŠå…ƒç»„ä½œä¸ºå›ºå®šå¤§å°çš„åºåˆ—</h2><p>å…ƒç»„çš„å¦å¤–ä¸€ä¸ªåº”ç”¨é¢†åŸŸæ˜¯ï¼šå›ºå®šä¸€ä¸ªç±»å‹æ‰€åŒ…å«å…ƒç´ çš„ä¸ªæ•°ã€‚å‡è®¾éœ€è¦ç”¨ä¸€ä¸ªå¯¹è±¡æ¥è®¡ç®—ä¸€å¹´ä¸­æ‰€æœ‰æœˆä»½çš„å„ç§ç»Ÿè®¡å€¼ï¼Œä½ éœ€è¦åˆ†å¼€ç»™æ¯ä¸ªæœˆä»½å­˜å‚¨ä¸€ä¸ªç¡®å®šçš„ <code>Integer</code> å€¼ã€‚é¦–å…ˆèƒ½æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆä¼šæ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> monthValues: [<span class="type">Int</span>]</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±ä¸èƒ½ç¡®å®šè¿™ä¸ªå±æ€§åˆšå¥½åŒ…å« 12 ä¸ªå…ƒç´ ã€‚ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„ç”¨æˆ·å¯èƒ½ä¸å°å¿ƒæ’å…¥äº† 13 ä¸ªå€¼ï¼Œæˆ–è€… 11 ä¸ªã€‚æˆ‘ä»¬æ²¡æ³•å‘Šè¯‰ç±»å‹æ£€æŸ¥å™¨è¿™ä¸ªå¯¹è±¡æ˜¯å›ºå®š 12 ä¸ªå…ƒç´ çš„æ•°ç»„ï¼ˆæœ‰æ„æ€çš„æ˜¯ï¼Œè¿™æ˜¯ C éƒ½æ”¯æŒçš„äº‹æƒ…ï¼‰ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨å…ƒç»„ï¼Œå¯ä»¥å¾ˆç®€å•åœ°å®ç°è¿™ç§ç‰¹æ®Šçš„çº¦æŸï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> monthValues: (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>)</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§é€‰æ‹©å°±æ˜¯åœ¨å¯¹è±¡çš„åŠŸèƒ½ä¸­åŠ å…¥çº¦æŸé€»è¾‘ï¼ˆå³é€šè¿‡æ–°çš„ <code>guard</code> è¯­å¥ï¼‰ï¼Œç„¶è€Œè¿™ä¸ªæ˜¯åœ¨è¿è¡Œæ—¶æ£€æŸ¥ã€‚å…ƒç»„çš„æ£€æŸ¥åˆ™æ˜¯åœ¨ç¼–è¯‘æœŸé—´ï¼›å½“ä½ æƒ³ç»™å¯¹è±¡èµ‹å€¼ 11 ä¸ªæœˆæ—¶ï¼Œç¼–è¯‘éƒ½é€šä¸è¿‡ã€‚</p>
<h2 id="å…ƒç»„å½“åšå¤æ‚çš„å¯å˜å‚æ•°ç±»å‹">å…ƒç»„å½“åšå¤æ‚çš„å¯å˜å‚æ•°ç±»å‹</h2><p>å¯å˜å‚æ•°ï¼ˆæ¯”å¦‚å¯å˜å‡½æ•°å‚æ•°ï¼‰æ˜¯åœ¨å‡½æ•°å‚æ•°çš„ä¸ªæ•°ä¸å®šçš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨çš„ä¸€ç§æŠ€æœ¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ ç»Ÿä¾‹å­</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">sumOf</span><span class="params">(numbers: Int...)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ + æ“ä½œç¬¦æŠŠæ‰€æœ‰æ•°å­—åŠ èµ·æ¥</span></span><br><span class="line">    <span class="keyword">return</span> numbers.<span class="built_in">reduce</span>(<span class="number">0</span>, combine: +)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sumOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>) <span class="comment">// 24</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„éœ€æ±‚ä¸å•å•æ˜¯ <code>integer</code>ï¼Œå…ƒç»„å°±ä¼šå˜çš„å¾ˆæœ‰ç”¨ã€‚ä¸‹é¢è¿™ä¸ªå‡½æ•°åšçš„äº‹æƒ…å°±æ˜¯æ‰¹é‡æ›´æ–°æ•°æ®åº“ä¸­çš„ <code>n</code> ä¸ªå®ä½“ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">batchUpdate</span><span class="params">(updates: <span class="params">(String, Int)</span></span></span>...) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.db.begin()</span><br><span class="line">    <span class="keyword">for</span> (key, value) <span class="keyword">in</span> updates &#123;</span><br><span class="line">	<span class="keyword">self</span>.db.<span class="keyword">set</span>(key, value)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">self</span>.db.end()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘ä»¬å‡æƒ³æ•°æ®åº“æ˜¯å¾ˆå¤æ‚çš„</span></span><br><span class="line">batchUpdate((<span class="string">"tk1"</span>, <span class="number">5</span>), (<span class="string">"tk7"</span>, <span class="number">9</span>), (<span class="string">"tk21"</span>, <span class="number">44</span>), (<span class="string">"tk88"</span>, <span class="number">12</span>))</span><br></pre></td></tr></table></figure>
<h1 id="é«˜çº§ç”¨æ³•">é«˜çº§ç”¨æ³•</h1><h2 id="å…ƒç»„è¿­ä»£">å…ƒç»„è¿­ä»£</h2><p>åœ¨ä¹‹å‰çš„å†…å®¹ä¸­ï¼Œæˆ‘è¯•å›¾é¿å…æŠŠå…ƒç»„å«åšåºåˆ—æˆ–è€…é›†åˆï¼Œå› ä¸ºå®ƒç¡®å®ä¸æ˜¯ã€‚å› ä¸ºå…ƒç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹å¼å¯¹å…ƒç»„çš„å†…å®¹è¿›è¡Œéå†æˆ–è€…æ˜ å°„ã€‚æˆ–è€…è¯´è‡³å°‘æ²¡æœ‰ä¼˜é›…çš„æ–¹å¼ã€‚</p>
<p>Swift æä¾›äº†æœ‰é™çš„åå°„èƒ½åŠ›ï¼Œè¿™å°±å…è®¸æˆ‘ä»¬æ£€æŸ¥å…ƒç»„çš„å†…å®¹ç„¶åå¯¹å®ƒè¿›è¡Œéå†ã€‚ä¸å¥½çš„åœ°æ–¹å°±æ˜¯ç±»å‹æ£€æŸ¥å™¨ä¸çŸ¥é“å¦‚ä½•ç¡®å®šéå†å…ƒç´ çš„ç±»å‹ï¼Œæ‰€ä»¥æ‰€æœ‰å†…å®¹çš„ç±»å‹éƒ½æ˜¯ <code>Any</code>ã€‚ä½ éœ€è¦è‡ªå·±è½¬æ¢å’ŒåŒ¹é…é‚£äº›å¯èƒ½æœ‰ç”¨çš„ç±»å‹å¹¶å†³å®šè¦å¯¹å®ƒä»¬åšä»€ä¹ˆã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> t = (a: <span class="number">5</span>, b: <span class="string">"String"</span>, <span class="built_in">c</span>: <span class="type">NSDate</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mirror = <span class="type">Mirror</span>(reflecting: t)</span><br><span class="line"><span class="keyword">for</span> (label, value) <span class="keyword">in</span> mirror.children &#123;</span><br><span class="line">    <span class="keyword">switch</span> value &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">is</span> <span class="type">Int</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"int"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">is</span> <span class="type">String</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"string"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">is</span> <span class="type">NSDate</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"nsdate"</span>)</span><br><span class="line">    <span class="keyword">default</span>: ()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å½“ç„¶æ²¡æœ‰æ•°ç»„è¿­ä»£é‚£ä¹ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœç¡®å®éœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨è¿™æ®µä»£ç ã€‚</p>
<h2 id="å…ƒç»„å’Œæ³›å‹">å…ƒç»„å’Œæ³›å‹</h2><p>Swift ä¸­å¹¶æ²¡æœ‰ <code>Tuple</code> è¿™ä¸ªç±»å‹ã€‚å¦‚æœä½ ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¯ä»¥è¿™æ ·æƒ³ï¼šæ¯ä¸ªå…ƒç»„éƒ½æ˜¯å®Œå…¨ä¸åŒçš„ç±»å‹ï¼Œå®ƒçš„ç±»å‹å–å†³äºå®ƒåŒ…å«å…ƒç´ çš„ç±»å‹ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸å…¶å®šä¹‰ä¸€ä¸ªæ”¯æŒæ³›å‹çš„å…ƒç»„ï¼Œè¿˜ä¸å¦‚æ ¹æ®è‡ªå·±éœ€æ±‚å®šä¹‰ä¸€ä¸ªåŒ…å«å…·ä½“æ•°æ®ç±»å‹çš„å…ƒç»„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">wantsTuple</span><span class="generics">&lt;T1, T2&gt;</span><span class="params">(tuple: <span class="params">(T1, T2)</span></span></span>) -&gt; <span class="type">T1</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> tuple.<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wantsTuple((<span class="string">"a"</span>, <span class="string">"b"</span>)) <span class="comment">// "a"</span></span><br><span class="line">wantsTuple((<span class="number">1</span>, <span class="number">2</span>)) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>typealiases</code> ä½¿ç”¨å…ƒç»„ï¼Œä»è€Œå…è®¸å­ç±»æŒ‡å®šå…·ä½“çš„ç±»å‹ã€‚è¿™çœ‹èµ·æ¥ç›¸å½“å¤æ‚è€Œä¸”æ— ç”¨ï¼Œä½†æ˜¯æˆ‘å·²ç»ç¢°åˆ°äº†éœ€è¦ç‰¹æ„è¿™æ ·åšçš„ä½¿ç”¨åœºæ™¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseClass</span>&lt;<span class="title">A</span>,<span class="title">B</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Element</span> = (<span class="type">A</span>, <span class="type">B</span>)</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">addElement</span><span class="params">(elm: Element)</span></span> &#123;</span><br><span class="line">	<span class="built_in">print</span>(elm)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntegerClass</span>&lt;<span class="title">B</span>&gt; : <span class="title">BaseClass</span>&lt;<span class="title">Int</span>, <span class="title">B</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> example = <span class="type">IntegerClass</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">example.addElement((<span class="number">5</span>, <span class="string">""</span>))</span><br><span class="line"><span class="comment">// Prints (5, "")</span></span><br></pre></td></tr></table></figure>
<h2 id="å®šä¹‰å…·ä½“çš„å…ƒç»„ç±»å‹">å®šä¹‰å…·ä½“çš„å…ƒç»„ç±»å‹</h2><p>åœ¨ä¹‹å‰å¥½å‡ ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¤šæ¬¡é‡å¤ä¸€äº›å·²ç»ç¡®å®šçš„ç±»å‹ï¼Œæ¯”å¦‚ <code>(Int, Int, String)</code>ã€‚è¿™å½“ç„¶ä¸éœ€è¦æ¯æ¬¡éƒ½å†™ï¼Œä½ å¯ä»¥ä¸ºå®ƒå®šä¹‰ä¸€ä¸ª <code>typealias</code>ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Example</span> = (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>)</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">add</span><span class="params">(elm: Example)</span></span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦å¦‚æ­¤é¢‘ç¹çš„ä½¿ç”¨ä¸€ä¸ªç¡®å®šçš„å…ƒç»„ç»“æ„ï¼Œä»¥è‡³äºä½ æƒ³ç»™å®ƒå¢åŠ ä¸€ä¸ª <code>typealias</code>ï¼Œé‚£ä¹ˆæœ€å¥½çš„æ–¹å¼æ˜¯å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ã€‚</p>
<h2 id="ç”¨å…ƒç»„åšå‡½æ•°å‚æ•°">ç”¨å…ƒç»„åšå‡½æ•°å‚æ•°</h2><p>å°±åƒ <a href="http://www.paulrobinson.net/function-parameters-are-tuples-in-swift/" target="_blank" rel="external">Paul Robinson çš„æ–‡ç« </a> ä¸­è¯´åˆ°çš„ä¸€æ ·ï¼Œ<code>(a: Int, b: Int, c: String) -&gt;</code> å’Œ <code>(a: Int, b: Int, c:String)</code> ä¹‹é—´æœ‰ä¸€ç§å¥‡å¦™çš„ç›¸ä¼¼ã€‚ç¡®å®ï¼Œå¯¹äº Swift çš„ç¼–è¯‘å™¨è€Œè¨€ï¼Œæ–¹æ³•/å‡½æ•°çš„å‚æ•°å¤´æ— éå°±æ˜¯ä¸€ä¸ªå…ƒç»„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä» Paul Robinson çš„åšå®¢æ‹·è´æ¥çš„, ä½ ä¹Ÿåº”è¯¥å»è¯»è¯»è¿™ç¯‡æ–‡ç« :</span></span><br><span class="line"><span class="comment">// http://www.paulrobinson.net/function-parameters-are-tuples-in-swift/</span></span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">foo</span><span class="params">(a: Int, <span class="number">_</span> b: Int, <span class="number">_</span> name: String)</span></span> -&gt; <span class="type">Int</span>     </span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arguments = (<span class="number">4</span>, <span class="number">3</span>, <span class="string">"hello"</span>)</span><br><span class="line">foo(arguments) <span class="comment">// è¿”å› 4</span></span><br></pre></td></tr></table></figure>
<p>è¿™çœ‹èµ·æ¥å¾ˆé…·æ˜¯ä¸æ˜¯ï¼Ÿä½†æ˜¯ç­‰ç­‰â€¦è¿™é‡Œçš„å‡½æ•°ç­¾åæœ‰ç‚¹ç‰¹æ®Šã€‚å½“æˆ‘ä»¬åƒå…ƒç»„ä¸€æ ·å¢åŠ æˆ–è€…ç§»é™¤æ ‡ç­¾çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå“¦äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹å®éªŒï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®©æˆ‘ä»¬è¯•ä¸€ä¸‹å¸¦æ ‡ç­¾çš„:</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">foo2</span><span class="params">(a a: Int, b: Int, name: String)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> arguments = (<span class="number">4</span>, <span class="number">3</span>, <span class="string">"hello"</span>)</span><br><span class="line">foo2(arguments) <span class="comment">// ä¸èƒ½ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arguments2 = (a: <span class="number">4</span>, b: <span class="number">3</span>, name: <span class="string">"hello"</span>)</span><br><span class="line">foo2(arguments2) <span class="comment">// å¯ä»¥ç”¨ (4)</span></span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥å¦‚æœå‡½æ•°ç­¾åå¸¦æ ‡ç­¾çš„è¯å°±å¯ä»¥æ”¯æŒå¸¦æ ‡ç­¾çš„å…ƒç»„ã€‚</p>
<p>ä½†æˆ‘ä»¬æ˜¯å¦éœ€è¦æ˜ç¡®çš„æŠŠå…ƒç»„å†™å…¥åˆ°å˜é‡ä¸­å‘¢ï¼Ÿ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo2((a: <span class="number">4</span>, b: <span class="number">3</span>, name: <span class="string">"hello"</span>)) <span class="comment">// å‡ºé”™</span></span><br></pre></td></tr></table></figure>
<p>å¥½å§ï¼Œæ¯”è¾ƒå€’éœ‰ï¼Œä¸Šé¢çš„ä»£ç æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°è¿”å›çš„å…ƒç»„å‘¢ï¼Ÿ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">foo</span><span class="params">(a: Int, <span class="number">_</span> b: Int, <span class="number">_</span> name: String)</span></span> -&gt; <span class="type">Int</span>     </span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">get_tuple</span><span class="params">()</span></span> -&gt; (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">4</span>, <span class="number">4</span>, <span class="string">"hello"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(get_tuple()) <span class="comment">// å¯ä»¥ç”¨! è¿”å› 4!</span></span><br></pre></td></tr></table></figure>
<p>å¤ªæ£’äº†ï¼è¿™ç§æ–¹å¼å¯ä»¥ï¼</p>
<p>è¿™ç§æ–¹å¼åŒ…å«äº†å¾ˆå¤šæœ‰è¶£çš„å«ä¹‰å’Œå¯èƒ½æ€§ã€‚å¦‚æœå¯¹ç±»å‹è¿›è¡Œå¾ˆå¥½çš„è§„åˆ’ï¼Œä½ ç”šè‡³å¯ä»¥ä¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œè§£æ„ï¼Œç„¶åç›´æ¥æŠŠå®ƒä»¬å½“ä½œå‚æ•°åœ¨å‡½æ•°é—´ä¼ é€’ã€‚</p>
<p>æ›´å¦™çš„æ˜¯ï¼Œå¯¹äºå‡½æ•°å¼ç¼–ç¨‹ï¼Œä½ å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªå«å¤šä¸ªå‚æ•°çš„å…ƒç»„åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè€Œä¸éœ€è¦å¯¹å®ƒè¿›è¡Œè§£æ„ã€‚</p>
<h1 id="å…ƒç»„åšä¸åˆ°å•Š~">å…ƒç»„åšä¸åˆ°å•Š~</h1><p>æœ€åï¼Œæˆ‘ä»¬æŠŠä¸€äº›å…ƒç»„ä¸èƒ½å®ç°äº‹æƒ…ä»¥åˆ—è¡¨çš„æ–¹å¼å‘ˆç°ç»™å¤§å®¶ã€‚</p>
<h2 id="ç”¨å…ƒç»„åšå­—å…¸çš„_Key">ç”¨å…ƒç»„åšå­—å…¸çš„ <code>Key</code></h2><p>å¦‚æœä½ æƒ³åšå¦‚ä¸‹çš„äº‹æƒ…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p: [(<span class="type">Int</span>, <span class="type">Int</span>): <span class="type">String</span>]</span><br></pre></td></tr></table></figure>
<p>é‚£æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå…ƒç»„ä¸ç¬¦åˆå“ˆå¸Œåè®®ã€‚è¿™çœŸæ˜¯ä¸€ä»¶ä»¤äººä¼¤å¿ƒçš„äº‹ï¼Œå› ä¸ºè¿™ç§å†™æ³•æœ‰å¾ˆå¤šåº”ç”¨åœºæ™¯ã€‚å¯èƒ½ä¼šæœ‰ç–¯ç‹‚çš„ç±»å‹æ£€æŸ¥å™¨é»‘å®¢å¯¹å…ƒç»„è¿›è¡Œæ‰©å±•ä»¥ä½¿å®ƒç¬¦åˆå“ˆå¸Œåè®®ï¼Œä½†æ˜¯æˆ‘è¿˜çœŸçš„æ²¡æœ‰ç ”ç©¶è¿‡è¿™ä¸ªï¼Œæ‰€ä»¥å¦‚æœä½ åˆšå¥½å‘ç°è¿™æ˜¯å¯ç”¨çš„ï¼Œè¯·éšæ—¶é€šè¿‡æˆ‘çš„ <a href="http://twitter.com/terhechte" target="_blank" rel="external">twitter</a> è”ç³»æˆ‘ã€‚</p>
<h2 id="å…ƒç»„çš„åè®®åˆè§„æ€§">å…ƒç»„çš„åè®®åˆè§„æ€§</h2><p>ç»™å®šå¦‚ä¸‹çš„åè®®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">PointProtocol</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> y: <span class="type">Int</span> &#123; <span class="keyword">set</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ æ²¡æ³•å‘Šè¯‰ç±»å‹æ£€æŸ¥å™¨è¿™ä¸ª <code>(x: 10, y: 20)</code> å…ƒç»„ç¬¦åˆè¿™ä¸ªåè®®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">addPoint</span><span class="params">(point: PointProtocol)</span></span></span><br><span class="line">addPoint((x: <span class="number">10</span>, y: <span class="number">20</span>)) <span class="comment">// ä¸å¯ç”¨ã€‚</span></span><br></pre></td></tr></table></figure>
<h1 id="é™„å½•">é™„å½•</h1><p>å°±è¿™æ ·äº†ã€‚å¦‚æœæˆ‘å¿˜äº†è¯´æˆ–è€…è¯´é”™ä¸€äº›äº‹æƒ…ï¼Œå¦‚æœä½ å‘ç°äº†ç¡®åˆ‡çš„é”™è¯¯ï¼Œæˆ–è€…æœ‰ä¸€äº›å…¶ä»–æˆ‘å¿˜äº†çš„äº‹æƒ…ï¼Œè¯·éšæ—¶<a href="http://twitter.com/terhechte" target="_blank" rel="external">è”ç³»æˆ‘</a></p>
<h1 id="æ›´æ–°">æ›´æ–°</h1><p><strong>07/23/2015</strong> æ·»åŠ <strong>ç”¨å…ƒç»„åšå‡½æ•°å‚æ•°</strong>ç« èŠ‚</p>
<p><strong>08/06/2015</strong> æ›´æ–°åå°„ä¾‹å­åˆ°æœ€æ–°çš„ Swift beta 4ï¼ˆç§»é™¤äº†å¯¹ <code>reflect</code> çš„è°ƒç”¨)</p>
<p><strong>08/12/2015</strong> æ›´æ–°<strong>ç”¨å…ƒç»„åšå‡½æ•°å‚æ•°</strong>ç« èŠ‚ï¼ŒåŠ å…¥æ›´å¤šçš„ä¾‹å­å’Œä¿¡æ¯</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šterhechteï¼Œ<a href="http://appventure.me/2015/07/19/tuples-swift-advanced-usage-best-practices/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015/07/19<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/mmoaay">mmoaay</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/lfbWb">lfb_CD</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>ä½œä¸º Swift ä¸­æ¯”è¾ƒå°‘è§çš„è¯­æ³•ç‰¹æ€§ï¼Œå…ƒç»„åªæ˜¯å æ®äº†ç»“æ„ä½“å’Œæ•°ç»„ä¹‹é—´å¾ˆå°çš„ä¸€ä¸ªä½ç½®ã€‚æ­¤å¤–ï¼Œå®ƒåœ¨ Objective-Cï¼ˆæˆ–è€…å¾ˆå¤šå…¶ä»–è¯­è¨€ï¼‰ä¸­æ²¡æœ‰ç›¸åº”çš„ç»“æ„ã€‚æœ€åï¼Œæ ‡å‡†åº“ä»¥åŠ Apple ç¤ºä¾‹ä»£ç ä¸­å¯¹å…ƒç»„çš„ä½¿ç”¨ä¹Ÿéå¸¸å°‘ã€‚å¯èƒ½å®ƒåœ¨ Swift ä¸­ç»™äººçš„å°è±¡å°±æ˜¯ç”¨æ¥åšæ¨¡å¼åŒ¹é…ï¼Œä½†æˆ‘å¹¶ä¸è¿™ä¹ˆè®¤ä¸ºã€‚</p>
<p>å’Œå…ƒç»„ç›¸å…³çš„å¤§éƒ¨åˆ†æ•™ç¨‹éƒ½åªå…³æ³¨ä¸‰ç§ä½¿ç”¨åœºæ™¯ï¼ˆæ¨¡å¼åŒ¹é…ã€è¿”å›å€¼å’Œè§£æ„ï¼‰ï¼Œä¸”æµ…å°è¾„æ­¢ã€‚æœ¬æ–‡ä¼šè¯¦ç»†ä»‹ç»å…ƒç»„ï¼Œå¹¶è®²è§£å…ƒç»„ä½¿ç”¨çš„æœ€ä½³å®è·µï¼Œå‘Šè¯‰ä½ ä½•æ—¶è¯¥ç”¨å…ƒç»„ï¼Œä½•æ—¶ä¸è¯¥ç”¨å…ƒç»„ã€‚åŒæ—¶æˆ‘ä¹Ÿä¼šåˆ—å‡ºé‚£äº›ä½ ä¸èƒ½ç”¨å…ƒç»„åšçš„äº‹æƒ…ï¼Œå…å¾—ä½ è€æ˜¯å» StackOverflow æé—®ã€‚å¥½äº†ï¼Œè¿›å…¥æ­£é¢˜ã€‚</p>]]>
    
    </summary>
    
      <category term="APPVENTURE" scheme="http://swiftggteam.github.io/tags/APPVENTURE/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Swift ç¼–ç¨‹æ€æƒ³ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼šæ•°ç»„çš„ Map æ–¹æ³•]]></title>
    <link href="http://swiftggteam.github.io/2015/10/09/thinking-in-swift-2/"/>
    <id>http://swiftggteam.github.io/2015/10/09/thinking-in-swift-2/</id>
    <published>2015-10-09T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/09/20/thinking-in-swift-2/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-20<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/nsnirvana" target="_blank" rel="external">æˆ‘åç¬‘</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="external">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a></p>
</blockquote>
<p>åœ¨<a href="http://alisoftware.github.io/swift/2015/09/06/thinking-in-swift-1/" target="_blank" rel="external">æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œä»‹ç»äº†å¦‚ä½•é¿å…å¯¹å¯é€‰ç±»å‹å¼ºåˆ¶è§£åŒ…ä»¥åŠæ‹¯æ•‘â€œå°é©¬â€ğŸ´ ã€‚åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šç²¾ç®€å‰æ–‡ä»£ç æ¥è®©å®ƒçœ‹èµ·æ¥æ›´æœ‰â€é›¨ç‡•é£â€(<em>Swift-er</em> : Swiftç¼–ç¨‹è¯­è¨€é£æ ¼)ï¼ŒåŒæ—¶å‘ä½ ä»‹ç» <code>map()</code> å’Œ <code>flatMap()</code> æ–¹æ³•ã€‚</p>
<a id="more"></a>
<blockquote>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°†è¦è®¨è®ºæ•°ç»„çš„ <code>map()</code> å’Œ <code>flatMap()</code> æ–¹æ³•ã€‚</p>
</blockquote>
<h1 id="å‰æƒ…æè¦1">å‰æƒ…æè¦<a href="thinking-in-swift-2/#note1"><sup>1</sup></a></h1><p>å‹æƒ…æç¤º: ä»¥ä¸‹ä¸º<a href="http://alisoftware.github.io/swift/2015/09/06/thinking-in-swift-1/" target="_blank" rel="external">å‰æ–‡</a>ç•™ä¸‹çš„ä»£ç :</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> icon: <span class="type">UIImage</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">var</span> url: <span class="type">NSURL</span>!</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="func"><span class="keyword">func</span> <span class="title">listItemsFromJSONData</span><span class="params">(jsonData: NSData?)</span></span> -&gt; [<span class="type">ListItem</span>] &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> nonNilJsonData = jsonData,</span><br><span class="line">            <span class="keyword">let</span> json = <span class="keyword">try</span>? <span class="type">NSJSONSerialization</span>.<span class="type">JSONObjectWithData</span>(nonNilJsonData, options: []),</span><br><span class="line">            <span class="keyword">let</span> jsonItems = json <span class="keyword">as</span>? <span class="type">Array</span>&lt;<span class="type">NSDictionary</span>&gt;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// å€˜è‹¥JSONåºåˆ—åŒ–å¤±è´¥ï¼Œæˆ–è€…è½¬æ¢ç±»å‹å¤±è´¥</span></span><br><span class="line">                <span class="comment">// è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ç»“æœ</span></span><br><span class="line">                <span class="keyword">return</span> []</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> items = [<span class="type">ListItem</span>]()</span><br><span class="line">        <span class="keyword">for</span> itemDesc <span class="keyword">in</span> jsonItems &#123;</span><br><span class="line">            <span class="keyword">let</span> item = <span class="type">ListItem</span>()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> icon = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">                item.icon = <span class="type">UIImage</span>(named: icon)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> title = itemDesc[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">                item.title = title</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> urlString = itemDesc[<span class="string">"url"</span>] <span class="keyword">as</span>? <span class="type">String</span>, <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: urlString) &#123;</span><br><span class="line">                item.url = url</span><br><span class="line">            &#125;</span><br><span class="line">            items.append(item)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> items</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ¬æ–‡çš„ç›®æ ‡æ˜¯ä½¿ç”¨æ›´å¤šâ€œé›¨ç‡•é£â€çš„æ¨¡å¼å’Œè¯­æ³•ï¼Œä½¿å¾—ä»£ç çœ‹èµ·æ¥æ›´æ£’å¹¶ä¸”ç®€æ´ã€‚</p>
<h1 id="map()æ–¹æ³•ä»‹ç»">map()æ–¹æ³•ä»‹ç»</h1><p><code>map()</code> æ˜¯ <code>Array</code> æä¾›çš„æ–¹æ³•ï¼Œé€šè¿‡æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºä¼ å…¥å‚æ•°ï¼Œå¯¹æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ è¿›è¡Œå‡½æ•°å˜æ¢å¾—åˆ°æ–°çš„ç»“æœå€¼ã€‚è¿™æ ·åªéœ€è¦æä¾›<code>X-&gt;Y</code>çš„æ˜ å°„å…³ç³»ï¼Œå°±èƒ½å°†æ•°ç»„<code>[X]</code>å˜æ¢åˆ°æ–°æ•°ç»„<code>[Y]</code>ï¼Œè€Œæ— éœ€åˆ›å»ºä¸€ä¸ªä¸´æ—¶å¯å˜æ•°ç»„(æ³¨:å³ä¸Šé¢ä»£ç ä¸­çš„<code>items</code>å˜é‡)ã€‚</p>
<p>æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸å†åƒä¹‹å‰ä¸€æ ·ç”¨ <code>for</code> æ¥åšå¾ªç¯ï¼Œè€Œæ˜¯å¯¹ <code>jsonItems</code>(<em>JSON</em>æ•°æ®:å­˜å‚¨äºç±»å‹ä¸ºå­—å…¸çš„æ•°ç»„ä¸­)ä½¿ç”¨ <code>map()</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªå˜æ¢å‡½æ•°(é—­åŒ…)ï¼Œå°†æ¯ä¸ª <code>NSDictionary</code> ç±»å‹æ•°ç»„å…ƒç´ è½¬æ¢æˆæˆ‘ä»¬æ‰€éœ€çš„ <code>ListItem</code> å®ä¾‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> jsonItems.map &#123; (itemDesc: NSDictionary) -&gt; ListItem <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> item = ListItem()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> icon = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="built_in">String</span> &#123;</span><br><span class="line">        item.icon = UIImage(named: icon)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> title = itemDesc[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="built_in">String</span> &#123;</span><br><span class="line">        item.title = title</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> urlString = itemDesc[<span class="string">"url"</span>] <span class="keyword">as</span>? <span class="built_in">String</span>, <span class="keyword">let</span> url = NSURL(string: urlString) &#123;</span><br><span class="line">        item.url = url</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> item</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™çœ‹èµ·æ¥åªæ˜¯ä¸ªå¾ˆå°çš„æ”¹åŠ¨ï¼Œä½†æ˜¯å®ƒè®©æˆ‘ä»¬ä¸“æ³¨äºæ€æ ·æŠŠ <code>NSDictionary</code> è½¬åŒ–æˆ <code>ListItem</code>ï¼Œæ¯•ç«Ÿè¿™æ˜¯è§£å†³é—®é¢˜çš„æ ¸å¿ƒã€‚æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œé¿å…äº†åƒåœ¨ ObjC é‡Œåšçš„é‚£æ ·ï¼Œæ–°å»ºä¸€ä¸ªä¸­é—´æ•°ç»„ã€‚æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½åœ°é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿã€‚</p>
<h3 id="é”™è¯¯æ•°æ®">é”™è¯¯æ•°æ®</h3><p>ç›®å‰ä»£ç è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå³ä¾¿è¾“å…¥çš„æ•°æ®æ˜¯ä¸å¯ç”¨çš„ï¼Œæˆ‘ä»¬ä¾ç„¶åˆ›å»ºäº†ä¸€ä¸ª <code>ListItem</code> å®ä¾‹(å¹¶è¿”å›æ·»åŠ åˆ°ç»“æœæ•°ç»„<code>jsonItems</code>å½“ä¸­)ã€‚æ‰€ä»¥ï¼Œå€˜è‹¥æŸäº› <code>NSDictionary</code>æ˜¯æ— æ•ˆçš„ï¼Œæœ€ç»ˆçš„è¾“å‡ºæ•°ç»„ä¸­ï¼Œå°±ä¼šæ·»åŠ ä¸€äº›æ¯«æ— æ„ä¹‰çš„<code>ListItem()</code>ç©ºå®ä¾‹ã€‚<br>æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä»åœ¨æ€æ­»ä¸€äº›å°é©¬ ğŸ´ ã€‚å½“æˆ‘ä»¬ä½¿ç”¨<code>NSURL!</code>æ—¶ï¼Œä»£ç å…è®¸æˆ‘ä»¬åˆ›å»ºé‚£äº›æ²¡æœ‰ <code>NSURL</code> çš„ <code>ListItem()</code> å®ä¾‹ï¼ˆæˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„<code>url</code>é”®å€¼ï¼Œæ‰€ä»¥è®¿é—®<code>item.url</code>ä¸èµ·ä½œç”¨ï¼‰ï¼Œå½“æˆ‘ä»¬è®¿é—®æ— æ•ˆçš„<code>NSURL!</code>æ—¶ï¼Œç¨‹åºå°†ä¼šå´©æºƒã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯¹å˜æ¢å‡½æ•°ç¨åŠ ä¿®æ”¹ï¼Œå½“è¾“å…¥å€¼æ— æ•ˆæ—¶ï¼Œè¿”å›ä¸€ä¸ªå€¼ä¸º<code>nil</code>çš„<code>ListItem</code>ï¼Œè¿™æ¯”è¿”å›ä¸€ä¸ªé”™è¯¯æˆ–æ— å†…å®¹çš„<code>ListItem</code>æ›´ä¸ºåˆé€‚ã€‚</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> jsonItems.map &#123; <span class="function"><span class="params">(itemDesc: NSDictionary)</span> -&gt;</span> ListItem? <span class="keyword">in</span></span><br><span class="line">    guard â€¦<span class="comment">/* condition for valid data */</span>â€¦ <span class="keyword">else</span> &#123; <span class="keyword">return</span> nil &#125;</span><br><span class="line">    <span class="keyword">let</span> realValidItem = ListItem()</span><br><span class="line">    â€¦ <span class="comment">/* fill the ListItem with the values */</span></span><br><span class="line">    <span class="keyword">return</span> realValidItem</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¦‚æœ <code>jsonItems.map</code> é‡Œé¢ä¼ å…¥çš„å‡½æ•°å‚æ•°ç±»å‹ä¸º <code>NSDictionary -&gt; ListItem?</code>ï¼Œæœ€åæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€ä¸ª <code>[ListItem?]</code> æ•°ç»„ï¼Œé‚£äº›åŸæ¥æ˜¯ä¸å¯ç”¨ <code>NSDictionary</code> çš„ä½ç½®å°±è¢«æˆ‘ä»¬æ›¿æ¢æˆäº† <code>nil</code>ã€‚æ¯”åŸæ¥è¦å¥½ä¸€äº›äº†ï¼Œä½†è¿˜ä¸å¤Ÿã€‚</p>
<h1 id="ä½¿ç”¨flatMap()">ä½¿ç”¨flatMap()</h1><p>è¿™ä¸ªæ—¶å€™å°±è½®åˆ° <code>flatMap()</code> æ¥æ•‘åœºäº†ã€‚</p>
<p><code>flatMap()</code> ä¸ <code>map()</code> ç›¸ä¼¼ï¼Œä½† <code>flatMap()</code> ç”¨çš„æ˜¯ <code>T-&gt;U?</code> å˜æ¢è€Œä¸æ˜¯ <code>T-&gt;U</code> è½¬åŒ–ï¼Œè€Œä¸”å€˜è‹¥å˜æ¢åçš„æ•°ç»„å…ƒç´ å€¼ä¸º <code>nil</code><a href="thinking-in-swift-1/#note2"><sup>2</sup></a>ï¼Œåˆ™ä¸ä¼šè¢«æ·»åŠ åˆ°æœ€åçš„ç»“æœæ•°ç»„é‡Œé¢ã€‚</p>
<p>ä»è¯­æ³•ä¸Šï¼Œä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œ<code>flatMap</code> å°±æ˜¯å…ˆä½¿ç”¨ <code>map</code>å¤„ç†æ•°ç»„ï¼Œæ¥ç€å°†ç»“æœæ•°ç»„â€œå‹å¹³â€ï¼ˆé¡¾åæ€ä¹‰)ï¼Œä¹Ÿå°±æ˜¯ä»è¾“å‡ºæ•°ç»„é‡Œå‰”é™¤å€¼ä¸º<code>nil</code>çš„å…ƒç´ ã€‚</p>
<p>é€šè¿‡<code>flatMap</code>æ–¹æ³•æ”¹å†™åçš„å®ä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> jsonItems.flatMap &#123; (itemDesc: NSDictionary) -&gt; ListItem? <span class="keyword">in</span></span><br><span class="line">    guard <span class="keyword">let</span> title = itemDesc[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="built_in">String</span>,</span><br><span class="line">        <span class="keyword">let</span> urlString = itemDesc[<span class="string">"url"</span>] <span class="keyword">as</span>? <span class="built_in">String</span>,</span><br><span class="line">        <span class="keyword">let</span> url = NSURL(string: urlString)</span><br><span class="line">        <span class="keyword">else</span> &#123; <span class="keyword">return</span> nil &#125;</span><br><span class="line">    <span class="keyword">let</span> li = ListItem()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> icon = itemDesc[<span class="string">"icon"</span>] <span class="keyword">as</span>? <span class="built_in">String</span> &#123;</span><br><span class="line">        li.icon = UIImage(named: icon)</span><br><span class="line">    &#125;</span><br><span class="line">    li.title = title</span><br><span class="line">    li.url = url</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬åªè¿”å›æ‰€æœ‰é”®éƒ½å­˜åœ¨<a href="/thinking-in-swift-1/#note3"><sup>3</sup></a>å¹¶æœ‰æ•ˆçš„ <code>ListItem</code>å¯¹è±¡ï¼ˆä¿è¯ <code>NSURL</code>ä¸ä¸º<code>nil</code>ï¼‰ã€‚å¦åˆ™æ‰§è¡Œ<code>guard</code>è¯­å¥ï¼Œè¿”å›<code>nil</code>å€¼é€šçŸ¥<code>flatMap</code>ä¸è¦å°†è¿™äº›æ— æ•ˆå…ƒç´ æ·»åŠ åˆ°è¿”å›ç»“æœæ•°ç»„ä¸­ã€‚</p>
<p>è¿™æ ·åšå°±æ›´å¥½æ›´å®‰å…¨äº†ï¼Œå¯¹å§ï¼Ÿï¼Œæˆ‘ä»¬è§£å†³äº†æ•°æ®å¼‚å¸¸çš„é—®é¢˜ï¼Œå½“æœ‰é”™è¯¯è¾“å…¥æ—¶å€™ï¼Œé¿å…äº†æ— æ•ˆçš„<code>ListItem</code>é¡¹æ·»åŠ åˆ°æ•°ç»„å½“ä¸­ã€‚</p>
<h1 id="ç»“è®º">ç»“è®º</h1><p>æˆ‘ä»¬ä»ç„¶æœ‰å¾ˆå¤šå·¥ä½œè¦åšï¼Œä½†æ˜¯ä»Šå¤©å°±å…ˆåšè¿™äº›å§ï¼ˆè®©æˆ‘ä»¬ä¸ºæœ¬ç³»åˆ—æ–‡ç« çš„ä¸‹ä¸€ç¯‡å‡†å¤‡ä¸€ä¸‹ææ–™ï¼ï¼‰</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« é‡Œé¢ï¼Œæˆ‘ä»¬å­¦åˆ°äº†æ€ä¹ˆç”¨<code>map</code>æˆ–è€…<code>flatMap</code>æ¥æ›¿æ¢æ‰<code>for</code>å¾ªç¯ï¼Œç¡®ä¿å³ä¾¿è¾“å…¥æ•°æ®æ˜¯ä¸å¯ç”¨çš„çš„æƒ…å†µä¸‹ï¼Œè¾“å‡ºæ•°ç»„ä¹Ÿä¸ä¼šå‡ºé—®é¢˜ã€‚è¿™ç¡®å®å·²ç»ç®—æ˜¯å¾ˆå¤§çš„è¿›æ­¥äº†ã€‚</p>
<p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« é‡Œï¼Œå°†ä»‹ç»å¦‚ä½•ç”¨ç»“æ„ä½“(<code>struct</code>)é‡å†™<code>ListItem</code>ç±»æœ‰åŠ©äºæ¢ç´¢ <code>map</code> å’Œ <code>flatMap</code> çš„å…¶å®ƒç”¨æ³• â€“ å°¤å…¶æ˜¯åœ¨å¤„ç† <code>Optionals</code> çš„æ—¶å€™ã€‚</p>
<p>åŒæ—¶ï¼Œå¸Œæœ›ä½ èŠ±ç‚¹æ—¶é—´æ¥æ·±å…¥äº†è§£ä¸€ä¸‹ <code>map()</code> å’Œ <code>flatMap()</code> åœ¨æ•°ç»„ä¸Šçš„åº”ç”¨ï¼Œæˆ‘çŸ¥é“ä½ ç¬¬ä¸€æ¬¡å­¦çš„æ—¶å€™å¯èƒ½è§‰å¾—å®ƒä»¬å¾ˆå¤æ‚ï¼Œä½†æ˜¯ä¸€æ—¦ä½ å­¦ä¼šäº†ï¼Œä½ ä»€ä¹ˆæ—¶å€™éƒ½ä¼šæƒ³ç”¨å®ƒä»¬ã€‚</p>
<p><img src="/img/articles/thinking-in-swift-2/map-everywhere.jpg1444352409.5202105" alt=""></p>
<p><a href="#note1">1</a>: è¯·è„‘è¡¥ä¸€äº›ä½œç§€èŠ‚ç›®çš„ç”¨è¯</p>
<p><a href="#note2">2</a>: <code>flatMap</code>è¿˜æœ‰å…¶ä»–ä¸€äº›ä½œç”¨ã€‚æ¯”å¦‚æŠŠä¸€ä¸ªäºŒç»´æ•°ç»„å˜æ¢ä¸ºä¸€ç»´æ•°ç»„ï¼Œæ¯”å¦‚ï¼Œ[[T]] -&gt; [T]ã€‚ä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨åœ¨å¦‚ä½•ä½¿ç”¨ T-&gt;U? çš„å˜æ¢æŠŠ [T] å˜æˆ [U]ã€‚</p>
<p><a href="#note3">3</a>: æ³¨æ„åˆ°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œå…è®¸<code>NSDictionary</code>æ²¡æœ‰<code>icon</code>é”®ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è®¤ä¸ºä¸€ä¸ª<code>ListItem</code>å¯ä»¥ä¸éœ€è¦æœ‰ä»»ä½•<code>icon</code>ã€‚ä½†æ˜¯å…¶ä»–é”®æ˜¯å¿…é¡»çš„ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2015/09/20/thinking-in-swift-2/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-20<br>è¯‘è€…ï¼š<a href="http://blog.csdn.net/nsnirvana">æˆ‘åç¬‘</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://codebuild.me/">shanks</a></p>
</blockquote>
<p>åœ¨<a href="http://alisoftware.github.io/swift/2015/09/06/thinking-in-swift-1/">æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œä»‹ç»äº†å¦‚ä½•é¿å…å¯¹å¯é€‰ç±»å‹å¼ºåˆ¶è§£åŒ…ä»¥åŠæ‹¯æ•‘â€œå°é©¬â€ğŸ´ ã€‚åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šç²¾ç®€å‰æ–‡ä»£ç æ¥è®©å®ƒçœ‹èµ·æ¥æ›´æœ‰â€é›¨ç‡•é£â€(<em>Swift-er</em> : Swiftç¼–ç¨‹è¯­è¨€é£æ ¼)ï¼ŒåŒæ—¶å‘ä½ ä»‹ç» <code>map()</code> å’Œ <code>flatMap()</code> æ–¹æ³•ã€‚</p>]]>
    
    </summary>
    
      <category term="Crunchy Development" scheme="http://swiftggteam.github.io/tags/Crunchy-Development/"/>
    
      <category term="Swift è¿›é˜¶" scheme="http://swiftggteam.github.io/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¦‚ä½•åœ¨ iOS 9 ä¸­åˆ›å»º Stack View]]></title>
    <link href="http://swiftggteam.github.io/2015/10/08/stack-view-tutorial/"/>
    <id>http://swiftggteam.github.io/2015/10/08/stack-view-tutorial/</id>
    <published>2015-10-08T01:00:00.000Z</published>
    <updated>2015-11-03T03:11:32.125Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="http://www.ioscreator.com/tutorials/stack-view-tutorial/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-14<br>è¯‘è€…ï¼š<a href="http://weibo.com/linusling" target="_blank" rel="external">å°é“åŒ Linus</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb" target="_blank" rel="external">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/" target="_blank" rel="external">å°é”…</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨ iOS 9 ä¹‹å‰ï¼Œå³ä½¿æ˜¯åˆ›å»ºç›¸å¯¹ç®€å•çš„ç”¨æˆ·ç•Œé¢(User Interface)ï¼Œä¹Ÿéœ€è¦åœ¨ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€(Auto Layout)æ—¶æ·»åŠ å¤§é‡çš„çº¦æŸ(Constraint)ã€‚åœ¨ iOS 9 ä¸­ï¼Œè‹¹æœå®˜æ–¹å¼•è¿›äº† Stack Viewï¼Œå®ƒä¼šä¸ºæ¯ä¸ªæ–°å¢çš„å­è§†å›¾è‡ªåŠ¨æ·»åŠ è‡ªåŠ¨å¸ƒå±€çš„çº¦æŸã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­è§†å›¾çš„çºµå‘ Stack Viewã€‚æœ¬æ•™ç¨‹ä½¿ç”¨ Xcode 7 å’Œ iOS 9 å®ç°ã€‚</p>
<a id="more"></a>
<p>æ‰“å¼€ Xcode å¹¶åˆ›å»º Single View Applicationï¼Œproduct name å¡«å†™ <strong>IO9StackViewTutorial</strong>ï¼Œç„¶åå¡«å¥½ Organization Name å’Œ Organization Identifierï¼ŒLanguage é€‰æ‹© Swiftï¼ŒDevices é€‰æ‹© iPhoneï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=1500w1444269943.108628" alt=""></p>
<p>è¿›å…¥ <strong>Storyboard</strong>ï¼Œä»ç•Œé¢å³ä¸‹è§’çš„ Object Library é‡Œæ‹–ä¸€ä¸ª Label æ§ä»¶åˆ°ä¸»è§†å›¾çš„ä¸Šéƒ¨ã€‚åŒå‡»è¯¥ Label å¹¶è®¾ç½® title ä¸º â€œSwiftâ€ã€‚ä» Object Library å†æ‹–ä¸€ä¸ª Image Viewï¼Œå¹¶æ”¾åœ¨ Label ä¸‹é¢ã€‚ç‚¹å‡»<a href="http://www.ioscreator.com/s/Apple_Swift_Logo2x.png" target="_blank" rel="external">ä¸‹è½½</a>è¿™å¼ å›¾ç‰‡ï¼ŒæŠŠå®ƒæ·»åŠ åˆ°å·¥ç¨‹ã€‚é€‰ä¸­ Image View ç‚¹å‡» Attribute Inspectorã€‚åœ¨ Image View åŒºåŸŸçš„ Image å­—æ®µé€‰æ‹© Apple_Swift_Logo.pngï¼ŒåŒæ—¶åœ¨ View åŒºåŸŸçš„ Mode å­—æ®µé€‰æ‹© Aspect Fitï¼Œå…·ä½“å¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=750w1444269943.275595" alt=""></p>
<p>æœ€åï¼Œå†æ‹–ä¸€ä¸ª Buttonï¼Œå¹¶æ”¾åœ¨ Image View ä¸‹é¢ã€‚åŒå‡»è¯¥ Button å¹¶è®¾ç½® title ä¸º â€œStart Codingâ€ã€‚Storyboard å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=1500w1444269943.340582" alt=""></p>
<p>æŒ‰ä½ Ctrl é”®å¹¶é€‰æ‹©ä¸»è§†å›¾é‡Œçš„ä¸‰ä¸ªæ§ä»¶ï¼Œç‚¹å‡» Storyboard å³ä¸‹è§’çš„ Stack View æŒ‰é’®ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=300w1444269943.463557" alt=""></p>
<p>æ­¤æ—¶ï¼ŒStack View å·²ç»åˆ›å»ºå¥½äº†ï¼Œå”¯ä¸€è¦åšçš„äº‹æƒ…å°±æ˜¯è®¾ç½®è‡ªåŠ¨å¸ƒå±€çº¦æŸ(Auto Layout Constraints)ã€‚ç‚¹é€‰ Stack View åç‚¹å‡» Pin æŒ‰é’®ï¼Œå¹¶è®¾ç½® top constraint ä¸º 50ï¼Œç‚¹å‡»â€Add 1 Constraintâ€ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=750w1444269943.529544" alt=""></p>
<p>ç‚¹å‡» Align menu æŒ‰é’®ï¼Œå¹¶é€‰æ‹©â€Horizontally in Containerâ€ï¼Œç‚¹å‡»â€Add 1 Constraintâ€ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=750w1444269943.693511" alt=""></p>
<p>æŒ‰ä¸Šé¢çš„æ­¥éª¤æ“ä½œåï¼Œå¯èƒ½éœ€è¦æ›´æ–° frameï¼Œç‚¹å‡»â€Resolve Auto Layout Issuesâ€æŒ‰é’®ï¼Œç„¶åå†ç‚¹å‡»â€Update Framesâ€ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=750w1444269943.858478" alt=""></p>
<p>å¯ä»¥åœ¨ Stack View é‡Œæ”¹å˜å­è§†å›¾ä¹‹é—´çš„é—´è·(spacing)ã€‚é€‰æ‹© Stack View ç„¶ååˆ‡æ¢åˆ° Attribute Inspector é€‰é¡¹å¡ï¼Œä¿®æ”¹ Spacing çš„å€¼ä¸º 20ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=750w1444269943.973455" alt=""></p>
<p>ç¼–è¯‘å¹¶è¿è¡Œå·¥ç¨‹ã€‚åœ¨æ¨¡æ‹Ÿå™¨é‡Œæ—‹è½¬è®¾å¤‡ï¼Œå¯ä»¥çœ‹åˆ° Stack View èƒ½å¾ˆå¥½åœ°é€‚åº”ä¸åŒæ–¹å‘ã€‚</p>
<p><img src="/img/articles/stack-view-tutorial/format=1500w1444269944.038442" alt=""></p>
<p>ä½ å¯ä»¥åœ¨ <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">Github</a> ä¸‹è½½ <strong>IO9StackViewTutorial</strong> å·¥ç¨‹çš„æºä»£ç ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="http://www.ioscreator.com/tutorials/stack-view-tutorial/">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-09-14<br>è¯‘è€…ï¼š<a href="http://weibo.com/linusling">å°é“åŒ Linus</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/numbbbbb">numbbbbb</a>ï¼›å®šç¨¿ï¼š<a href="http://www.swiftyper.com/">å°é”…</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨ iOS 9 ä¹‹å‰ï¼Œå³ä½¿æ˜¯åˆ›å»ºç›¸å¯¹ç®€å•çš„ç”¨æˆ·ç•Œé¢(User Interface)ï¼Œä¹Ÿéœ€è¦åœ¨ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€(Auto Layout)æ—¶æ·»åŠ å¤§é‡çš„çº¦æŸ(Constraint)ã€‚åœ¨ iOS 9 ä¸­ï¼Œè‹¹æœå®˜æ–¹å¼•è¿›äº† Stack Viewï¼Œå®ƒä¼šä¸ºæ¯ä¸ªæ–°å¢çš„å­è§†å›¾è‡ªåŠ¨æ·»åŠ è‡ªåŠ¨å¸ƒå±€çš„çº¦æŸã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­è§†å›¾çš„çºµå‘ Stack Viewã€‚æœ¬æ•™ç¨‹ä½¿ç”¨ Xcode 7 å’Œ iOS 9 å®ç°ã€‚</p>]]>
    
    </summary>
    
      <category term="IOSCREATOR" scheme="http://swiftggteam.github.io/tags/IOSCREATOR/"/>
    
      <category term="iOS9" scheme="http://swiftggteam.github.io/categories/iOS9/"/>
    
      <category term="Swift å…¥é—¨" scheme="http://swiftggteam.github.io/categories/iOS9/Swift-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
</feed>
